%%%% DESCRIPTION %%%%%
% Title of Document: 
% Start Date: 
%%%%%%%%%%%%%%%%%%%%%%%%
%%%FINAL CHECK%%%%%%%%%
%read text
%Bibliography list
%spell check
%chklatex
%unusedlabels
%Overfull

\documentclass[12pt, letterpaper, reqno]{amsart}

\usepackage[utf8]{inputenc}
% indicate the language, for example, spanish or russian
\usepackage[english]{babel}
%\usepackage[spanish]{babel}

%comments
\usepackage{comment}

%drawings
\usepackage{graphicx}

%quotes
\usepackage{dirtytalk}

%commutative diagrams
\usepackage[all]{xypic}

\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{breqn}
\usepackage{tikz-cd}
\usepackage{bbold}
\usepackage{url}
% Paragraph Settings:
%\setlength{\parindent}{1em}
\setlength{\parskip}{1em}
% Skip indentation
\usepackage{parskip}
%%%%%%%%%%%%%%%%%
\newcommand{\incfig}[2][1]{%
    \def\svgwidth{#1\columnwidth}
    \import{./figures/}{#2.pdf_tex}
}
% why do we need this command?
% \includegraphics does not work? 
% - it does work, but i need to use it
% because the images that i create are in
% .svg format (which provides more advantages),
% so they need to be converted to pdf and inserted
% using that command.
%%%%%%%%%%%%%%%%%%

\pdfsuppresswarningpagegroup=1

%todonotes
\usepackage[colorinlistoftodos,prependcaption,backgroundcolor=white,size=tiny,textwidth=50pt]{todonotes}
\setlength{\marginparwidth}{2cm}

%%%%%%%% DIMENSIONS %%%%%%%%%%%
\textwidth=16truecm
\textheight=22truecm
\topmargin=0pt
\oddsidemargin=0pt
\evensidemargin=0pt
\baselineskip1.2truecm

%%%%%%%% THEOREMS %%%%%%%%%%%%
\theoremstyle{definition}
%\newtheorem{df}{Definition}
\newtheorem{df}{Definition}
\theoremstyle{plain}
\newtheorem{prop}{Proposition}
%\newtheorem{prop}{Proposición}
\newtheorem{thm}{Theorem}
%\newtheorem{thm}{Teorema}
\newtheorem{lm}{Lemma}
%\newtheorem{lm}{Lema}
\newtheorem{cor}{Corollary}
%\newtheorem{cor}{Corolario}
\theoremstyle{remark}
\newtheorem{ex}{Example}
%\newtheorem{ex}{Ejemplo}
\newtheorem{rem}{Remark}
%\newtheorem{rem}{Observación}

%%%%%%%% COMMENTS (REMOVE THEM IN THE FINAL VERSION!!!) %%%%%%%
\def\comment#1{{\par \tt #1}}

%%%%%%%%% FOR DRAFT%%%%%%%%%%%%%
%\renewcommand{\baselinestretch}{1.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%% PAPER DATA %%%%%%%%%%%%%%%%%%%
\author{Julián Jiménez Cárdenas}
\address{}


\title[Elements of sub-Riemannian geometry and its applications]{Elements of sub-Riemannian geometry and its applications}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\maketitle
\begin{abstract}
\end{abstract}

\section*{Introduction}
\label{sec:0}


\section{Distributions}
\label{sec:1}

\subsection{Distributions and Horizontal Curves}%
\label{sub:distributions}


A manifold without boundary $M$ of dimension $ m $  is said to be of class $ C^\infty $ if the differentiability class of the transition maps is $C^\infty.$ In this case, for every $ p\in M $ one can define the tangent space to $ M $ at $ p $, $ T_p M $, as the set of all derivations of the algebra of germs of smooth functions from $ M $ to $ \mathbb{R}  $,  based at $ p $. This definition of tangent space is equivalent (when the differentiability class of $ M $ is $ \infty $) to the equivalence class of germs of curves that passes through $ p $. If a manifold $ M $  is $C^r$, with $r< \infty$, the definition for tangent space is the latter, so we use that definition for the tangent space throughout this text, independently of the differentiability class.

\begin{df}(\cite{luke2013vector}, section 1.3)\label{def:smooth_vector_bundle}
	The triple $ (E, M, \pi: E \rightarrow {M}) $ is a \textit{smooth vector bundle} if $ E,M $ are smooth manifolds, $ \pi $ is a smooth surjection; the fibers $ \pi^{-1}(p) $ for $ p\in M $  have the structure of finite dimensional vector spaces; and for every point $ p\in M $, there is an open neighborhood $ U $ of $ p $, a natural number $ k $ and a diffeomorphism $ \phi: U\times \mathbb{R}^k \rightarrow  \pi^{-1}(U),$ such that for all $ q\in U $ the following propositions hold:  

	\begin{itemize}
		\item $ (\pi\circ \phi)(q,v)=q $ for all $ v\in \mathbb{R}^k $, and  
		\item the map $ v \mapsto \phi(p,v) $ is a linear isomorphism between the vector spaces $\pi^{-1}(p) $ and $ \mathbb{R}^k. $     
	\end{itemize}
	The first condition means that the following diagram is commutative,	
	\begin{center}
		\begin{tikzcd}
		U\times \mathbb{R}^k \arrow[d, "p"'] \arrow[rr, "\phi"] &  & \pi^{-1}(U) \arrow[d, "\pi"] \\
		U \arrow[rr, "Id"']                                     &  & U                           
		\end{tikzcd}
	\end{center}
	where $ p:U\times \mathbb{R}^k \rightarrow U, \ p(q,v)=q$ is the projection onto the first factor.
\end{df}
We take the disjoint union of the tangent spaces at every point of the manifold in order to define the tangent bundle,
$ TM = \bigsqcup_{p\in M} T_pM, $ 
equipped with manifold structure given by the one of $ M. $ It is called a bundle because the triple $ (TM, M,\pi:TM \rightarrow {M}) $ satisfies the definition of smooth vector bundle, where $ \pi:TM \rightarrow {M} $  is the projection function, that assigns each tangent vector to the point where it is based. Each fiber of this bundle is a tangent space based on a point, and the tangent bundle is in particular a vector bundle because each fiber has structure of finite dimensional real vector space.



There is another important class of smooth vector bundles, namely, the tensor bundles, that are defined following \cite{wendl2008lecture}, examples 2.4 and 2.5.
\begin{df} 
	If $ (E,M,\pi:E \rightarrow {M}) $ is a smooth vector bundle, the dual bundle of this bundle is another smooth vector bundle $ (E^*,M,\pi^*:E^*\rightarrow {M}) $, known as \textit{ dual bundle}, whose fibers are the dual spaces to the fibers of $ E, $ that is,
	$$ (\pi^{*})^{-1}(p)=(\pi^{-1}(p))^*, \text{ for all }p\in M,$$ 
	and $$ E^* =\bigsqcup_{p\in M} (\pi^*)^{-1}(p). $$ 
\end{df}
\begin{df}
	If $ (E,M,\pi:E \rightarrow {M}) $ is a smooth vector bundle, the \textit{$ (k,l)- $tensor bundle} associated to this bundle, with $ k,l\geq0 $, is defined as the smooth vector bundle $ (T^k_l E, M, \pi_{kl}: T^k_l E \rightarrow {M}) $, whose fibers are the vector spaces of $ (k,l) -$tensors of the fibers of $ E, $ that is,     
	$$ \pi_{kl}^{-1}(p) = T^k_l \pi^{-1}(p)=\left( \bigotimes_{j=1}^l (\pi^{*})^{-1}(p)\right)\otimes \left( \bigotimes_{j=1}^k \pi^{-1}(p) \right), \text{ for all }p\in M, $$ 
	and
	$$ T^k_l E = \bigsqcup_{p\in M} \pi_{kl}^{-1}(p). $$ 
\end{df}
\begin{rem}
	If $ k=1,l=0, $ $T^0_1E=E,$ and if $ k=0,l=1, $ $ T^1_0=E^*. $ We associate $ T^0_0=M\times \mathbb{R} $ to the \textit{trivial line bundle} if both $ k=l=0. $ 
\end{rem}

The formal proof that both definitions are consistent definitions of smooth vector bundles can be found in \cite{luke2013vector}, section 1.3.
\begin{df}
	A \textit{smooth section} of a smooth vector bundle $ (E,M,\pi:E \rightarrow {M}) $ is a (smooth) application $ s: M \rightarrow {E} $ such that $ \pi\circ s= \mathbb{1}_{M}. $    
\end{df}
For an arbitrary smooth vector bundle bundle $ (E,B,\pi:E \rightarrow {B}), $ a subbundle of this bundle $ (E',B',\pi':E' \rightarrow {B'}) $  is a smooth vector bundle bundle that satisfies $ E'\subset E $, $ B'\subset B $ and $ \pi|_{E'}=\pi'. $
\begin{df}
	
	A \textit{distribution} $ \mathcal{H} $ over a manifold $ M $  is a vector subbundle of the tangent bundle $ TM $ . If this vector subbundle is in addition smooth, the distribution is said to be smooth, and the rank $ k $  of this distribution is defined as the dimension of its fibers.

	The fiber of $ \mathcal{H} $ at a point $ p\in M $ is denoted as $ H_p. $ 
\end{df}

The concept of (smooth) distribution can be defined in an alternative but equivalent (see \cite{lee2003introduction}, Ch. 19, lemma 19.5) fashion using 1-forms, with the help of the following proposition.

\begin{prop}[Smooth Distribution (using 1-forms)]
	Suppose that $ M $ is a smooth $ m- $dimensional manifold, and $ \mathcal{H} \subset TM$ is a distribution of rank $k$. Then $ \mathcal{H} $ is smooth if and only if for every point $ p\in M $ there is a neighborhood $ U $ of that point where exist $n-k$ smooth 1-forms $ \omega^1,\dots,\omega^{n-k}, $ such that for all $ q\in U $,

	$$ \mathcal{H}_q = \operatorname{Ker} \omega^1|_q\cap \cdots \cap\operatorname{Ker} \omega^{n-k}|_q.  $$ 
\end{prop}

The following proposition gives an alternative way to represent a smooth distribution in terms of local frames (\cite{lee2003introduction}, Ch. 19, page 491).

\begin{prop} [Smooth Distribution (using local frames)]
	It is said that $ \mathcal{H}\subset TM $ is a smooth distribution over $M  $ if and only if  for each point $ p\in M $, there is an open neighborhood $ U $ of it on which there are smooth vector fields $ X_1,\dots,X_n: U \rightarrow {TM} $ that at each point of $ U $ form a base for the fiber of that point respect to the distribution.
\end{prop}
Some examples of distributions over manifolds are given below.
\begin{ex}[Tangent Bundle]
	For any manifold $ M $, the tangent bundle $ TM $ is by definition a distribution over it. 
\end{ex}
\begin{ex}[Heisenberg Group]\label{ex:heis_group}
	Take $ \mathbb{R} ^3 $ as the manifold, and define over it the distribution $ \mathcal{H}\subset T \mathbb{R} ^3 $, whose fiber at an arbitrary $ (x,y,z)\in \mathbb{R}^3  $ is   
	$$ \mathcal{H}_{(x,y,z)} = \operatorname{Ker} \omega|_{(x,y,z)},$$
	where $ \omega = dz-(x dy-y dx)/2\in\Omega^1( \mathbb{R}^3).$ It is important to notice that $ \omega\neq 0 $ for all $ (x,y,z)\in \mathbb{R}^3. $ 
\end{ex}
\begin{rem}
	The last example is of particular interest because of its connection with the isoperimetrical problem. For more information see \cite{montgomery2002tour}, Ch. 1.
\end{rem}
\begin{ex}[Vector field over a manifold]\label{ex:vect_field}
Any smooth vector field $ X: M \rightarrow {TM} $ (which does not vanish out at any point) on a manifold determines a distribution $ \mathcal{H}$ over the manifold $ M $ whose fiber at an arbitrary $ p\in M $ is the span of $ X_p. $
\end{ex}


Given a distribution $ \mathcal{H} $  over a manifold $M$,  a curve or vector field is said to be \textit{horizontal} if it is tangent to $ \mathcal{H} $. This means that, in the case of a curve, its tangent vector at every point is contained in the fibers of $ \mathcal{H} $; and in the case of a vector field, its value at every point is contained in the fibers of $ \mathcal{H} .$   

For example, every curve over a manifold with distribution given by its tangent bundle is horizontal. In the example \ref{ex:heis_group}, the liftings of the solutions of the isoperimetrical problem are horizontal. In example \ref{ex:vect_field}, and in particular in the case of systems of linear differential equations, the solution curves of the system of differential equations are examples of horizontal curves for that distribution.

\subsection{Frobenius' Theorem}%
\label{sub:frobenius_theorem}


Now the natural question that arises is if, given two points on a manifold with a given horizontal distribution, is there a smooth horizontal curve that joins them? 

Given a smooth distribution $ \mathcal{H} \subset TM$, we say that a nonempty immersed submanifold $ N\subseteq M $  is an \textit{integral manifold} of $\mathcal{H}$ if $ T_p N = \mathcal{H}_p $ for all $ p\in N $ , \textit{i.e.}, if the tangent space of all points of the submanifold is the fiber of the horizontal distribution. As an example, in the distribution given in example \ref{ex:vect_field}, the image of any integral curve of the vector field that determines the distribution over the manifold is an integral manifold for that distribution. A particular example (taken from \cite{lee2003introduction}, example 19.1) of a distribution and its family of integral manifolds is given below.

\begin{ex}[Orthogonal complement of a given vector field]
Let $ \mathcal{H} $ be the distribution over $ \mathbb{R}^n $ determined by the radial vector field $ x^i \partial / \partial x^i $, and let $ \mathcal{H}^\perp $ be its perpendicular bundle, \textit{i.e.,} the distribution whose fibers are the orthogonal complement of the fibers of $ \mathcal{H}. $ $ \mathcal{H}^\perp $ is a distribution over $ \mathbb{R}^n  $, and the sphere centered at $0$, of radius $ |x| $, for all $ x\neq0 $ is an integral submanifold of $ \mathcal{H}^\perp. $        
\end{ex}

There are distributions over a manifold that do not have integral manifolds, as is shown in the following example (taken from \cite{lee2003introduction}, Ch. 19, example 19.1).

\begin{ex}[Distribution without integral manifolds] \label{ex:no_integral_manifolds}
	Consider the distribution $ \mathcal{H} $ over $ \mathbb{R}^3 $ spanned by the following vector fields: 
	$$ X = \frac{\partial}{\partial x} + y \frac{\partial}{\partial z}, \quad Y = \frac{\partial}{\partial y}.  $$ 
	This distribution does not have integral manifolds. To see this, suppose that $ N $ is an integral manifold that contains an arbitrary point $ \textbf{x} \in \mathbb{R}^3.  $ Because $ X $ and $ Y $ are tangent to $ N $, any integral curve of $ X $ or $ Y $ that starts in $ N $ stays in $ N $, at least for a short time (\textit{i.e.}, the integral curve $ \gamma $ must be defined over a sufficiently small interval such that its image is fully contained in $ N $).   

	Therefore, as the integral curve of $ X $ is a straight line contained in the plane that is parallel to the $ xz- $plane, there is a segment of this line that is contained in $ N $, and for every point in this segment, the integral curves of $ Y $ that passes through them are straight lines parallel to the $ y- $axis, so there must be an open neighborhood of $ \textbf{x}  $ that contains a plane generated by the segments of the integral curves of $ X $ and $ Y $ that passes through $ \textbf{x}$ (see figure \ref{fig:no_integral_manifolds}). However, the tangent plane at any point $ p $  of this plane  off of the segment induced by the integral curve of $ X $ is not equal to $ \mathcal{H}_p, $ since $ X $ depends of $ y $.   
\end{ex}

\begin{figure}
    \centering
    \incfig{no_integral_manifolds}
    \caption{Illustration of the planes generated at each point by the integral curves of the smooth vector fields that determine the distribution given in example \ref{ex:no_integral_manifolds}.}
    \label{fig:no_integral_manifolds}
\end{figure}

A smooth distribution $ \mathcal{H} $ is said to be \textit{involutive} if given any pair of smooth vector fields $ X,Y $ defined on a open subset of $ M $  that satisfy $X_p,Y_p\in \mathcal{H}_p $, their Lie bracket also satisfies the same condition, \textit{i.e.}, it is tangent to the distribution in the given open subset. 

Let $ \Gamma(\mathcal{H}) $ be the set of all smooth vector fields globally defined, tangent to $ \mathcal{H}. $ It is clear from the definition of involutivity that if $ \mathcal{H} $ is involutive, $ \Gamma (\mathcal{H})\subset \mathfrak{X}(M) $ is a Lie subalgebra. The converse statement (if $ \Gamma(\mathcal{H}) $ is a Lie algebra, then $ \mathcal{H} $ is involutive) is also true, and can be proved extending any pair of smooth vector fields locally defined, tangent to $ \mathcal{H} ,$ to a pair of vector fields in $ \Gamma( \mathcal{H}), $ using an adequate bump function. 

A smooth distribution $ \mathcal{H} $ over a manifold $ M $ is called \textit{integrable} if each point of $ M $ is contained in an integral manifold of $ \mathcal{H}. $  It is clear then that \textit{every integrable distribution is involutive}, because every pair of smooth vectors tangent to $ \mathcal{H}, $ defined over an open set $ U\subset M $, satisfy that their Lie bracket is also tangent to $ \mathcal{H} $ in that open set, since there exists a integral manifold $ N $  of $ \mathcal{H} $ for every point of $ U $ such that the pair of smooth vectors are tangent to $ N $, and in consequence, their Lie bracket is also tangent to $ N. $  

In fact, the involutivity condition does not need to be checked for all smooth vector fields on $ \Gamma( \mathcal{H}), $ but it suffices to check if the Lie brackets of pairs of smooth vector fields of the local frame that determines the distribution are tangent to it, as the following lemma states (\cite{lee2003introduction}, lemma 19.4).

\begin{lm}[Local frame criterion for involutivity] 
	Let $ \mathcal{H}\subset TM $ be a distribution. If for every point in $ M $ there is a neighborhood such that there exists a local smooth frame $ (X_1,\dots, X_k) $ for $ \mathcal{H} $ such that $ [X_i,X_j] $ is a section of $ \mathcal{H} $ for each $ i,j, $ then $ \mathcal{H} $ is involutive.
\end{lm}

\begin{df}
	Given a smooth distribution $ \mathcal{H}\subset TM $  of rank $ k, $ it is said that a smooth coordinate chart $ (U,\phi) $ of $ M $ is \textit{flat for $ \mathcal{H} $ } if $ \phi(U) $ is a cube in $ \mathbb{R}^m  $ (being $ m $ the dimension of $ M $ ), and at points of $ U $, $ \mathcal{H} $ is spanned by the first $ k $ coordinate vector fields $ \partial/\partial x^1,\dots,\partial/\partial x^k $ (see figure \ref{fig:fittogether}).
\end{df}
The geometrical meaning of this property for a distribution is that, locally (in that chart), the manifold is homeomorphic to a cube in $ \mathbb{R}^m,  $ and the vector subspaces induced by the distribution at each point fit together as affine spaces of dimension given by the rank of the distribution in $ \mathbb{R}^m $. Also, each slice of the form $ x^{k+1}=c^{k+1},\dots, x^m=c^m,$ for constants $ c^{k+1}, \dots, c^m $ in the image of $ U $ of such a chart is an integral manifold of the distribution generated by $ \partial/\partial x^1,\dots,\partial/\partial x^k $, and the preimage of this integral manifold is an integral manifold of $ \mathcal{H}, $ contained in $ U. $  

\begin{figure}
    \centering
    \incfig{fittogether}
    \caption{Flat chart for a distribution.}
    \label{fig:fittogether}
\end{figure}

The case when every point in $ M $ has a coordinate chart centered in it, flat for $ \mathcal{H} $ is discussed in the following definition and geometrical interpretation.

\begin{df}
	A smooth distribution $ \mathcal{H}\subset TM $  is said to be \textit{completely integrable} if there exists a flat chart for $ \mathcal{H} $ in a neighborhood of each point of $ M. $ 
\end{df}

Therefore, if a distribution is completely integrable, is then integrable, since there exists an integral manifold for each point (that in particular is known as \textit{maximal integral manifold}, as the dimension of this manifold coincides with the rank of the distribution), given by the integral manifold that contains this point in the image of the coordinate chart flat for $ \mathcal{H}. $ In this way, \textit{ if a distribution is completely integrable, it is integrable, and therefore involutive.} In fact, these implications are actually equivalences, thanks to Frobenius's theorem.

\begin{thm}[Frobenius]
	Every involutive distribution is completely integrable.	
\end{thm}

\begin{proof}
	(\cite{lee2003introduction}, Ch. 19, theorem 19.12) First, it will be shown that any involutive distribution is spanned by independent smooth commuting vector fields, and as a consequence of this fact, the distribution is completely integrable.

	Let $ \mathcal{H} $ be an involutive distribution of rank $ k $ on an $ m- $dimensional manifold $ M $, and let $ p\in M $ . Let $ (U,\varphi) $ be a smooth coordinate chart centered in $ p. $ Then, $ \varphi(U)\subset \mathbb{R}^m $, and let $ X_1,\dots,X_k $ be a smooth local frame for $ \mathcal{H} $ in $ U. $

	Now, $ \left\{ d\varphi \left( X_i \right) \right\}_{i=1}^k $ is a set of linearly independent vector fields over $ \varphi(U). $ One can reordinate the coordinates of $ \mathbb{R}^m $ to make $ \mathcal{H}'_{\varphi(p)} $ (understood as the fiber of the distribution whose local frame is given by $ \left\{ d\varphi \left( X_i \right) \right\}_{i=1}^k $) complementary to the subspace generated by $ \left( \partial/\partial x^{k+1}|_{\varphi(p)},\dots,\partial/\partial x^{m}|_{\varphi(p)} \right). $   

	Let $ \pi: \mathbb{R}^m \rightarrow  \mathbb{R}^k$ the projection onto the first $ k $ coordinates, that is, $ \pi(x^1,\dots,x^m)=(x^1,\dots,x^k). $ This map induces a smooth (smooth because it is the composition $\mathcal{H}' \hookrightarrow T\varphi(U) \xrightarrow[]{d\pi} T\pi(\varphi(U))$ )  bundle homomorphism $ d\pi: T \mathbb{R}^m \rightarrow \mathbb{R}^k	 $ that acts as follows:
	$$ d\pi \left( \sum_{i=1}^m v_i \frac{\partial}{\partial x^i} \Big|_{\varphi(q)}   \right) = \sum_{i=1}^k v_i \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))}, \text{ for }q\in U.$$ 

	By the choice of coordinates, $ \mathcal{H}'_{\varphi(p)}\subset T_{\varphi(p)} \mathbb{R}^m $ is complementary to the kernel of $ d\pi_{\varphi(p)}, $ so the restriction $ d\pi|_{\mathcal{H}'_{\varphi(p)}} $ is bijective. By continuity, the same is true for $ d\pi|_{\mathcal{H}'_{\varphi(q)}} $, with $ q\in U $, and therefore, the matrix entries of $ \left(d\pi|_{\mathcal{H}'_{\varphi(q)}} \right)^{-1}: T_{\pi(\varphi(q))} \mathbb{R}^k \rightarrow \mathcal{H}'_{\varphi(q)}$ are smooth, which makes the map smooth. With this in mind, the set of vector fields $ V_1,\dots,V_k $, defined by
	$$ V_i|_{\varphi(q)}= \left(  d\pi|_{\mathcal{H}'_{\varphi(q)}}  \right)^{-1} \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))} $$ 
	are a local frame of $ \mathcal{H'}. $ It is in fact a smooth commuting local frame, as will be seen below. 

	First, notice that $ V_i $ and $ \partial/\partial x^i $ are $ \pi- $related, for $ i=1,\dots,k, $ because
	$$ \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))} = d\pi |_{\mathcal{H}'_{\varphi(q)}} \left( V_i |_{\varphi(q)} \right) = d\pi_{\varphi(q)}(V_i|_{\varphi(q)}), $$ 
	so by the naturality of Lie brackets,
	$$ d\pi_{\varphi(q)} \left( \left[ V_i,V_j \right]_{\varphi(q)} \right)= \left[ \frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j}   \right]_{\pi(\varphi(q))}=0, $$ 
	but as $ d\pi|_{\mathcal{H}'_{\varphi(q)}} $ is injective and $ [V_i,V_j]_{\varphi(q)}\in \mathcal{H}'_{\varphi(q)} $, since $ \mathcal{H} $ is involutive, $ [V_i,V_j]_{\varphi(q)}=0 $ for all $ q\in U, $ so $ \left\{ V_i \right\}_{i=1}^k $ form a smooth commuting frame for $ \mathcal{H}', $ and $ \left\{ d\varphi^{-1}(V_i) \right\}_{i=1}^k $ are a smooth commuting local frame for $ \mathcal{H}. $   

	Finally, to show that the existence of the commuting frame $ \left\{V_i \right\}_{i=1}^k $ for $ \mathcal{H}' $ is a sufficient condition for $ \mathcal{H} $ to be completely integrable, let $ \theta_i $ be the flow of $ V_i, $ $i=1,\dots,k.$ There is a neighborhood $ W $ of $ \varphi(p)  $, contained in $ \varphi(U) $ such that the composition  
	$ (\theta_1)_{t_1}\circ(\theta_2)_{t_2}\circ\cdots\circ(\theta_k)_{t_k} $
	is well defined, for sufficiently small $ t_1,\dots,t_k $ ($|t_i|<\epsilon  $, for an adequate $ \epsilon>0$). Define $ \Omega \subset \mathbb{R}^{m-k} $ as    
	$$ \Omega = \left\{ (s^{k+1},\dots,s^m)\in \mathbb{R}^{m-k}\ : \ (0,\dots,0,s^{k+1},\dots,s^m)\in W \right\}, $$ 
	and $\Phi:(-\epsilon,\epsilon)\times \Omega \rightarrow \varphi(U)$ as
	$$ \Phi(s^1,\dots,s^k,s^{k+1},\dots,s^m)=(\theta_1)_{s^1}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m). $$ 
	
	Notice that, by construction, $ \Phi( \left\{ 0 \right\}^k\times\Omega) = ({0}^k\times \mathbb{R}^{m-k})\cap W. $ Moreover, $ \partial/\partial s^i $ and $ V_i $ are $ \Phi- $related for $ i=1,\dots,k, $ because, as the flows commute, for a given $ s^0=(s^1,\dots,s^m)\in (-\epsilon,\epsilon)^k\times \Omega, $ 

	\begin{dmath*}
		d\Phi_{s^0} \left( \frac{\partial}{\partial s^i} \Big|_{s^0}  \right) f = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( \Phi \left( s^1,\dots,s^m \right) \right) = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( (\theta_1)_{s^1}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m) \right) = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( (\theta_i)_{s^i}\circ\cdots\circ(\theta_{i-1})_{s^{i-1}}\circ(\theta_{i+1})_{s^{i+1}}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m) \right),
	\end{dmath*}
	and for any $ q\in\varphi(U) $, $ t\mapsto (\theta_i)_t(q) $ is an integral curve of $ V_i, $ so the above expression is equal to $ V_i|_{\Phi(s^0)} f $, which shows that $ \partial/\partial s^i |_{s^0} $ and $ V_i $ are $ \Phi- $related.   

	By the previous computations, $$ d\Phi_0\left( \frac{\partial}{\partial s^i}\Big|_{0} \right) = V_i |_{\varphi(p)}, \ i=1,\dots,k, $$ and on the other hand, since $ \Phi(0,\dots,0,s^{k+1},\dots,s^m)=(0,\dots,0,s^{k+1},\dots,s^m), $ it follows that
	$$ d\Phi_0 \left( \frac{\partial}{\partial s^i}\Big|_{0}  \right) = \frac{\partial}{\partial x^i}\Big|_{\varphi(p)},\ i=k+1,\dots,m.  $$ 
	
	Therefore, $ d\Phi_0 $ takes the basis $ \left( \partial/\partial s^1 |_0,\dots,\partial/\partial s^m |_0 \right) $ of $ T_0 \mathbb{R}^m $ to the basis $ ( V_1|_{\varphi(p)},  \dots,$ $ V_k|_{\varphi(p)}, \partial/\partial x^{k+1}|_{\varphi(p)}, \dots, \partial/\partial x^{m}|_{\varphi(p)}) $ of $ T_{\varphi(p)} \varphi(U). $ By the inverse function theorem, $ \Phi $ is a local diffeomorphism (in a neighborhood of $ 0 $), and $ \phi=\Phi^{-1} $ is a smooth coordinate chart that takes $ V_i $ to $ \partial/\partial s^i $, for $ i=1,\dots,k, $ and takes $ \partial / \partial x^{i} $ to $ \partial/\partial s^i $, for $ i=k+1,\dots,m. $ Thus, the smooth coordinate chart flat for $ \mathcal{H} $ in a neighborhood of $ p\in M $ is $ \phi\circ\varphi, $ and since this is independent of $ p $, for every point there is a smooth coordinate chart flat for $ \mathcal{H}, $ what makes $ \mathcal{H} $ a completely integrable distribution.

\end{proof}

The next proposition is one of the main consequences of Frobenius theorem, and it is fundamental to study foliations, topic that is going to be discussed below.
\begin{prop}[Local structure of integral manifolds]\label{prop:local_structure}
	Let $ \mathcal{H} $ be an involutive distribution of rank $ k $ on a smooth manifold $ M $, and let $ (U,\varphi) $ be a flat chart for $ \mathcal{H} $. If $ N $ is any connected integral manifold of $ \mathcal{H}, $ then $ \varphi(U\cap N) $ is the union of countably many disjoint open subsets of parallel $ k- $dimensional slices of $ \varphi(U) $, whose preimages are open in $ N $ and embedded in $ M $.
\end{prop}

\begin{figure}
    \centering
    \incfig{local_structure}
    \caption{Local structure of an integral manifold.}
    \label{fig:local_structure}
\end{figure}

\begin{proof}(\cite{lee2003introduction}, Ch. 19, proposition 19.16)
	Let $ N $ be an integral manifold of $ \mathcal{H}. $ Since the inclusion map $ \iota: N \hookrightarrow M $ is continuous, $ \varphi( \iota^{-1}(U))=\varphi(N\cap U) $  is open in $ \varphi(N) $. Then, $ \varphi(U\cap N) $ is the union of open slices (\textit{i.e.}, open subsets of a slice of $ \varphi(U)$) with $ x_i=\text{constant} $, for $ i=k+1,\cdots,m.$ Moreover, this union is at most countable, because $ N $ is second countable, and since $ \varphi(N\cap U) $ is a union of open slices, $ \pi(\varphi(U\cap N)) $ consists of a countable number of points (recall that $ \pi: \varphi(U) \rightarrow \mathbb{R}^{m-k} $ is the projection onto the last $ m-k $ coordinates) in $ \mathbb{R}^{m-k}, $ which implies that the union of open slices is at most countable.  

	Finally, if $ V $ is an open slice in the slice $ S, $ the inclusion map $ \varphi^{-1}(V) \hookrightarrow M $ is a smooth embedding, because it is the composition of smooth embeddings $ \varphi^{-1}(V)\hookrightarrow \varphi^{-1}(S) \hookrightarrow M.$ 
\end{proof}

The last proposition implies that one can put all the maximal integral manifolds of an involutive distribution of rank $ k $  together, to obtain a partition on $ M $ into $ k- $dimensional submanifolds, that satisfy the following definition.
\begin{df}
	A smooth chart $ (U,\varphi) $ for $ M $ is called \textit{flat for a collection $ \mathcal{F} $ of $ k- $dimensional submanifolds of $ M $} if $ \varphi(U) $ is a cube in $ \mathbb{R}^m, $ and the image of each submanifold via $ \varphi $ intersects $ \varphi(U) $ in either the empty set or in a countable union of $ k- $dimensional slices of the form $ x^{k+1}=c^{k+1},\dots,x^m=c^m. $   
\end{df}

\begin{df}
	A \textit{foliation of dimension $ k $ on a smooth manifold $ M $} is a collection $ \mathcal{F} $ of disjoint, connected, nonempty, immersed $ k- $dimensional submanifolds of $ M $ (called the \textit{leaves} of the foliation), whose union is $ M $, and such that in a neighborhood of each point $ p\in M $ there is a flat chart for $ \mathcal{F}. $  
\end{df}

The following are examples of foliations over a manifold, mainly taken from \cite{lee2003introduction}, Ch. 19, example 19.18.

\begin{ex}[Collection of affine subspaces]
	The collection of all $ k- $dimensional affine subspaces of $ \mathbb{R}^m $ parallel to $ \mathbb{R}^k\times \left\{ 0 \right\} $ is a $ k- $dimensional foliation for $ \mathbb{R}^m. $ 
\end{ex}

\begin{ex}[Spheres centered at the origin]
	The collection of all spheres centered at $ 0 $ is an $ (m-1)- $dimensional foliation of $ \mathbb{R}^m\setminus \left\{ 0 \right\} $. 
\end{ex}

\begin{ex}[Cartesian product of manifolds]\label{ex:product_foliation}
	If $ M $ and $ N $ are connected smooth manifolds, the collection of subsets of the form $ M\times \left\{ q \right\}, $ with $ q\in N $, is a foliation of $ M\times N, $ each of whose leaves is diffeomorphic to $ M. $  	
\end{ex}

\begin{ex}[Foliations on a torus]
	The torus $ T= \mathbb{S}^1\times \mathbb{S}^1 $ can be endowed with the distribution induced by the cartesian product of manifolds (see example \ref{ex:product_foliation}). In this case, the foliation is conformed by copies of $ \mathbb{S}^1. $ The horizontal curves are segments of this copies, and if two points lay in different copies, there is not a horizontal curve that connects them.
\end{ex}

From the definition of foliations, it is clear that \textit{if $ \mathcal{F} $ is a foliation on a smooth manifold $ M, $ the collection of tangent spaces to the leaves of $ \mathcal{F} $ forms an involutive distribution on $ M. $} In a reciprocal way, the collection of maximal integral manifolds of an involutive distribution forms a foliation over the manifold, as it is stated in the global Frobenius theorem.

\begin{thm}[Global Frobenius theorem]
	Let $ \mathcal{H} $ be an involutive distribution on a smooth manifold $ M. $ The collection of all maximal connected integral manifolds of $ \mathcal{H} $ forms a foliation of $ M. $ 
\end{thm}

The next lemma (\cite{lee2003introduction}, Ch. 19, lemma 19.22) is going to be used to prove this theorem.

\begin{lm}\label{lm:man_struct}
	Suppose that $ \mathcal{H}\subset TM $ is an involutive distribution, and let $ \left\{ N_\alpha \right\}_{\alpha\in A} $ be any collection of connected integral manifolds of $ \mathcal{H} $ with a point in common. Then, $ N=\bigcup_{\alpha} N_\alpha $ has a unique smooth manifold structure making it into a connected integral manifold of $ \mathcal{H}. $  
\end{lm}

\begin{proof}[Proof of the global Frobenius theorem]
	(\cite{lee2003introduction}, Ch. 19, theorem 19.21) For each $ p\in M $, let $ L_p $ be the union of all connected integral manifolds of $ \mathcal{H} $ containing $ p. $ By lemma \ref{lm:man_struct}, $ L_p $ is a connected integral manifold of $ \mathcal{H} $ containing $ p $, and it is clearly maximal. By maximality, if $ L_p $ and $ L_{p'} $ intersect, $ L_p=L_{p'} $, because $ L_p\cup L_{p'} $ is an integral manifold containing both $ p $ and $ p' $. Thus, the maximal connected integral manifolds are either disjoint or identical.    

	If $ (U,\varphi) $ is any flat chart for $ \mathcal{H}, $ then $ \varphi(L_p\cap U) $ is a countable union of open subsets of slices (by proposition \ref{prop:local_structure}). For any such slice $ S, $ if $ \varphi(U\cap L_p)\cap S $ is neither empty nor all of $ S, $ then $ L_p\cup \varphi^{-1}(S )$ is a connected integral manifold properly containing $ L_p, $ which contradicts the maximality of $ L_p. $ Therefore, $ \varphi(L_p\cap U) $ is precisely a countable union of slices, so the collection $ \left\{ L_p\ : \ p\in M \right\} $ is the desired foliation.
\end{proof}

With the global Frobenius theorem, one can answer the question at the start of this subsection: in general, for an given distribution there is no smooth horizontal curve that connects an arbitrary pair of points, because the points can be in different leaves of the foliation given by the distribution.


\section{Subriemannian Geometry}%
\label{sec:subriemannian_geometry}

\subsection{Subriemannian Structure and Geodesics}%
\label{sub:subriemannian_structure_and_geodesics}
\begin{df}
	A \textit{subriemannian structure over a manifold} $ M $ is a pair $ (\mathcal{H}, \langle\cdot,\cdot\rangle)$, where $ \mathcal{H}\subset TM $ is a distribution and $ \langle\cdot,\cdot\rangle $ is a section of the bundle $ T^0_2 \mathcal{H} \xrightarrow[]{\pi} M, $ whose values are positive definite symmetric bilinear forms (see \cite{hatcher2003vector}, Ch. 1, page 12).

	The distribution $ \mathcal{H} $ is called \textit{horizontal}, and the tensor field $ \langle\cdot,\cdot\rangle $ is called \textit{metric}.  
\end{df}

Some examples of subriemannian structures are given below.
\begin{ex}[Riemannian Structure]\label{ex:riem_geo2}
	Every riemannian structure is in particular a subriemannian structure, where the distribution is the entire tangent bundle.
\end{ex}

\begin{ex}[Heisenberg Group]\label{ex:heis_group2}
	The distribution of the Heisenberg group is commented in example \ref{ex:heis_group}. The inner product over a fiber $ \mathcal{H}_{(x,y,z)} $, with $ (x,y,z)\in \mathbb{R}^3 $  is given by $\langle\cdot,\cdot\rangle:  \mathcal{H}_{(x,y,z)}\times\mathcal{H}_{(x,y,z)} \rightarrow { \mathbb{R} }:(v,w)\mapsto v_1w_1+v_2w_2,$ where $ v=(v_1,v_2,v_3) $ and $ w=(w_1,w_2,w_3). $  

\end{ex}
\begin{ex}[Vector Field over a Manifold]\label{ex:vect_field2}
	As seen in example \ref{ex:vect_field}, any smooth vector field $ X: M \rightarrow TM$ that does not cancel out in any point determines a distribution.  The fiber inner-product $ \langle\cdot,\cdot\rangle: \mathcal{H}_p \times \mathcal{H}_p \rightarrow \mathbb{R} $ for $ p\in M $  is given by $\langle\lambda_1 X_p,\lambda_2 X_p\rangle=\lambda_1 \lambda_2.$
\end{ex}
In the particular case of the horizontal curves, one can define the \textit{length of a horizontal smooth curve} $ \gamma $ (denoted by $ \ell(\gamma) $) as in the case of riemannian geometry:
$$ \ell(\gamma) = \int ||\dot{\gamma}|| dt, $$ 
since the tangent vectors of the curve at all points are in the fibers of the horizontal distribution, where there is a inner product defined, and $ ||\dot{\gamma}||= \sqrt[]{\langle\dot{\gamma}, \dot{\gamma}\rangle}.  $   

\begin{df}
	The \textit{distance between two points} $ p,q\in M $, denoted by $ d(p,q), $   is defined as the infimum of the lengths of all absolutely continuous horizontal curves that begin in $ p $ and end in $ q $, that is, 
$$ d(p,q) = \operatorname{inf} \left\{ \ell(\gamma) \ |\ \gamma:[0,1] \rightarrow {M} \text{ is absolutely continuous and }\gamma(0)=p, \ \gamma(1)=q \right\}. $$ 
The distance between two points is said to be infinite if there is no horizontal curve joining them.
\end{df}

The curves that are considered in the previous definition of distance are required to be absolutely continuous, that is a weaker condition of smoothness, and refers to a curve that is differentiable in almost all points of its domain. Nevertheless, the distance remains invariant if we consider instead the set of all smooth curves (see \cite{montgomery2002tour}, page 23), but the motivation to consider the bigger set of absolutely continuous curves is the fact that the curves that realize the distance between two points are not always smooth.

\begin{df}
	Given a subriemannian structure $ (\mathcal{H}, \langle\cdot,\cdot\rangle) $ over a manifold $ M $  (or riemannian structure, if $ \mathcal{H}=TM $), it is said that an absolutely continuous horizontal curve $ \gamma:  [a,b] \rightarrow M$, with $ \gamma(a)=p, \gamma(b)=q $ is a \textit{geodesic} if it realizes the distance between $ p $ and $ q $, that is,   
	$$ \ell(\gamma)= d(p,q). $$ 
\end{df}


\subsection{Chow's Theorem}%
\label{sub:chow_s_theorem}

The section \ref{sub:frobenius_theorem} provides a class of (involutive) distributions where it is not true that every two points can be connected through a horizontal curve.  Now, it is worthwhile to ask for a sufficient condition for a distribution to have the connectedness property through horizontal curves. To discuss such a condition, we need to cover some preliminaries. 

\begin{df}
	A distribution $ \mathcal{H}\subset TM $ is called \textit{bracket generating} if for every $ p\in M $, there is a local frame $ X_1,\dots,X_k: U \rightarrow {TM} $ of $ \mathcal{H} $ such that 
	$$ TU = \operatorname{span}\left\{ [X_{i_1},\dots,[X_{i_{j-1}},X_{i_j}]]\ : \ i_1,\dots,i_j=1,\dots,k;\ j\in \mathbb{N} \right\}.  $$ 
\end{df}

\begin{lm}\label{lm:approx}
	Let $ X_1,X_2 $ be two smooth vector fields over the manifold $ M $, with respective local flows $ \Phi_1,\Phi_2:(-\epsilon,\epsilon)\times U \rightarrow {U}$, and let $ p\in U. $ Then, in any coordinate system the following relation holds:
	$$ \left[ \Phi_1(t), \Phi_2(t) \right](p) := \left( \Phi_1(t)\circ \Phi_2(t) \circ \Phi_1(t)^{-1}\circ \Phi_2(t)^{-1} \right)(p)=p+t^2 \left[ X_1,X_2 \right](p) + O(t^3). $$ 
\end{lm}
\begin{proof}
	By Taylor's theorem, we have $$ \Phi_i(t)(p)=p+tX_i(p)+ \frac{t^2}{2} X_i(X_i(p)) + O(t^3), \text{ for }i=1,2.  $$ 
	In the other hand, as $ \left\{ \Phi_i(t) \right\}_{t\in(-\epsilon,\epsilon)} $ is the family of diffeomorphisms associated with the flow of $ X_i, $ $ \Phi_i(t)^{-1}=\Phi_i(-t). $ Then,   
	\begin{dmath*}
	 (\Phi_1(t)^{-1}\circ \Phi_2(t)^{-1})(p) = p- t \left( X_1(p)+X_2(p) \right)+ t^2 X_1(X_2(p)) + t^2 \left( X_1(X_1(p))+ X_2(X_2(p)) \right) + O(t^3), 
	\end{dmath*}
	and evaluating $ \Phi_1(t)\circ\Phi_2(t) $ in this point gives

	\begin{dmath*}
	\left( \Phi_1(t)\circ \Phi_2(t) \circ \Phi_1(t)^{-1}\circ \Phi_2(t)^{-1} \right)(p) = p+t^2 \left[ X_1,X_2 \right](p)+ t^2 \left( X_1(X_1(p)) + X_2(X_2(p)) \right) - t( X_1(p)+X_2(p)) - t^2 \left( X_1(X_1(p)) + X_2(X_2(p)) \right) +t( X_1(p)+X_2(p)) + O(t^3) = p+t^2 \left[ X_1,X_2 \right](p) + O(t^3), 
	\end{dmath*}
	which is the desired result.	
\end{proof}

Chow's theorem guarantees that any bracket generating over a connected manifold has the connectedness property through horizontal curves, and we going to derive this result in the rest of this section, following closely the procedure of \cite{montgomery2002tour}, Section 2.4. First of all, choose a base point $ p\in M $ and a local orthonormal frame $ X_i $, $ i=1,\dots, k $ for the distribution $ \mathcal{H} $. Let $ \Phi_i $ be their respective flows. These flows can be used to move in the horizontal directions (points connected to $ p $ through integral curves of the orthonormal frame), using the formula $ \Phi_i(t)(q)=q+tX_i(q)+O(t^2) $ for sufficiently small $ t. $ 

The assignments $ t\mapsto \Phi_i(t)(q) $ are horizontal curves for the distribution $ \mathcal{H}, $ and are called \textit{simple horizontal curves.} As the frame is orthonormal, the length of a simple horizontal curve with $ 0\leq t\leq \epsilon  $ is $ \epsilon. $   

Applying $ \Phi_k(t_k)\circ\cdots\circ \Phi_2(t_2)\circ\Phi_1(t_1)$ to $ p $ and letting $ t_1,\dots,t_k $ vary over the cube $ |t_i|\leq\epsilon, $ we move from $ p $ to another point inside the $ k- $dimensional  cube of volume $ (2\epsilon)^k$ in the coordinate chart, whose sides are determined by the local frame in the image of $ p $. Each point of this cube can be reached from $ p $ through the concatenation of $ k $ or fewer flows, and this cube is inside of the subriemannian ball of radius $ k\epsilon $, that is,
\begin{align*}
 \operatorname{Box}_p(\epsilon):= \left\{ \Phi_k(t_k)\circ\cdots\circ \Phi_2(t_2)\circ\Phi_1(t_1)(p) \ | \ |t_i|<\epsilon, \ i=1,\dots,k \right\}\\ \subset \operatorname{B}(k\epsilon, p):= \left\{ q\in M \ | \ d(p,q)<k\epsilon \right\}.  
\end{align*}

We can move in the remaining directions along horizontal paths by successive applications of the commutators of flows, based on the bracket generating property of the distribution in the following way. Let $ \mathcal{H} $ denote also the sheaf of smooth vector fields tangent to $ \mathcal{H}, $ that is, the association between open sets $ U\subset M $ and horizontal smooth vector fields $ \mathcal{H}(U) $ defined locally on $ U $, and define the new vector sheaves
$$ \mathcal{H}^2 := \mathcal{H}\oplus [\mathcal{H},\mathcal{H}],\quad \mathcal{H}^{r+1} := \mathcal{H}^r\oplus [\mathcal{H}, \mathcal{H}^r], $$
where
$$ \left[ \mathcal{H}, \mathcal{H}^j \right]:= \operatorname{span} \left\{ [X,Y] \ | \ X\in \mathcal{H},\ Y \in \mathcal{H}^j \right\}, \text{ for }j=1,2,\dots  $$ 
The movement in the $ \mathcal{H}^2/\mathcal{H} $ directions can be made along horizontal paths by applying the commutators $ \Phi_{ij}(t):= [\Phi_i(t),\Phi_j(t)] $ to $ p. $ As $ \Phi_{ij}(t)(p)=p+t^2[X_i, X_j](p) $ (by lemma \ref{lm:approx}) if $ |t|\leq\epsilon, $ we will move by an amount $ \epsilon^2 $ in the $ \mathcal{H}^2/\mathcal{H} $ directions. This process is realized inductively until exhausting the tangent space. Let $ I=(i_1,i_2,\dots,i_n), $ $ 1\leq i_j\leq k $, and $ X_I:=[X_{i_1}, X_J], $ where $ J=(i_2,\dots,i_n), $  so that $ X_I $ is the iteration of $ n $ Lie brackets. Similarly, define flows $ \Phi_I(t):=[\Phi_{i_1}(t), \Phi_J(t)] $. By successive application of lemma \ref{lm:approx}, we have that   
$$ \Phi_I(t)= \mathbb{1} +t^n X_I+ O(t^{n+1}).$$ 
Due to the bracket generating condition over any local frame of the distribution, we can select a local frame for the entire tangent bundle amongst the $ X_I, $ letting $ n $ and $ i_1,\dots,i_n $ vary accordingly. We choose such a frame and relabel it as $ Y_i, $ $ i=1,\dots,m, $ in a way that it satisfies: $ Y_1=X_1,\dots, Y_k=X_k $ span $ \mathcal{H} $ near $ p, $ $ \left\{ Y_1,\dots,Y_{n_2} \right\} $ span $ \mathcal{H}^2 $ near $ p, $ $ \left\{ Y_1,\dots,Y_{n_2},\dots,Y_{n_3} \right\} $ span $ \mathcal{H}^3 $ near $ p $,  and so on. The tuple $ (k,n_2,n_3,\dots, n_r) $ is called the \textit{growth vector of the distribution at $ p $}, and the smallest integer $ r $ is called the \textit{step or degree of nonholonomy of the distribution at $ p. $ }   

\begin{df}[\cite{montgomery2002tour}, page 49.] Let $ \left\{ Y_1,\dots, Y_m \right\} $ be the local frame of the tangent bundle in a neighborhood of $ p\in M $ constructed as stated before using the local frame of a bracket generating distribution. Let $ Y_i=X_I $, $ I=(i_1,\dots,i_{n_I}) $. We denote the length of $ I $ as $ w_i:= \left| I \right| $, and define the assignment $ i\mapsto w_i, $ called the \textit{weighting associated to the growth vector}. 
	
\end{df}

We relabel the flows $ \Phi_I $ in a similar fashion, so that $ \Phi_i $ is the flow associated to $ Y_i. $ In this case, each point $ \Phi_i(t)(p) $ is the endpoint of the concatenation of $ w_i $ simple horizontal curves, each one of length $ t $. If we impose that $ \left| t \right|\leq \epsilon, $ then $ \Phi_i(t)(p) $ lies in the ball of radius $ w_i\epsilon $ centered at $ p. $ Moreover, in coordinates we have that 
$$ \Phi_i(t)(p)=p+t^{w_i}X_i(p)+ O(t^{w_i+1}), $$ 
so $ \Phi_i(t)(p) $ lies in the Euclidean box of volume $ \epsilon^{w_i} $, in the $ \mathcal{H}^{w_i} $ directions. From this we can deduct that the subriemannian ball $ B(\epsilon,p) $ contains an Euclidean coordinate box whose sides are of order $ \epsilon^{w_i} $ in the $ i $-th direction. This result is known as the ball-box theorem, and it will be stated and proved after the following definitions.

\begin{df}[\cite{montgomery2002tour}, definition 2.4.1] 
	Coordinates $ y_1,\dots,y_m $ are said to be \textit{linearly adapted to the distribution $\mathcal{H}$ at $ p $ } if $ \mathcal{H}^i(p):= \{ X(p) \ | \ X$ is a section of $\mathcal{H}$ defined on $p$$\}$ is annihilated by the differentials $ dy_{n_i+1},\dots, dy_m $ at $ p, $ where $ n_i=n_i(p) $ are the coordinates of the growth vector at $ p. $  
\end{df}
\begin{df}
	The $ w $- weighted box of size $ \epsilon $ is the point set
	$$ \operatorname{Box}^w(\epsilon) := \left\{ y\in \mathbb{R}^m \ | \ |y_i|\leq \epsilon^{w_i}; \ i=1,\dots,m \right\}.  $$ 
\end{df}

Set $ y_i $ as the coordinates centered at $ p $ such that $ dy_i(p) $ are the dual basis to the $ Y_i(p), $ so that these coordinates are linearly adapted to the distribution by definition.

\begin{thm}[Ball-Box Theorem]
	There exist linearly adapted coordinates $ y_1,\dots,y_m $ and positive constants $ c<C, \ \epsilon_0>0, $ such that for all $ \epsilon<\epsilon_0, $ 
	$$ \operatorname{Box}^w(c\epsilon)\subset B(\epsilon, p)\subset \operatorname{Box}^w(C\epsilon).    $$ 
\end{thm}
\begin{figure}[ht]
    \centering
    \incfig{ballbox}
    \caption{Ball box theorem.}
    \label{fig:ballbox}
\end{figure}
\begin{proof}[Proof of $\operatorname{Box}^w(c\epsilon)\subset B(\epsilon, p)$] (\cite{montgomery2002tour}, theorem 2.4.2). As the approximation $ \Phi_{ij}(t)= \mathbb{1} + t^2 \left[ X_i,X_j \right] + O(t^3)$ has the coefficient $ t^2 $ that is always positive, we can not move in the negative $ [X_i,X_j] $ direction. To circunvent this, we define 
	$$ \Psi_{i j}(t)=\left\{\begin{array}{ll}{\left[\Phi_{i}(t), \Phi_{j}(t)\right]} & t \geq 0 \\ {\left[\Phi_{j}(t), \Phi_{i}(t)\right]} & t<0,\end{array}\right. $$ 
	so that
	$$\Psi_{i j}(t)=\left\{\begin{array}{ll}I+t^{2} X_{i j}+O\left(t^{3}\right) & t \geq 0 \\ I-t^{2} X_{i j}+O\left(t^{3}\right) & t<0.\end{array}\right.$$
This problem occurs wheneve the number $ w_i $ associated to the flow $ \Phi_I $ of $ Y_i $ is even. To solve this in general, we set
$$\Psi_{I}(t)=\left\{\begin{array}{ll}
\Phi_{I}(t) & t \geq 0 \\
{\left[\Phi_{J}(t), \Phi_{i_{1}}(t)\right]} & t<0.
\end{array}\right.$$
If $ w_i $ is odd, we keep $ \Psi_I=\Phi_I, $ and we relabel $ \Psi_I $ as $ \Psi_i $ accordingly. Now, we introduce the functions
$$\sigma_{i}(t)=\left\{\begin{array}{ll}
t^{w_{i}} & w_{i} \text { even, } t \geq 0 \\
-t^{w_{i}} & w_{i} \text { even, } t<0 \\
t^{w_{i}} & w_{i} \text { odd }
\end{array}\right.
$$
to simplify the notation of the approximation
$$ \Psi_I(t)= \mathbb{1}+ \sigma_i(t) Y_i + O(t^{w_i+1}). $$ 
Define the map $ F: \mathbb{R}^m \rightarrow {M} $ as $ F(t_1,\dots,t_m) = \left( \Psi_m(t_m) \circ \cdots \circ \Psi_1(t_1)\right)(p), $ and let $ y_i $ be linearly adapted coordinates for which the $ dy_i $ are dual to the $ Y_i $ of the basis of the tangent space at the base point $ p. $ Then, in coordinates,

$$ F_i(t_1,\dots,t_m) = \sigma_i(t_i) + o(t_i^{w_i}) = \pm t_i^{w_i} + o(t_i^{w_i}), $$ 
where the error $ o(t_i^{w_i}) $ corresponds to the composition of the previous $ \Psi_1(t), \dots,\Psi_{i-1}(t) $ flows evaluated in the big $ O- $errors of the previous sequential arguments. It remains to understand and bound these error terms, and for that we introduce the new variables $ s_i=\sigma_i(t), $ so that $ F_i(t_1,\dots,t_m)= s_i + o(s_i). $  

The map $ \sigma=(\sigma_1,\dots,\sigma_m) $ is a homeomorphism between neighborhoods of $ 0 $ in $ \mathbb{R}^m, $ so let $ S $ be the inverse of $ \sigma $ that is given by $ S=(s_1,\dots,s_m), $ where $ s_i(t_i)=\pm |t_i|^{1/w_i}. $ Then, it follows that
$$ y\circ F\circ S (s_1,\dots,s_m) = (s_1,\dots,s_m) + o(|s|), $$ 
from where we deduce that $ F\circ S$ is differentiable at the origin because of the differentiability of both $ y $ and $ y\circ G\circ S $, and its derivative is the identity in the $ s-y $ coordinates, so it is also $ C^1 $ near $ 0. $ We will proceed applying the inverse function theorem to invert $ F\circ S $ in a neighborhood of $ p. $ 

Write $ F\circ S(s_1,\dots,s_m) $ in coordinates as $ (y_1,\dots,y_m).$ Then, there exists a constant $ \epsilon_0 $ and constants $ c=c(\epsilon_0), \ C=C(\epsilon_0) $ such that $ c|s_i| \leq |y_i(s_1,\dots,s_m)|  \leq C|s_i|$ whenever $ |s_i|\leq \epsilon_0. $ Apply the constraint $ |s_i|\leq \epsilon^{w_i} $ to the $ s_i. $ It is clear that the inverse image of the point set $ |s_i|\leq \epsilon^{w_i} $ under the map $ S $ is the $ \epsilon- $cube box $ \operatorname{Box}(\epsilon)= \left\{ (t_1,\dots,t_m)\ | \ |t_i|\leq \epsilon \right\},  $  so that applying $ F $ to the $ \epsilon- $cube gives
$$ \operatorname{Box}^{w}(c\epsilon) \subset F( \operatorname{Box}(\epsilon) ) \subset \operatorname{Box}^w(C\epsilon).   $$ 
Each curve in $ F( \operatorname{Box} (\epsilon) )$ is the endpoint of a horizontal curve starting at $ p $ whose length is less than $ M\epsilon $, where $ M=M(w) $ counts the number of concatenations involved in $ F. $ Consequently,
$$ F( \operatorname{Box} (\epsilon)) \subset B(M\epsilon, p), $$ 
from where we get that $ \operatorname{Box}^w (c\epsilon)\subset B(\epsilon,p). $ 
\end{proof}
The remaining containment in the Ball-Box theorem will not be proved in this text, as the proof of Chow's theorem only requires the first containment. The proof of the remaining containment can be found in \cite{montgomery2002tour}, section 2.7.

With the Ball-Box theorem, Chow's theorem can be derived easily.

\begin{thm}[Chow's Theorem]
	If $ \mathcal{H} $ is a bracket generating distribution on a connected manifold $ M $, then any two points of $ M $ can be connected by a horizontal path.
\end{thm}
\begin{proof} (\cite{montgomery2002tour}, page 52). The containment $ \operatorname{Box}^w(c\epsilon) \subset B(\epsilon,p)$ shows that $ B(\epsilon, p) $ is a neighborhood of $ p $, which means that the accesible points from $ p $ through horizontal curves form a neighborhood of $ p. $ Let $ q\in M $ be another arbitrary point on the connected manifold, and take a smooth curve $ \gamma $ connecting $ p $ and $ q. $  

	The image of $ \gamma $ is compact, so we can cover it with finitely many succesive box neighborhoods, where the Ball-Box theorem holds. Denote these neighborhoods as $ U_1,\dots,U_n, $ with each one of these boxes centered on succesive points $ p_i $ along the image of $ \gamma, $ and $ p_1=p, $ $ p_n=q. $ Moreover, these open sets can be chosen in orden to satisfy $ U_i\cap U_{i+1}\neq\emptyset, $ so that there exists $ q_i \in U_i\cap U_{i+1}. $ By the Ball-Box theorem, we have paths connecting $ p_i $ with $ q_i, $ and $ q_i $ with $ p_{i+1}. $ Concatenating these paths yields a piecewise horizontal path connecting $ p $ and $ q. $ 
	
\end{proof}
\begin{ex}[Cartan's Distribution]
	Consider the distribution over $ \mathbb{R}^3 $ determined by the 1-form $\omega =dy- zdx $, or in dual manner, by the smooth vector fields $ \partial /\partial x + z \partial / \partial y, \partial/\partial z. $ From its definition it is clear that Cartan's distribution is of rank 2, so we can not know beforehand if any two pair of points can be connected through a horizontal curve. Nevertheless, as 
	$$ \left[ \frac{\partial}{\partial z}, \frac{\partial}{\partial x}+z \frac{\partial}{\partial y}    \right] = \frac{\partial}{\partial y}  $$ 
and $ T \mathbb{R}^3 = \operatorname{span}\{  \partial/\partial x + z \partial / \partial y, \partial/\partial z, \partial/\partial y\} $, Cartan's distribution is bracket generating, so by Chow's theorem any two points in $ \mathbb{R}^3 $ can be connected by a horizontal path. 
\end{ex}

\section{Subriemannian metrics on Bundles}%
\label{sec:metrics_on_bundles}
\subsection{Ehresmann connection}%
\label{sub:ehresmann_connection}


Let $ \pi : Q \rightarrow {M} $ be a submersion, which means that for all $ q\in Q $, $ d\pi_q : T_q Q \rightarrow {T_{\pi(q)}}M $ is a surjective map. The fiber $ Q_m = \pi^{-1}(m) $, with $ m=\pi(q) $ is a submanifold because $ m $ is a regular value of $ \pi. $  

\begin{df}
	Given a submersion $ \pi:Q \rightarrow {M}, $ the \textit{vertical space at $ q\in Q $}, denoted as $ V_q $, is the tangent space to the fiber $ Q_m, $ with $ m=\pi(q), $ that is,  
	$$ V_q = \operatorname{Ker}(d\pi_q) = T_q Q_m.  $$ 
\end{df}

The collection of vertical spaces is a distribution $ V \subset TQ $ that assigns to each $ q\in Q $ the space $ V_q. $ The distribution is by construction integrable, and its integral manifolds are the fibers $ Q_m, $ $ m\in \pi(Q). $ 

\begin{df}[\cite{montgomery2002tour}, definition 11.1.1]
	A \textit{connection for a submersion} $ \pi:Q \rightarrow {M} $ is a distribution that is everywhere transverse to the vertical one, that is,  
	$$ V_q \oplus \mathcal{H}_q = T_q Q,\ \text{for all } q\in Q. $$ 
\end{df}

The restriction of $ d\pi_q $ to $ \mathcal{H}_q $ is a linear isomorphism because $ d\pi_q $ is surjective, and $ T_q Q / \operatorname{Ker}(d\pi_q) = T_q Q / V_q \cong \mathcal{H}_q \cong T_m M. $ If $ M $ is endowed with a metric, we can use this linear isomorphism to pull the inner product back to the horizontal distribution $ \mathcal{H}. $ This construction varies smoothly with $ q\in Q $ (\cite{montgomery2002tour}, page 194). With this, we obtain a subriemannian metric whose underlying distribution is the connection for the submersion.

\begin{df}
	The subriemannian structure on $ Q $ induced by the connection $ \mathcal{H} $ for the submersion $ \pi:Q \rightarrow {M} $, the linear isomorphism $ \mathcal{H}_q \cong T_m M $ and the riemannian metric over $ M $ is called the \textit{induced subriemannian structure}. 
\end{df}

\begin{df}
	The \textit{horizontal lift} of a curve $ c: I \rightarrow {M} $ starting at $ m\in M $ is defined (if exists) as the unique curve $ \gamma : I \rightarrow {Q} $ that is tangent to $ \mathcal{H}, $ starts at $ q\in Q_m, $ and projects to $c$, that is, $ \pi\circ\gamma = c. $ 
\end{df}

\begin{rem}
	The connection $ \mathcal{H} $ is called \textit{complete} or is referred as an \textit{Ehresmann connection}  if every smooth curve $ c: I \rightarrow {M} $ has a horizontal lift.
\end{rem}

\begin{prop}
	The induced subriemannian structure satisfies the following properties:
	\begin{enumerate}
		\item The subriemannian length of a horizontal path on $ Q $ equals the riemannian length of its projection to $ M. $ 
		\item The horizontal lift of a riemannian geodesic in $ M $ is a subriemannian geodesic in $ Q. $ 
		\item The projection $ \pi $ is distance decreasing, that is, $ d_M(\pi(q_1), \pi(q_2))\leq d_Q(q_1,q_2), $ for all $ q_1,q_2\in Q. $ 
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item Let $ \gamma: I \rightarrow {Q} $ be a horizontal path to $ \mathcal{H} $ starting at $ q\in Q. $ Then, its longitude is 

		$$\ell_Q(\gamma) = \int_0^1 ||\dot{\gamma} (t) ||_{Q} dt = \int_0^1 || d\pi_{\gamma(t)}(\dot{\gamma}(t))||_M dt,$$ 

		having in mind that $d\pi_{\gamma(t)}$ induces an isomorphism between $ \mathcal{H}_{\gamma(t)} $ and $ T_{\pi(\gamma(t))} M,$ and this isomorphism determines the induced subriemannian structure over $ Q. $ As $c=\pi\circ\gamma$ and $ d/dt(\pi\circ\gamma) = d\pi_{\gamma(t)}(\dot{\gamma}(t)) $, $ \ell_Q(\gamma)=\ell_M(c). $  

		\item Suppose that $ c: I \rightarrow {M} $ is a riemannian geodesic, and let $ \gamma: I \rightarrow {Q} $ be its respective horizontal lift. Take any other horizontal curve $ \eta: I \rightarrow {Q} $ with the same endpoints than $ \gamma. $ Then, by the first affirmation of this proposition and the fact that $ c $ is a geodesic, we have
			$$ \ell_Q(\eta) = \ell_M(\pi\circ \eta) \geq \ell_M(c) = \ell_Q(\gamma),  $$ 
		from where we get that $ \gamma: I \rightarrow {Q} $ is a subriemannian geodesic.

	\item Let $ q_1,q_2\in Q. $ If $ d_Q(q_1,q_2) = \infty $ the result is immediate. Else, let $ \left\{ \gamma_i \right\}_{i\in \mathbb{N}} $ be a minimizing sequence of $ d_Q(q_1,q_2). $ Now consider the sequence of projected curves $ \left\{ \pi\circ\gamma_i \right\}_{i\in \mathbb{N}}, $ from where there are two possibilities: if this last sequence is minimizing, $ d_Q(q_1, q_2) = d_M(\pi(q_1), \pi(q_2)),$ as $ \ell_Q(\gamma_i)=\ell_M(\pi\circ\gamma) $;  if it is not minimizing,  $d_Q(q_1,q_2) = \lim_{i \rightarrow \infty} \ell_Q(\gamma_i) = \lim_{i \rightarrow \infty} \ell_M(\pi\circ\gamma_i) > d_M(\pi(q_1),\pi(q_2))$ by definition. Therefore, $ d_Q(q_1,q_2)\geq d_M(\pi(q_1),\pi(q_2)).$
	\end{enumerate}
\end{proof}

\begin{df}\label{df:compatible}
	A riemannian metric on $ Q $ is said to be \textit{compatible} with the induced subriemannian metric if the algebraic splitting $ TQ = V \oplus \mathcal{H} $ is an orthogonal decomposition with respect to the riemannian metric on $ Q$.  
\end{df}

Thanks to the orthogonal algebraic splitting, a compatible riemannian metric is determined by its restriction to $ V, $ and the induced subriemannian structure restricted to $ \mathcal{H} $. This fact can be turned around in the following sense. Take a riemannian metric $ g_Q $ on $ Q. $ Let $ V_q^\perp $ be the orthogonal complement of the vertical space $ V_q $ in $ q\in Q $ with respect to the riemannian metric, and set $ \mathcal{H}_q=V_q^\perp. $ The riemannian metric defines inner products in $ V_q^\perp $  and $ T_mM, $ being defined in the first as the restriction of the riemannian metric, and in the second is given by the metric and the isomorphism $ \mathcal{H}_q\cong T_mM. $ Nevertheless, this inner product on $ T_mM $ can depend on the point $ q\in Q_m $, as the metric could vary with the point of the fiber. If that is the case, we cannot construct a riemannian metric on $ M, $ as there is no consistent way to choose which $ q\in Q_m $ is going to be used to define the inner product (\cite{montgomery2002tour}, page 195).

\begin{df}
	Given a riemannian manifold $ (Q, g_Q), \pi: Q \rightarrow {M}
	$ a submersion, we say that the pair $ (\pi, g_Q) $ is a \textit{riemannian submersion} if for every $ m\in M $ and $ q\in Q_m $,  the isomorphism $ d\pi_q |_{\mathcal{H}_q} $ is an isometry between $ \mathcal{H}_q $ and $ T_m M$. 
\end{df}

\subsection{Metrics on Principal Bundles}%
\label{sub:metrics_on_principal_bundles}

\begin{df}[\cite{lee2003introduction}, page 268]
	Let $ M, G, Q $ be manifolds. A \textit{(locally trivial) fiber bundle} over $ M $ with fiber $ G $ is a manifold $ Q, $ together with a smooth surjective map $ \pi: Q \rightarrow {M}
$ with the property that for each $ x\in M $ there is a neighborhood $ U $ of $ x $ and a diffeomorphism $ \phi:\pi^{-1}(U) \rightarrow {U\times G,}
 $ called a local trivialization of $ Q $ over $ U, $ such that the following diagram commutes:
 \begin{center}
 	\begin{tikzcd}
\pi^{-1}(U) \arrow[rd, "\pi"'] \arrow[rr, "\phi"] &   & U\times G \arrow[ld, "\operatorname{proj}_U"] \\
                                                  & U &                                              
\end{tikzcd}
 \end{center}
 $ Q $ is called the \textit{total space of the bundle}, $ M $ is the \textit{base} and $ \pi $ the \textit{projection}.   
\end{df}

The following definition will require some definitions related to group actions over manifolds, that we will cover next. First of all, recall that for a Lie group $ G $ and a manifold $ Q, $ a \textit{group action} is a smooth application $ \alpha:  Q\times G \rightarrow Q $, denoted by $ \alpha(q,g) = q \cdot g, $ such that:

\begin{itemize}
	\item For all $ q\in Q, $ $ q\cdot e = q $, where $ e $ is the identity element of $ G. $   
	\item For all $ g,h\in G $ and $ q\in Q $, $ (q\cdot g) \cdot h =q\cdot(gh). $ 
\end{itemize}

If this action exists, we say that $ G $ acts on $ Q $ through $ \alpha. $ As a consequence of that definition, we can see that the map $ \alpha_g: Q \rightarrow Q: \ q\mapsto q\cdot g$ is a diffeomorphism for all $ g\in G $, as it is smooth and its inverse is $ \alpha_{g^{-1}}. $

We say that the action $ \alpha $ \textit{is free (or that $ G $ acts freely on $ Q $)} if for all $ q\in Q $, $ q\dot g =q$   implies that $ g=e. $ The \textit{orbit $ G_q $ of the action}  for a point $ q\in Q $  is defined as the image of the restriction $\alpha|_{\{q\}\times G},$  that is, $ G_q := \left\{q\cdot g \ | \ g\in G \right\}. $ We can construct an equivalence relation over $ Q $ in the following way: $ q\sim p $ if and only if $ G_p = G_q, $ that is, if both points belong to the same orbit, or written explicitly, if there is an element $ g\in G $ such that $ q = p\cdot g. $ The set of all equivalence classes is denoted as $ Q/G $, and is known as the \textit{orbit space of the action}.     

The orbit space of an action is not, in general, a manifold, but because of the \textit{quotient manifold theorem} (see \cite{lee2003introduction}, theorem 21.10), it is sufficient to have a free, proper and smooth action in order to guarantee that $ Q/G $ is a topological manifold.

\begin{df}
	The submersion $ \pi: Q \rightarrow M$  is called a \textit{principal $ G $-bundle} if its is a fiber bundle whose fiber $ G $ is a Lie group, and this group acts on $ Q $ in such a way that the following properties hold:
	\begin{itemize}
		\item $ G $ acts freely on $ Q $.
		\item The action orbits are the fibers of $ \pi:Q \rightarrow {M} $, that is, for all $ m\in M, $ $ \pi^{-1}(m) = G_q, $ with $ q\in Q_m. $ 
		\item The local trivializations of the fiber bundle are equivariant with respect to the action, that is, for every local trivialization $ \phi: U \times G \rightarrow \pi^{-1}(U) $, the following property holds: $$ \phi(q, g\cdot h) = \phi(q,g)\cdot h,$$  
			for every $ q\in U, $ and $ g,h\in G. $ 
	\end{itemize}
\end{df}

From this we can conclude that if $ \pi: Q \rightarrow M $ is a principal $ G- $bundle, then $Q/G  $ is a topological manifold, and $M $ is homeomorphic to $ Q/G $. This homeomorphism $ \phi: M \rightarrow {Q/G}$  is given by $ \phi(m)=[q], $ with $ \pi(q)=m. $ 

\begin{df}[\cite{montgomery2002tour}, page 196]
	Given a principal $ G $-bundle $ \pi: Q \rightarrow M, $ we say that a horizontal distribution $ \mathcal{H} $ is a \textit{connection for this principal $ G $-bundle} if it is a connection for $ \pi $ and the $ G $-action on $ Q $ preserves the horizontal distribution $ \mathcal{H} $ in the sense that $ \mathcal{H}_{q\cdot g} = d(\alpha_g)_q (\mathcal{H}_q), $ for all $ q\in Q, $ $ g\in G $. In this case, we say that the pair $ (\pi$, $ \mathcal{H}) $ is a \textit{principal $ G $-bundle with connection}. 

\end{df}

An extremely useful property that any principal $ G $-bundle with connection is that its connection is an Ehresmann connection, \textit{i.e.}, it is complete, as it is stated in the following result. 

\begin{prop}[\cite{kobayashi1963foundations}, proposition 3.1]\label{prop:comp_bundle}
	Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle with connection and $ c: I \rightarrow M $ a smooth curve. For an arbitrary $ q\in Q_{c(0)}= G_q $, there is a unique horizontal lift $ \gamma: I \rightarrow Q $ of $ c $ ($\pi\circ\gamma =c$, $ \dot{\gamma}(t)\in \mathcal{H}_{\gamma(t)} $ for all $ t\in I $) that starts from $ q $.    	
\end{prop}

\begin{df}[\cite{montgomery2002tour}, definition 11.2.1]
	A subriemannian metric $ (\mathcal{H}, \langle\cdot,\cdot\rangle) $ on the total space of the principal $ G $-bundle $ \pi: Q \rightarrow {M}
	 $ is called a \textit{metric of bundle type} if the inner product $ \langle\cdot,\cdot\rangle $ on $ \mathcal{H}$ is induced from a riemannian metric on $ M. $ 
\end{df}

\subsection{Examples of principal $ G $-bundles}%
\label{sub:examples_of_principal_g_bundles}

\subsubsection{Projection of cartesian product of manifolds}%
\label{ssub:projection_of_cartesian_product_of_manifolds}

Let $ M$ be a manifold and $ G $ a Lie group. Define the projection onto the first factor $ \pi: M\times G \rightarrow M. $ It is clear that this map is surjective and a submersion. Moreover, it is a fiber bundle, whose local (global) trivialization is the identity map $ \iota : M\times G \rightarrow M\times G $.   

If we define the action $ \alpha: (M\times G) \times G \rightarrow M\times G $ as $ ((p, g),q)\mapsto (p,gq)  $, it is clear that $ G $ acts freely on $ M\times G $, $\iota(p, gh) = \iota(p,g)\cdot h $ (the local trivialization is equivariant with respect to the action) and $ \pi^{-1}(p) = \left\{ p \right\}\times G = G_{(p,g)} $, so that $ \pi $ is a principal $ G $-bundle. A connection for this bundle is the distribution $ \mathcal{H}_{(p,g)}= \operatorname{Ker} d\tilde{\pi}_(p,g)\subset T(M\times G) $, with $ \tilde{\pi}:M\times G \rightarrow G $ the projection onto the second factor.
\subsubsection{Hopf Fibration}%
\label{ssub:hopf_fibration}

All rotations in $ \mathbb{R}^3 $ can be expressed compactly with help of quaternions. The set of quaternions is denoted as $ \mathbb{H} := \{ a+bi+cj+dj$  $|$  $a,b,c,d\in \mathbb{R} \}, $ and in it we can define sum and product operations. The sum of two quaternions $ a_1+b_1 i +c_1 j  + d_1k $, $ a_2+b_2 i +c_2 j  + d_2k $ is $ (a_1+a_2)+(b_1+b_2)i+(c_1+c_2)j+(d_1+d_2)k. $ The product is defined in order to satisfy the distributive property with respect to the sum, and it also satisfies the following rules: 
$$ i^2=j^2=k^2=-1, \quad ij=-ji=k, jk=-kj=i, ki = -ik=j.  $$ 
In analogy with the complex plane and its isomorphism with $\mathbb{R}^4$, we define the norm of $ z= a+bi+cj+dk $ as $ |z|=\sqrt{a^2+b^2+c^2+d^2}, $ and the conjugate of $ z $ as $ z^* = a-bi-cj-dk. $ Moreover, every quaternion $ z\neq 0 $ has a multiplicative inverse, given by $ z^{-1} = z^*/|z|^2. $ Every rotation around an axis given by a vector $ \vec{v}=(b,c,d) $ and an angle $ \theta $ can be identified with an unitary quaternion $r = a+bi+cj+dk$ ($|z|=1$),  where $ \theta = 2\arccos(a) $ (see \cite{lyons2003elementary}, page 6). This rotation $ R_r: \mathbb{R}^3 \rightarrow\mathbb{R}^3 $ is given by $ x\mapsto rxr^{-1}= rxr^*$, and $ x $ identified as a pure quaternion, that is, $ x=x_1i+x_2j+x_3k. $ To show explicitly that this map is the desired rotation, one can first show that this linear map preserves norm and the vector $ bi+cj+dk $, that is, it is an eigenvector with eigenvalue 1, so it must be a rotation with respect the axis given by $ (b,c,d) $. The idea of the proof that the rotation angle is $ 2\arccos(a) $ can be found in \cite{lyons2003elementary}, page 6, investigation step 3. 

The set of all unitary quaternions is $ \mathbb{S}^3 $, so that $ \mathbb{S}^3 $ acts on $ \mathbb{R}^3 $ via rotations. The Hopf projection is defined as the map $ \pi: \mathbb{S}^3 \rightarrow \mathbb{S}^2 $ that sends the point $ (1,0,0) $ (identified as the quaternion $ i $)   to its respective image after rotating $ \mathbb{R}^3 $ with the associated quaternion, as an element of $ \mathbb{S}^3 $. That is, $ \pi(a,b,c,d) = R_r(1,0,0), $ where $ r=a+bi+cj+dk. $  The function $ \pi $ previously defined is surjective, as every point $ x\in\mathbb{S}^2 $ can be reached from $ (1,0,0) $ through an adequate rotation. Explicitly, it suffices to take a normal vector to both $ (1,0,0), x $ as the axis of rotation, and the angle of rotation is the angle between both vectors. 

	If we identify $ \mathbb{R}^4=\mathbb{C}\times \mathbb{C} $ and $ \mathbb{R}^3= \mathbb{R}\times\mathbb{C}  $, Hopf projection from $ \mathbb{S}^3= \{ (z_1,z_2)\  |$ $ \ z_1,z_2\in \mathbb{C}, \ |z_1|^2+|z_2|^2=1 \} $ to $ \mathbb{S}^2 = \{ (x,z)\ | \ z\in \mathbb{C},\ x\in \mathbb{R},\ |z|^2+$ $x^2=1 \} $  can be written as $ \pi: \mathbb{S}^3 \rightarrow { \mathbb{S}^2},$ $ \pi(z_1,z_2) =(|z_1|^2-|z_2|^2, 2z_1z_2^* ),$ because writing explicitly $ rir^{-1} $ with $ r=a+bi+cj+dk $ gives $ (a^2+b^2-c^2-d^2)i+2(ad+bc)j+2(bd-ac)k. $    In this form one can show that this map is a submersion analyzing the minors of the jacobian matrix in cartesian coordinates (see \cite{linintroductory}, proof of theorem 3.11).

	To recognize the fibers of this submersion, notice that $ \pi^{-1}(1,0) = \left\{ (w_1,0) \ | \ |w_1| =1 \right\} = \left\{ (e^{i\theta},0) \ | \ \theta\in (0,2\pi]  \right\} $. Now, in quaternion notation, if $ s,r\in \pi^{-1}(x), $ $ rir^{-1} = sis^{-1}=x $, that is, $ (s^{-1}r)i(r^{-1}s) = i $. Then, $ s^{-1}r \in \pi^{-1}(1,0), $ and $ r= se^{i\theta}, $ so $ \pi^{-1}(x) = \left\{ re^{i\theta}\ | \ \theta\in (0,2\pi] \right\} $, and each fiber is diffeomorphic to $ \mathbb{S}^1. $        

	With this, $ \mathbb{S}^3 $ can be seen as the disjoint union of these circles, and endowing this disjoint union with the standard manifold structure of $ \mathbb{S}^3 $, we identify $ \mathbb{S}^2 = \mathbb{C}P^1$, and take the open sets $ U_i= \left\{ \left[ z_0 : z_1 \right]\ | \ z_i\neq 0 \right\}$, with $ i=0,1. $ The local trivializations are (see \cite{luke2013vector}, page 68) $ \varphi_i: U_i \times \mathbb{S}^1 \rightarrow \pi^{-1}(U_i), $ $$ \varphi_i([z_0:z_1], \lambda) = \left( \frac{\lambda}{\sqrt{1+|\omega_i|^2}}, \frac{\lambda\omega_i}{\sqrt{1+|\omega_i|^2}}   \right), $$ with $ \omega_0=z_1/z_0 $ and $ \omega_1 = z_0/z_1. $ Now, we define an action $ \alpha: \mathbb{S}^3\times \mathbb{S}^1 \rightarrow { \mathbb{S}^3}
	$, given by $ \alpha(z_1,z_2,\lambda) = (z_1\lambda, z_2\lambda), $ where $ (z_1,z_2)\in \mathbb{S}^3\subset \mathbb{C}^2 $ and $ \lambda\in \mathbb{S}^1 \subset \mathbb{C}. $ This action acts freely on $ \mathbb{S}^3, $ and its orbits coincide with the fibers of $ \pi, $ so that $ \mathbb{S}^3/ \mathbb{S}^1 \cong \mathbb{S}^2. $ From this point it is clear that the Hopf bundle is a fiber bundle, and its local trivializations are equivariant with respect to the action, as $ \varphi_i([z_0:z_1], \lambda_1\lambda_2) = \varphi_i([z_0:z_1], \lambda_1)\lambda_2. $ Therefore, $ \pi: \mathbb{S}^3 \rightarrow { \mathbb{S}^2} $ is a principal $ \mathbb{S}^1$-bundle.

	To find a connection for this submersion, we recall that, by the preimage of regular value theorem, $ \pi^{-1}(m) = \mathbb{S}^1_q $ is a submanifold of $ \mathbb{S}^3 $, of dimension $ \operatorname{dim}( \mathbb{S}^3)- \operatorname{dim}( \mathbb{S}^2) = 1,  $ and its tangent space (vertical space of the submersion) $ T_q \mathbb{S}^1_q $ is $ \operatorname{Ker}(d\pi_q),  $ and any complementary subspace (with respect to $ T \mathbb{S}^3 $)  to this tangent space would be a connection. Now, if $ \mathbb{S}^3 $ is endowed with the standard riemannian structure, there is only one connection compatible with the metric, and is given by $ \mathcal{H}_q = \operatorname{Ker}(d\pi_q)^\perp. $ The vector that determines $ \operatorname{Ker}(d\pi_q)  $ can be found using the action if we consider the tangent vector of the curve $ \gamma: (-\epsilon, \epsilon) \rightarrow \mathbb{S}^3, $ $ t\mapsto \gamma(z_1,z_2, e^{it})=(z_1e^{it},z_2e^{it}) $ at $ t=0 $, where $ q=(z_1,z_2). $ With this, $ \operatorname{Ker}(d\pi_q) = \langle(iz_1, iz_2)\rangle,  $ and the connection at $ q\in \mathbb{S}^3 $,  $ \mathcal{H}_q $, will be the orthogonal complement (with respect to $ \mathbb{R}^4 $ provided with the usual norm) of the vector space $ \langle(iz_1,iz_2), (z_1,z_2)\rangle  {= \langle(x_1,y_1,x_2,y_2), (-y_1,x_1,-y_2,x_2)\rangle}$, that is, $ \mathcal{H}_q = \langle(x_2,-y_2,-x_1,y_1),(y_2,x_2,-y_1,-x_1)\rangle, $ where $ q=(x_1+iy_1, x_2+iy_2). $   

	This principal $ \mathbb{S}^1$-bundle has connection because the kernel of $ d(\pi\circ \alpha_g)_q $ is the same of $ d\pi_q, $ as $ d\alpha_g $ is an isomorphism. Therefore, $ d(\alpha_g)_q ( \mathcal{H}_q) = \mathcal{H}_{q\cdot g}, $ and the $ \mathbb{S}^1 $-action preserves $ \mathcal{H}. $ By proposition \ref{prop:comp_bundle}, this connection $ \mathcal{H} $ is complete.  
 
\subsection{The main theorem}
Before proceeding with one of the principal results on subriemannian geometry and metrics on bundles, we need to recall some definitions and important results of symplectic geometry. Therefore, this subsection is dedicated to the study of these prerequisites and to the statement and proof of the \say{main theorem}. To start, we consider what is a symplectic structure, and we develop this idea with help of the cotangent bundle.
\begin{df}[\cite{arnol2013mathematical}, section 8A]
	Let $ M $ be an even-dimensional manifold. A \textit{symplectic structure on $ M $ } is a closed non-degenerate differential 2-form $ \omega $ on $ M $, that is, 
	$$ d\omega=0 \text{ and } \forall \xi \neq 0: \ \omega_x(\xi,\cdot)\neq0 \ (\xi\in T_x M).$$ 
	The non-degeneracy condition is equivalent to say that $ \operatorname{det}(\omega)\neq0 $. The pair $ (M,\omega) $ is called a \textit{symplectic manifold}. 
\end{df}

\begin{ex}[Canonical symplectic structure on $ \mathbb{R}^{2n}$]
	Consider $ \mathbb{R}^{2n} $ with canonical coordinates $ (q_1,q_2,\dots,q_n,p_1,p_2,\dots,p_n) $. The 2-form $ \omega = dp_i\wedge dq_i $ is closed and non-degenerate, so that the pair $ ( \mathbb{R}^{2n}, dp_i\wedge dq_i) $ is a symplectic manifold.  
\end{ex}

\begin{df}[\cite{montgomery2002tour}, definition A.4.1]
	A \textit{Hamiltonian} is a smooth function $ H: M \rightarrow \mathbb{R}, $ where $ (M,\omega) $ is a symplectic manifold.
\end{df}

\begin{df}[\cite{arnol2013mathematical}, page 203]
	For each vector $ \xi\in T_mM  $ tangent to a symplectic manifold $ (M,\omega), $ we associate a 1-form $ \omega_\xi\in T^*_mM $ by the formula $$ \omega_\xi(\eta)=\omega(\xi,\eta). $$  
\end{df}

This last definition induces an isomorphism between $ T_mM $ and $ T^*_mM, $ given by the map $ \xi \mapsto \omega_\xi. $ If $ H: M \rightarrow \mathbb{R} $ is a Hamiltonian, then $ dH = \partial_i H dq^i $ is a differential 1-form on $ M, $ and by the previous isomorphism, at every point $ m\in M $ there is a tangent vector $ (X_H)_m \in T_mM $ such that $ (dH)_m = \omega_{(X_H)_m}. $ 

\begin{df}
	For a given Hamiltonian $ H: M \rightarrow \mathbb{R} $, the vector field $ X_H\in \mathfrak{X}(M) $ that satisfies $$ dH = \omega(X_H, \cdot) $$ is called \textit{Hamiltonian vector field} for $ H $, or \textit{symplectic gradient} of $ H. $ 
\end{df}

Over an arbitrary manifold $ M $, we can construct a symplectic manifold using the cotangent bundle. Suppose that $ M $ is an $ n$-dimensional manifold. $ T^*M= \bigsqcup_{p\in M} T^*_p M$ is then a $ 2n $-dimensional manifold. There is a canonical choice of coordinates for this space, namely, given $ x\in M, $ there is a coordinate chart $ (U_x,\phi) $ on $ M $ such that $ q=\phi(x)=(q_1,\dots,q_n)\in \mathbb{R}^n, $ and for a given 1-form $ \alpha\in T_xM,$ in these coordinates we have that $ \alpha=p_i dq^i; $ mixing these two coordinates we get the \textit{canonical coordinates of $ T^*M $}, where a given element $ \alpha\in T^*M $ can be represented locally as the pair of coordinates $ (q,p). $      

\begin{thm}[\cite{arnol2013mathematical}, page 202]
	The cotangent bundle $ T^*M $ has a natural symplectic structure given in coordinates by $\omega = dq^i\wedge dp_i.$
\end{thm}

\begin{proof}
	Let $ \xi\in T_p \left( T^*M \right)  $ be a vector tangent to the cotangent bundle at $ p\in T^*_x M. $ If $ \pi:T^*M \rightarrow M $ is the natural projection, the derivative $ d\pi : T \left( T^*M \right) \rightarrow TM $ takes $ \xi $ to $ d\pi(\xi)=(\pi(p), d\pi_p(\xi))=(x,d\pi_p(\xi)), $ which is a vector tangent to $ M $ at $ x. $ We define a 1-form $ \theta $ on $ T^*M $ by the relation $ \theta(\xi)=p(d\pi_p(\xi)). $ In local coordinates this form is $ \theta= p_i dq^i, $ and the form $ \omega = d\theta $ is non-degenerate. 
\end{proof}

Given that $ (T^*M, \omega = dq^i\wedge dp_i) $ is a symplectic manifold, for a Hamiltonian $ H: T^*M \rightarrow \mathbb{R}, $ there is a vector field $ X_H \in \mathfrak{X}(T^*M) $ such that $ dH = \omega (X_H,\cdot) $. Writing $ X_H $ in coordinates, $ X_H = X_i \partial q^i + X^i \partial p_i, $ and evaluating $ \partial q^j $ and $ \partial p_j $ in $ dH $ gives  

$$ dH(\partial q^j) = \frac{\partial H}{\partial q^j} = \omega(X_H, \partial q^j) = -\omega(\partial q^j, X_H) = -X^j, \text{ and}  $$ 
$$ dH(\partial p_j) = \frac{\partial H}{\partial p_j} =\omega(X_H, \partial p_j)=X_j, $$ 

so that $ X_H = (\partial H/\partial p_j)\partial q^j - (\partial H / \partial q^j)\partial p_j $, and its integral curves are defined by the following system of differential equations:
$$ \dot{q^i} = \frac{\partial H}{\partial p_i}, \quad \dot{p_i} =- \frac{\partial H}{\partial q^i}.   $$ 
This system of differential equations receives the name of \textit{Hamilton equations for $ H $.} Despite this formulation on the cotangent bundle came centuries after Hamilton, these equations are known by its name because of the similarities of their form with the ones that are obtained using the generalized momentums instead of the classical velocity and position variables in classical mechanics. Moreover, this method turns out to be a generalization of Hamiltonian mechanics to arbitrary spaces and energy functions.

\begin{thm}\label{thm:constantCurves}
The Hamiltonian $ H: T^*M \rightarrow \mathbb{R} $ is constant along the integral curves of the vector field $ X_H. $ 	
\end{thm}

\begin{proof}
	Suppose that $ c:I\subseteq \mathbb{R} \rightarrow T^*M $ is an integral curve of $ X_H. $ Then, the composition $ (H\circ c) (t) $ can be differentiated with help of the transition maps on $ T^*M. $ Let $ t\in I, $ and $ (U_{c(t)}, \varphi) $ be a coordinate chart. Then, 
	%\begin{multline}
		
	$$ \frac{d}{dt} (H\circ c)(t) = \frac{d}{dt} \left( \left( H\circ \varphi^{-1} \right)\circ \left( \varphi\circ c \right) \right)(t) = \frac{d(\varphi\circ c)^i}{dt}\cdot \frac{\partial (H\circ \varphi^{-1})}{\partial q^i}= X_H^i \partial_i H $$ $$= dH(X_H)=\omega(X_H, X_H)=0,$$    
	%\end{multline}

	and $ H $ is constant throughout the curve $ c $, given the skew-symmetry of $ \omega $. 
\end{proof}

\begin{df}[\cite{montgomery2002tour}, example 2, section A.4]
	For any vector field $ \xi\in \mathfrak{X}(M), $ we define its \textit{ momentum function $ P_\xi:T^*M \rightarrow \mathbb{R} $} by
	$$ P_\xi(q,p)= p(\xi_q). $$ 
\end{df}

\begin{ex}[\cite{montgomery2002tour}, example 1, section A.4]
	If $ \xi=\partial q^i\in \mathfrak{X}( \mathbb{R}^n), $ its momentum function will be	
	$$ P_{\partial q^i}(q,p)=p(\partial q_i) = p_i. $$ 
	In the other hand, if we take the Hamiltonian $ H(p,q)=p_i, $ we get that $ X_H=\partial q^i. $ 
\end{ex}

In local coordinates, $ P_\xi = p_i \xi_q^i. $ Computing its Hamilton equations gives
$$ \dot{q^i} = \xi_q^i,\quad \dot{p_i} = -p_j \frac{\partial \xi_q^j}{\partial q^i}.  $$ 
The first Hamilton equation says that the flow of the Hamiltonian vector field $ X_{P_\xi} $ on $ T^*M $ projects onto the flow of the original vector field $ \xi $ on $ M $ (\cite{montgomery2002tour}, page 278). To understand the second Hamilton equation, recall that the \textit{cotangent lift} $ \Phi_{T^*}: T^*M \rightarrow T^*M $ of any diffeomorphism $ \Phi : M \rightarrow M $ is given by 
$$ \Phi_{T^*}(q,p) = (\Phi(q), (\Phi^{-1})^*_{\Phi(q)}(p)),\ p\in T^*_qM,$$ 
where $ (\Phi^{-1})^* $ is the pullback of $ \Phi^{-1} $, that is,
$$ (\Phi^{-1})^*_{\Phi(q)}(p)(\eta) = p_q \left( d\Phi^{-1}_{\Phi(q)}(\eta) \right) $$ 
for every $ \eta\in T_{\Phi(q)}M. $ If $ \Phi_t: M \rightarrow M $ is the flow of the vector field $ \xi, $ then the flow of $ X_{P_\xi} $ is $ (\Phi_t)_{T^*}, $ as
$$ (\Phi_t)_{T^*}(q,p) = \left( \Phi_t(q), p_q \left( d(\Phi_{-t})_{\Phi(q)}(\cdot) \right) \right), $$ 
and the first component represents the flow of $ \xi, $ while the second component is in coordinates $ p_i (\partial (\Phi_{-t})^i/\partial q^j)dq^j, $ so differentiating this expression with respect to $ t $ at $ t=0 $ gives $ -p_i (\partial \xi_q^i/\partial q^j)dq^j, $ which is the 1-form whose coordinates are equal to the coordinates on $ p $ of $ X_{P_\xi} $. Therefore, the second Hamilton equation for $ P_\xi $ asserts that the Hamiltonian flow is the cotangent lift of this flow on the configuration space $ M $ (\cite{montgomery2002tour}, page 278). Summarizing, we have the formula 
$$ X_{P_\xi} = \frac{d(\Phi_t)_{T^*}}{dt} \Big|_{t=0}.  $$ 

\begin{df}
	Let $ f,g: T^*M \rightarrow \mathbb{R} $ be two observables. We define the \textit{Poisson bracket of $ f $ and $ g $ } as 
	$$ \left\{ f,g \right\}= X_g(f),$$ 
	where $ X_g  $ is the Hamiltonian vector field associated with $ g. $ 
\end{df}
The Poisson bracket is in coordinates
$$ \left\{ f,g \right\} = \frac{\partial g}{\partial p_i}\frac{\partial f}{\partial q^i} - \frac{\partial g}{\partial q^i} \frac{\partial f}{\partial p_i}.   $$ 
Another way to write the Poisson bracket of $ f $ and $ g $ using the symplectic form $ \omega $ of $ T^*M $ is the following:
$$ \left\{ f,g \right\} = df(X_g)=\omega (X_f,X_g). $$ 
\begin{prop}
	The Poisson bracket satisfies the following properties:
	\begin{enumerate}
		\item $ \left\{ f,g \right\} = -\left\{ g,f \right\},$ 
		\item $ \left\{ af+bg,h \right\} = a\left\{ f,g \right\}+ b \left\{ g,h \right\} ,   $ 
		\item $ \left\{ f, \left\{ g,h \right\}  \right\} +\left\{ h, \left\{ f,g \right\}  \right\} + \left\{ g, \left\{ h,f \right\}  \right\} =0, $  
		\item $ \left\{ f,gh \right\} =g \left\{ f,h \right\} + \left\{ f,g \right\} h,$ 
	\end{enumerate}
	where $ f,g,h: T^*M \rightarrow \mathbb{R} $ are observables, and $ a,b\in \mathbb{R}. $ 
\end{prop}
\begin{proof}
	(\cite{poisson}, proof of proposition 1.3) Properties 1,2,3 and 4 are trivial. The third property, known as the \textit{Jacobi identity},  is equivalent to the fact that $ \omega $ is a closed form ($ d\omega =0 $), as will be shown next. Recall that $$ d\chi(X,Y,Z)=X\chi(Y,Z)-Y\chi(X,Z)+Z\chi(X,Y)-\chi([X,Y],Z)+\chi([X,Z],Y)-\chi([Y,Z],X) $$ 
	for any 2-form $ \chi $ and $ X,Y,Z\in \mathfrak{X}(T^*M). $ Therefore, 
	

$\begin{aligned}
	d \omega\left(X_{f}, X_{g}, X_{h}\right) &=X_{f}\{g, h\}-X_{g}\{f, h\}+X_{h}\{f, g\}+\left[X_{f}, X_{g}\right] h-\left[X_{f}, X_{h}\right] g+\left[X_{g}, X_{h}\right] f \\
&=\{f,\{g, h\}\}-\{g,\{f, h\}\}+\{h,\{f, g\}\}+\{f,\{g, h\}\}-\{g,\{f, h\}\} \\
&-\{f,\{h, g\}\}+\{h,\{f, g\}\}+\{g,\{h, f\}\}-\{h,\{g, f\}\} \\
&=3 \left( \left\{ f, \left\{ g,h \right\}  \right\} +\left\{ h, \left\{ f,g \right\}  \right\} + \left\{ g, \left\{ h,f \right\}  \right\}\right).  
\end{aligned}$

From the last expression it is clear that $ d\omega=0 $ is equivalent to the Jacobi identity.
\end{proof}
The first three properties of last proposition guarantee that $ \left( C^\infty(T^*M), \left\{ \cdot,\cdot \right\}  \right) $ is a Lie algebra. The last property ia known as Leibniz identity, because due to it the operator $ f\mapsto \left\{ f,H \right\}  $, with $ H $ a Hamiltonian, is a derivation on $ C^\infty(T^*M): $ 

$$ \left\{ fg,H \right\} =f \left\{ g,H \right\} +g \left\{ f,H \right\} . $$ 
Therefore, $ f\mapsto \left\{ f,H \right\}  $ is a vector field on $T^*M$: the Hamiltonian vector field of $ H, \ X_H $ (\cite{montgomery2002tour}, page 279).

\begin{prop}[Hamilton equations in bracket form]
	If $ c(t) $ is an integral curve for $ X_H $ and $ f\in C^\infty(T^*M) $ is an observable, then
	\begin{equation}\label{eq:HamEq}
		\frac{d}{dt} \left( f\circ c \right)(t) = \left\{ f,H \right\} (c(t)).
	\end{equation}
\end{prop}
\begin{proof}
	Following the steps of the proof of theorem \ref{thm:constantCurves}, we obtain that
	$$ \frac{d}{dt} \left( f\circ c \right) (t)=\omega(X_f, X_H)= \left\{ f,H \right\}(c(t)).  $$ 
\end{proof}

We write $ \dot{f}= \left\{ f,H \right\} $ to refer to the expression \eqref{eq:HamEq}, valid for any observable $ f. $ Equation \eqref{eq:HamEq} also receives the name of Hamilton equations, and when $ f $ runs over the canonical coordinates $ q^i,p_i, $ we get the Hamilton equations previously stated.

\begin{prop}[Poisson bracket of momentum functions]
	For any two vector fields $ \xi,\eta \in \mathfrak{X}(M) $ with momentum functions $ P_\xi, P_\eta: T^*M \rightarrow \mathbb{R}, $ we have that
	$$ \left\{ P_\xi,P_\eta \right\} = -P_{[\xi,\eta]}, $$ 
	where $ [\xi,\eta] $ is the Lie bracket between $ \xi $ and $ \eta, $ and $ P_{[\xi,\eta]} $ is the momentum function of $ [\xi,\eta]\in \mathfrak{X}(M). $  
\end{prop}
\begin{proof}
	Follows directly from calculus in coordinates.
\end{proof}
If $ (M,g) $ is a riemannian manifold, we define the \textit{riemannian Hamiltonian} $ H_R: T^*M \rightarrow \mathbb{R} $ as
$$ H_R(q,p)=\frac{1}{2} g_q(p,p).$$
In local coordinates, $  H_R(q,p)= g^{ij}(q)p_ip_j/2. $ This Hamiltonian has the following Hamilton equations:
$$ \dot{q^i} = \frac{\partial H_R}{\partial p_i} = g^{ij}p_j, \quad \dot{p_i} = - \frac{\partial H}{\partial q^i} = - \frac{1}{2} \frac{\partial g^{jk}(q)}{\partial q^i} p_jp_k. $$ 
From the first Hamilton equation we deduce that $ p_i = g_{ij}\dot{q^j}, $ and substituting this expression in the second Hamilton equation gives $$ \dot{p_i} = \frac{1}{2} \frac{\partial g_{ml}}{\partial q^i}\dot{q^m}\dot{q^l} ,$$ so that 
$$ \ddot{q^i} = \frac{\partial g^{ij}(q)}{\partial q^k} \dot{q^k}p_j+ g^{ij}\dot{p_j}= \frac{1}{2} g^{ij} \left( \frac{\partial g_{kl}}{\partial q^j}-2 \frac{\partial g_{jl}}{q^k}   \right)\dot{q^k}\dot{q^l} = -\Gamma_{kl}^i \dot{q^k}\dot{q^l},$$ 
and $ q $ satisfies the geodesic equation, from where we deduce that the integral curves of $ X_{H_R} $ are geodesics. Moreover, any geodesic $ q(t) $ satisfies Hamilton equations, given that $ p_i = g_{ij}\dot{q^j}. $ From this discussion we derive the following proposition.

\begin{prop}
	If $ (M,g) $ is a riemannian manifold, and $ H_R: T^*M \rightarrow \mathbb{R} $ is its riemannian Hamiltonian, $ q(t) $ is a geodesic if and only if $ (q^i(t), g_{ij}(q(t))\dot{q^j}(t)) $ is an integral curve of $ X_{H_R}. $ 
\end{prop}

Recall that given a riemannian manifold $ (M,g), $ we can construct a metric $ g^*_q $  over every cotangent fiber $ T^*_q M, $ using the identification
$$ g^*_q(v^*,w^*):=g_q(v,w), $$ 
where $ v^*,w^*\in T^*_qM, $ and $ v,w\in T_qM $ are the preimages of $ v^*,w^* $ via the isomorphism $ T^*_qM\cong T_qM $ induced by the metric $ g $, that is, $ v^*=g_q(v,\cdot) $ and $ w^*=g_q(w,\cdot) $. In coordinates, if $ g_q=g_{ij}(q) $, then $ g^*_q=g^{ij}(q), $ that is, the representation in coordinates of the metric in the cotangent fiber is equivalent to the inverse matrix of the representation in coordinates of the metric in the tangent fiber.   

Now, if $ M $ is a manifold with a subriemannian structure $ \left( \mathcal{H}, \langle \cdot,\cdot \rangle \right)  $ over it, we can define a \textit{cometric}, that is just a metric over the fibers of the cotangent bundle as follows. Given that $ \langle \cdot,\cdot \rangle_q $ is a metric for $ \mathcal{H}_q, $ for any $ v^*\in T^*_qM $ there exists a single $ V\in \mathcal{H}_q $ such that $ v^*|_{\mathcal{H}_q} = \langle V,\cdot \rangle_q $. With this property, we can define the cometric $ (\cdot,\cdot)\in \mathfrak{X}_2^0(M) $ as a bilinear form (in general it is not a metric) over the fibers of the cotangent space as follows:
$$ (v^*,w^*)_q= \langle V,W \rangle_q, $$ 
where $ v^*,w^*\in T^*_qM $, and $ V,W\in \mathcal{H}_q $ are such that $ v^*|_{\mathcal{H}_q}= \langle V,\cdot \rangle_q, $ $ w^*|_{\mathcal{H}_q}= \langle W,\cdot \rangle_q. $ 
\begin{df}[\cite{montgomery2002tour}, definition 1.5.2]
	If $ M $ is a manifold, and $ \left( \mathcal{H}, \langle\cdot,\cdot\rangle \right) $ is a subriemannian structure over it, we define the subriemannian Hamiltonian $ H_{sR}: T^*M \rightarrow \mathbb{R} $ as $$ H_{sR}(p,q)= \frac{1}{2} (p,p)_q, $$   	
	where $ (\cdot,\cdot) $ is the cometric induced by $ \langle\cdot,\cdot\rangle. $ 
\end{df}
If $ \pi: Q \rightarrow M $ is a submersion, and $ (M,g) $ is a riemannian metric, we know that the submersion induces a subriemannian structure on $ Q, $ $ (\mathcal{H},\langle\cdot,\cdot\rangle) $, where $ \mathcal{H} $ is the Ehresmann connection associated with $ \pi $, and $ \langle\cdot,\cdot\rangle $ is defined by the isomorphism $ d\pi_q|_{\mathcal{H}_q}: \mathcal{H}_q \rightarrow T_{\pi(q)}M $ and the metric $ g $ on $ M. $ 

The subriemannian Hamiltonian $ H_{sR}: T^*Q \rightarrow \mathbb{R}$ can be written in terms of the riemannian Hamiltonian $ H_R: T^*M \rightarrow \mathbb{R} $ in the following way: given the splitting $ TQ= \mathcal{H}\oplus V, $ we have that $ T^*Q = \mathcal{H}^* \oplus V^*, $ and so we have the canonical projection $ \operatorname{pr}_1: T^*Q \rightarrow \mathcal{H}^*. $ Now, we define a second projection $ \operatorname{pr}_2: \mathcal{H}^* \rightarrow T^*M $ by the formula $ \operatorname{pr}_2(\alpha)(v)=\alpha(h_q v), $ where $ \alpha\in \mathcal{H}^*_q, $ $ v\in T_{\pi(q)}M, $ and $h_qv$ is the horizontal lift of $ v $ into $ \mathcal{H}_q $ (well-defined and unique, because $ \mathcal{H} $ is an Ehresmann connection).
\begin{prop}[\cite{montgomery2002tour}, proposition 11.1.5]
	The induced subriemannian Hamiltonian is given by $H_{sR}= H_R \circ \operatorname{pr_2}\circ \operatorname{pr_1}. $ 
\end{prop}

\begin{df}
	Let $ (M,g) $ be a riemannian manifold, and $G $ a Lie group that acts on $ M $ via the application $ \alpha: M\times G \rightarrow M, $ $ \alpha(m,h)= m\cdot h. $ We say that \textit{the metric $ g $ is $ G $-invariant} if  
	$$ g_{m\cdot h}((d\alpha_h)_m(v),(d\alpha_h)_m(w))=g_m(v,w), $$ 
	for all $ m\in M, $ $ v,w\in T_mM $ and $ h\in G. $ 
\end{df}

Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle with connection $ \mathcal{H}. $ If $ (\mathcal{H},\langle\cdot,\cdot\rangle) $ is a metric of bundle type, we say that a metric $ h $ on $ Q $ is a \textit{compatible riemannian metric} if $ h $ is $ G $-invariant and compatible (see definition \ref{df:compatible}). From this definition, it is clear that $ h|_{G_q}: TG_q \oplus TG_q \rightarrow \mathbb{R} $ is a right-invariant metric, and we can use it to define a metric on $ G $ as follows:

Let $ \mathfrak{g}= \operatorname{Lie}(G)=T_eG, $ and $ \operatorname{exp} : \mathfrak{g}\rightarrow G $ be the exponential application. \textit{The infinitesimal generator map for the group action $ \sigma_q: \mathfrak{g}\rightarrow T_qQ $ } is defined as
$$ \sigma_q(v) = \frac{d}{d\epsilon} \Big|_{\epsilon=0} \left( q\cdot \operatorname{exp} (\epsilon v) \right).$$ 

\begin{df}[\cite{montgomery2002tour}, definition 11.2.3]
	For a given $ q\in Q, $ the bilinear form on $ \mathfrak{g}, $ $ \mathbb{I}_q: \mathfrak{g}\times \mathfrak{g}\rightarrow \mathbb{R}, $ given by
	$$ \mathbb{I}_q(v,w) = h_q(\sigma_q v, \sigma_q w) $$ 
	is called the \textit{moment of inertia tensor at $ q. $ } 
\end{df}
\bibliographystyle{unsrt}
\nocite{*}
\bibliography{mybibliography}

\end{document}
