%%%% DESCRIPTION %%%%%
% Title of Document: 
% Start Date: 
%%%%%%%%%%%%%%%%%%%%%%%%
%%%FINAL CHECK%%%%%%%%%
%read text
%Bibliography list
%spell check
%chklatex
%unusedlabels
%Overfull

\documentclass[12pt, letterpaper, reqno]{amsart}

\usepackage[utf8]{inputenc}
% indicate the language, for example, spanish or russian
\usepackage[english]{babel}
%\usepackage[spanish]{babel}

%comments
\usepackage{comment}

%drawings
\usepackage{graphicx}

%commutative diagrams
\usepackage[all]{xypic}

\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{breqn}
\usepackage{tikz-cd}
\usepackage{bbold}
%%%%%%%%%%%%%%%%%
\newcommand{\incfig}[2][1]{%
    \def\svgwidth{#1\columnwidth}
    \import{./figures/}{#2.pdf_tex}
}
% why do we need this command?
% \includegraphics does not work? 
% - it does work, but i need to use it
% because the images that i create are in
% .svg format (which provides more advantages),
% so they need to be converted to pdf and inserted
% using that command.
%%%%%%%%%%%%%%%%%%

\pdfsuppresswarningpagegroup=1

%todonotes
\usepackage[colorinlistoftodos,prependcaption,backgroundcolor=white,size=tiny,textwidth=50pt]{todonotes}
\setlength{\marginparwidth}{2cm}

%%%%%%%% DIMENSIONS %%%%%%%%%%%
\textwidth=16truecm
\textheight=22truecm
\topmargin=0pt
\oddsidemargin=0pt
\evensidemargin=0pt
\baselineskip1.2truecm

%%%%%%%% THEOREMS %%%%%%%%%%%%
\theoremstyle{definition}
%\newtheorem{df}{Definition}
\newtheorem{df}{Definition}
\theoremstyle{plain}
\newtheorem{prop}{Proposition}
%\newtheorem{prop}{Proposición}
\newtheorem{thm}{Theorem}
%\newtheorem{thm}{Teorema}
\newtheorem{lm}{Lemma}
%\newtheorem{lm}{Lema}
\newtheorem{cor}{Corollary}
%\newtheorem{cor}{Corolario}
\theoremstyle{remark}
\newtheorem{ex}{Example}
%\newtheorem{ex}{Ejemplo}
\newtheorem{rem}{Remark}
%\newtheorem{rem}{Observación}

%%%%%%%% COMMENTS (REMOVE THEM IN THE FINAL VERSION!!!) %%%%%%%
\def\comment#1{{\par \tt #1}}

%%%%%%%%% FOR DRAFT%%%%%%%%%%%%%
%\renewcommand{\baselinestretch}{1.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%% PAPER DATA %%%%%%%%%%%%%%%%%%%
\author{Julián Jiménez Cárdenas}
\address{}


\title[Posgraduate Project]{Posgraduate Project}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\maketitle
\begin{abstract}
\end{abstract}

\section*{Introduction}
\label{sec:0}


\section{Distributions}
\label{sec:1}

\subsection{Distributions and Horizontal Curves}%
\label{sub:distributions}


A manifold without boundary $M$ of dimension $ m $  is said to be of class $ C^\infty $ if the differentiability class of the transition maps is $C^\infty.$ In this case, for every $ p\in M $ one can define the tangent space to $ M $ at $ p $, $ T_p M $, as the set of all derivations of the algebra of germs of smooth functions from $ M $ to $ \mathbb{R}  $,  based at $ p $. This definition of tangent space is equivalent (when the differentiability class of $ M $ is $ \infty $) to the equivalence class of germs of curves that passes through $ p $. If a manifold $ M $  is $C^r$, with $r< \infty$, the definition for tangent space is the latter, so we use that definition for the tangent space throughout this text, independently of the differentiability class.

\begin{df}(\cite{luke2013vector}, section 1.3)\label{def:smooth_vector_bundle}
	The triple $ (E, M, \pi: E \rightarrow {M}) $ is a \textbf{smooth vector bundle} if $ E,M $ are smooth manifolds, $ \pi $ is a smooth surjection; the fibers $ \pi^{-1}(p) $ for $ p\in M $  have the structure of finite dimensional vector spaces; and for every point $ p\in M $, there is an open neighborhood $ U $ of $ p $, a natural number $ k $ and a diffeomorphism $ \phi: U\times \mathbb{R}^k \rightarrow  \pi^{-1}(U),$ such that for all $ q\in U $ the following propositions hold:  

	\begin{itemize}
		\item $ (\pi\circ \phi)(q,v)=q $ for all $ v\in \mathbb{R}^k $, and  
		\item the map $ v \mapsto \phi(p,v) $ is a linear isomorphism between the vector spaces $\pi^{-1}(p) $ and $ \mathbb{R}^k. $     
	\end{itemize}
	The first condition means in algebraic terms that the following diagram is commutative,	
	\begin{center}
		\begin{tikzcd}
		U\times \mathbb{R}^k \arrow[d, "p"'] \arrow[rr, "\phi"] &  & \pi^{-1}(U) \arrow[d, "\pi"] \\
		U \arrow[rr, "Id"']                                     &  & U                           
		\end{tikzcd}
	\end{center}
	where $ p:U\times \mathbb{R}^k \rightarrow U, \ p(q,v)=q$ is the projection onto the first factor.
\end{df}
We take the disjoint union of the tangent spaces at every point of the manifold in order to define the tangent bundle,
$$ TM = \bigsqcup_{p\in M} T_pM, $$ 
equipped with manifold structure given by the one of $ M. $ It is called a bundle because the triple $ (TM, M,\pi:TM \rightarrow {M}) $ satisfies the definition of smooth vector bundle, where $ \pi:TM \rightarrow {M} $  is the projection function, that assigns each tangent vector to the point where it is based. Each fiber of this bundle is a tangent space based on a point, and the tangent bundle is in particular a vector bundle because each fiber has structure of finite dimensional real vector space.



There is another important class of smooth vector bundles, namely, the tensor bundles, that are defined following \cite{wendl2008lecture}, examples 2.4 and 2.5.
\begin{df} 
	If $ (E,M,\pi:E \rightarrow {M}) $ is a smooth vector bundle, the dual bundle of this bundle is another smooth vector bundle $ (E^*,M,\pi^*:E^*\rightarrow {M}) $, known as \textbf{ dual bundle}, whose fibers are the dual spaces to the fibers of $ E, $ that is,
	$$ (\pi^{*})^{-1}(p)=(\pi^{-1}(p))^*, \text{ for all }p\in M,$$ 
	and $$ E^* =\bigsqcup_{p\in M} (\pi^*)^{-1}(p). $$ 
\end{df}
\begin{df}
	If $ (E,M,\pi:E \rightarrow {M}) $ is a smooth vector bundle, the \textbf{$ (k,l)- $tensor bundle} associated to this bundle, with $ k,l\geq0 $, is defined as the smooth vector bundle $ (T^k_l E, M, \pi_{kl}: T^k_l E \rightarrow {M}) $, whose fibers are the vector spaces of $ (k,l) -$tensors of the fibers of $ E, $ that is,     
	$$ \pi_{kl}^{-1}(p) = T^k_l \pi^{-1}(p)=\left( \bigotimes_{j=1}^l (\pi^{*})^{-1}(p)\right)\otimes \left( \bigotimes_{j=1}^k \pi^{-1}(p) \right), \text{ for all }p\in M, $$ 
	and
	$$ T^k_l E = \bigsqcup_{p\in M} \pi_{kl}^{-1}(p). $$ 
\end{df}
\begin{rem}
	If $ k=1,l=0, $ $T^0_1E=E,$ and if $ k=0,l=1, $ $ T^1_0=E^*. $ We associate $ T^0_0=M\times \mathbb{R} $ to the \textbf{trivial line bundle} if both $ k=l=0. $ 
\end{rem}

From the two last definitions it is not entirely clear that they satisfy the conditions to be a smooth vector bundle. The formal proof that both definitions are consistent definitions of smooth vector bundles can be found in \cite{luke2013vector}, section 1.3.
\begin{df}
	A \textbf{(smooth) section} of a (smooth) vector bundle $ (E,M,\pi:E \rightarrow {M}) $ is a (smooth) application $ s: M \rightarrow {E} $ such that $ \pi\circ s= \mathbb{1}_{M}. $    
\end{df}
For an arbitrary smooth vector bundle bundle $ (E,B,\pi:E \rightarrow {B}), $ a subbundle of this bundle $ (E',B',\pi':E' \rightarrow {B'}) $  is a smooth vector bundle bundle that satisfies $ E'\subset E $, $ B'\subset B $ and $ \pi|_{E'}=\pi'. $
\begin{df}
	
	A \textbf{distribution} $ \mathcal{H} $ over a manifold $ M $  is a vector subbundle of the tangent bundle $ TM $ . If this vector subbundle is in addition smooth, the distribution is said to be smooth, and the rank $ k $  of this distribution is defined as the dimension of its fibers.

	The fiber of $ \mathcal{H} $ at a point $ p\in M $ is denoted as $ H_p. $ 
\end{df}

The concept of (smooth) distribution can be defined in an alternative but equivalent (see \cite{lee2003introduction}, Ch. 19, lemma 19.5) fashion using 1-forms, with the help of the following proposition.

\begin{prop}[Smooth Distribution (using 1-forms)]
	Suppose that $ M $ is a smooth $ m- $dimensional manifold, and $ \mathcal{H} \subset TM$ is a distribution of rank $k$. Then $ \mathcal{H} $ is smooth if and only if for every point $ p\in M $ there is a neighborhood $ U $ of that point where exist $n-k$ smooth 1-forms $ \omega^1,\dots,\omega^{n-k}, $ such that for all $ q\in U $,

	$$ \mathcal{H}_q = \operatorname{Ker} \omega^1|_q\cap \cdots \cap\operatorname{Ker} \omega^{n-k}|_q.  $$ 
\end{prop}

Some examples of distributions over manifolds are given below.
\begin{ex}[Tangent Bundle]
	For any manifold $ M $, the tangent bundle $ TM $ is by definition a distribution over it. 
\end{ex}
\begin{ex}[Heisenberg Group]\label{ex:heis_group}
	Take $ \mathbb{R} ^3 $ as the manifold, and define over it the distribution $ \mathcal{H}\subset T \mathbb{R} ^3 $, whose fiber at an arbitrary $ (x,y,z)\in \mathbb{R}^3  $ is   
	$$ \mathcal{H}_{(x,y,z)} = \operatorname{Ker} \omega|_{(x,y,z)},$$
	where $ \omega = dz-(x dy-y dx)/2\in\Omega^1( \mathbb{R}^3).$ 
\end{ex}
\begin{rem}
	The last example is of particular interest because of its connection with the isoperimetrical problem. For more information see \cite{montgomery2002tour}, Ch. 1.
\end{rem}
\begin{ex}[Vector field over a manifold]\label{ex:vect_field}
Any smooth vector field $ X: M \rightarrow {TM} $ (which does not vanish out at any point) on a manifold determines a distribution $ \mathcal{H}$ over the manifold $ M $ whose fiber at an arbitrary $ p\in M $ is the span of $ X_p. $

As a particular case of this example, one can consider a system of $ n $ linear differential equations on $ \mathbb{R}^n $ without equilibrium points, that determines a vector field over $ \mathbb{R}^n.$
\end{ex}


Given a distribution $ \mathcal{H} $  over a manifold $M$,  a curve or vector field is said to be \textbf{horizontal} if it is tangent to $ \mathcal{H} $. This means that, in the case of a curve, its tangent vector at every point is contained in the fibers of $ \mathcal{H} $; and in the case of a vector field, its image at every point where it is defined is contained in the fibers of $ \mathcal{H} .$   

For example, every curve over a manifold with distribution given by its tangent bundle is horizontal. In the example \ref{ex:heis_group}, the liftings of the solutions of the isoperimetrical problem are horizontal. In example \ref{ex:vect_field}, and in particular in the case of systems of linear differential equations, the solution curves of the system of differential equations are examples of horizontal curves for that distribution.

\subsection{Frobenius' Theorem}%
\label{sub:frobenius_theorem}


Now the natural question that arises is if, given two points on a manifold with a given horizontal distribution, is there a smooth horizontal curve that joins them? To address this question, the present text will use the following alternative definition of smooth distributions (\cite{lee2003introduction}, Ch. 19, page 491): 

\begin{df}
	It is said that $ \mathcal{H}\subset TM $ is a \textbf{smooth distribution over $M  $} if and only if  for each point $ p\in M $, there is an open neighborhood $ U $ of it on which there are smooth vector fields $ X_1,\dots,X_n: U \rightarrow {TM} $ that at each point of $ U $ form a base for the fiber of that point respect to the distribution.
\end{df}

Given a smooth distribution $ \mathcal{H} \subset TM$, we say that a nonempty immersed submanifold $ N\subseteq M $  is an \textbf{integral manifold} of $\mathcal{H}$ if $ T_p N = \mathcal{H}_p $ for all $ p\in N $ , \textit{i.e.}, if the tangent space of all points of the submanifold is the fiber of the horizontal distribution. As an example, in the distribution given in example \ref{ex:vect_field}, the image of any integral curve of the vector field that determines the distribution over the manifold is an integral manifold for that distribution. A particular example (taken from \cite{lee2003introduction}, example 19.1) of a distribution and its family of integral manifolds is given below.

\begin{ex}[Orthogonal complement of a given vector field]
Let $ \mathcal{G} $ be the distribution over $ \mathbb{R}^n $ determined by the radial vector field $ x^i \partial / \partial x^i $, and let $ \mathcal{G}^\perp $ be its perpendicular bundle, \textit{i.e.,} the distribution whose fibers are the orthogonal complement of the fibers of $ \mathcal{G}. $ $ \mathcal{G}^\perp $ is a distribution over $ \mathbb{R}^n  $, and the sphere centered at $0$, of radius $ |x| $, for all $ x\neq0 $ is an integral submanifold of $ \mathcal{G}^\perp. $        
\end{ex}

There are distributions over a manifold that do not have integral manifolds, as is shown in the following example (taken from \cite{lee2003introduction}, Ch. 19, example 19.1).

\begin{ex}[Distribution without integral manifolds] \label{ex:no_integral_manifolds}
	Consider the distribution $ \mathcal{H} $ over $ \mathbb{R}^3 $ spanned by the following vector fields: 
	$$ X = \frac{\partial}{\partial x} + y \frac{\partial}{\partial z}, \quad Y = \frac{\partial}{\partial y}.  $$ 
	This distribution does not have integral manifolds. To see this, suppose that $ N $ is an integral manifold that contains an arbitrary point $ \textbf{x} \in \mathbb{R}^3.  $ Because $ X $ and $ Y $ are tangent to $ N $, any integral curve of $ X $ or $ Y $ that starts in $ N $ stays in $ N $, at least for a short time (\textit{i.e.}, the integral curve $ \gamma $ must be defined over a sufficiently small interval such that its image is fully contained in $ N $).   

	Therefore, as the integral curve of $ X $ is a straight line contained in the plane that is parallel to the $ xz- $plane, there is a segment of this line that is contained in $ N $, and for every point in this segment, the integral curves of $ Y $ that passes through them are straight lines parallel to the $ y- $axis, so there must be an open neighborhood of $ \textbf{x}  $ that contains a plane generated by the segments of the integral curves of $ X $ and $ Y $ that passes through $ \textbf{x}$ (see figure \ref{fig:no_integral_manifolds}). However, the tangent plane at any point $ p $  of this plane  off of the segment induced by the integral curve of $ X $ is not equal to $ \mathcal{H}_p, $ since $ X $ depends of $ y $.   
\end{ex}

\begin{figure}
    \centering
    \incfig{no_integral_manifolds}
    \caption{Illustration of the planes generated at each point by the integral curves of the smooth vector fields that determine the distribution given in example \ref{ex:no_integral_manifolds}.}
    \label{fig:no_integral_manifolds}
\end{figure}

A concept that at first seems far away, but is useful for analyzing integrability of manifolds (defined below) is the idea of involutivity. A smooth distribution $ \mathcal{H} $ is said to be \textbf{involutive} if given any pair of smooth vector fields $ X,Y $ defined on a open subset of $ M $  that satisfy $X_p,Y_p\in \mathcal{H}_p $, their Lie bracket also satisfies the same condition, \textit{i.e.}, it is tangent to the distribution in the given open subset. 

The set of all smooth vector fields  globally defined, tangent to the distribution $ \mathcal{H} $ is denoted as $ \Gamma( \mathcal{H}) $. It is clear from the definition of involutivity that if $ \mathcal{H} $ is involutive, $ \Gamma (\mathcal{H})\subset \mathfrak{X}(M) $ is a Lie subalgebra. The converse is also true, and can be proven extending any pair of smooth vector fields locally defined, tangent to $ \mathcal{H} ,$ to a pair of vector fields in $ \Gamma( \mathcal{H}), $ using an adequate bump function. 

A smooth distribution $ \mathcal{H} $ over a manifold $ M $ is called \textbf{integrable} if each point of $ M $ is contained in an integral manifold of $ \mathcal{H}. $  It is clear then that \textit{every integrable distribution is involutive}, because every pair of smooth vectors tangent to $ \mathcal{H}, $ defined over an open set $ U\subset M $, satisfy that their Lie bracket is also tangent to $ \mathcal{H} $ in that open set, since there exists a integral manifold $ N $  of $ \mathcal{H} $ for every point of $ U $ such that the pair of smooth vectors are tangent to $ N $, and in consequence, their Lie bracket is also tangent to $ N. $  

In fact, the involutivity condition does not need to be checked for all smooth vector fields on $ \Gamma( \mathcal{H}), $ but it suffices to check if the Lie brackets of pairs of smooth vector fields of the local frame that determines the distribution are tangent to it, since every smooth local frame tangent to $ \mathcal{H} $ is a linear combination of the smooth vector fields of the local frame. 

Given a smooth distribution $ \mathcal{H}\subset TM $  of rank $ k, $ it is said that a smooth coordinate chart $ (U,\phi) $ of $ M $ is \textbf{flat for $ \mathcal{H} $ } if $ \phi(U) $ is a cube in $ \mathbb{R}^m  $ (being $ m $ the dimension of $ M $ ), and at points of $ U $, $ \mathcal{H} $ is spanned by the first $ k $ coordinate vector fields $ \partial/\partial x^1,\dots,\partial/\partial x^k $ (see figure \ref{fig:fittogether}). The geometrical meaning of this property for a distribution is that, locally (in that chart), the manifold is homeomorphic to a cube in $ \mathbb{R}^m,  $ and the vector subspaces induced by the distribution at each point fit together as affine spaces of dimension given by the rank of the distribution in $ \mathbb{R}^m $. Also, each slice of the form $ x^{k+1}=c^{k+1},\dots, x^m=c^m,$ for constants $ c^{k+1}, \dots, c^m $ in the image of $ U $ of such a chart is an integral manifold of the distribution generated by $ \partial/\partial x^1,\dots,\partial/\partial x^k $, and the preimage of this integral manifold is an integral manifold of $ \mathcal{H}, $ contained in $ U. $  

\begin{figure}
    \centering
    \incfig{fittogether}
    \caption{Flat chart for a distribution.}
    \label{fig:fittogether}
\end{figure}

The case when every point in $ M $ has a coordinate chart centered in it, flat for $ \mathcal{H} $ is discussed in the following definition and geometrical interpretation.

\begin{df}
	A smooth distribution $ \mathcal{H}\subset TM $  is said to be \textbf{completely integrable} if there exists a flat chart for $ \mathcal{H} $ in a neighborhood of each point of $ M. $ 
\end{df}

When a distribution is completely integrable, there is a coordinate chart centered at every point $ p\in M $ , such that the manifolds locally looks like a cube in $ \mathbb{R}^m  $, and the distribution becomes the tangent subspace of dimension $ k $ generated by the first $ k $ vector fields that form the base of the tangent space at each point, as can be seen in figure \ref{fig:fittogether}. 

Therefore, if a distribution is completely integrable, is then integrable, since there exists an integral manifold for each point (that in particular is a \textbf{maximal integral manifold}, as the dimension of this manifold coincides with the rank of the distribution), given by the integral manifold that contains this point in the image of the coordinate chart flat for $ \mathcal{H}. $ In this way, \textit{ if a distribution is completely integrable, it is integrable, and therefore involutive.} In fact, these implications are actually equivalences, thanks to Frobenius's theorem.

\begin{thm}[Frobenius]
	Every involutive distribution is completely integrable.	
\end{thm}

\begin{proof}
	(\cite{lee2003introduction}, Ch. 19, theorem 19.12) First, it will be shown that any involutive distribution is spanned by independent smooth commuting vector fields, and as a consequence of this fact, the distribution is completely integrable.

	Let $ \mathcal{H} $ be an involutive distribution of rank $ k $ on an $ m- $dimensional manifold $ M $, and let $ p\in M $ . Let $ (U,\varphi) $ be a smooth coordinate chart centered in $ p. $ Then, $ \varphi(U)\subset \mathbb{R}^m $, and let $ X_1,\dots,X_k $ be a smooth local frame for $ \mathcal{H} $ in $ U. $

	Now, $ \left\{ d\varphi \left( X_i \right) \right\}_{i=1}^k $ is a set of linearly independent vector fields over $ \varphi(U). $ One can reordinate the coordinates of $ \mathbb{R}^m $ to make $ \mathcal{H}'_{\varphi(p)} $ (understood as the fiber of the distribution whose local frame is given by $ \left\{ d\varphi \left( X_i \right) \right\}_{i=1}^k $) complementary to the subspace generated by $ \left( \partial/\partial x^{k+1}|_{\varphi(p)},\dots,\partial/\partial x^{m}|_{\varphi(p)} \right). $   

	Let $ \pi: \mathbb{R}^m \rightarrow  \mathbb{R}^k$ the projection onto the first $ k $ coordinates, that is, $ \pi(x^1,\dots,x^m)=(x^1,\dots,x^k). $ This map induces a smooth (smooth because it is the composition $\mathcal{H}' \hookrightarrow T\varphi(U) \xrightarrow[]{d\pi} T\pi(\varphi(U))$ )  bundle homomorphism $ d\pi: T \mathbb{R}^m \rightarrow \mathbb{R}^k	 $ that acts as follows:
	$$ d\pi \left( \sum_{i=1}^m v_i \frac{\partial}{\partial x^i} \Big|_{\varphi(q)}   \right) = \sum_{i=1}^k v_i \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))}, \text{ for }q\in U.$$ 

	By the choice of coordinates, $ \mathcal{H}'_{\varphi(p)}\subset T_{\varphi(p)} \mathbb{R}^m $ is complementary to the kernel of $ d\pi_{\varphi(p)}, $ so the restriction $ d\pi|_{\mathcal{H}'_{\varphi(p)}} $ is bijective. By continuity, the same is true for $ d\pi|_{\mathcal{H}'_{\varphi(q)}} $, with $ q\in U $, and therefore, the matrix entries of $ \left(d\pi|_{\mathcal{H}'_{\varphi(q)}} \right)^{-1}: T_{\pi(\varphi(q))} \mathbb{R}^k \rightarrow \mathcal{H}'_{\varphi(q)}$ are smooth, which makes the map smooth. With this in mind, the set of vector fields $ V_1,\dots,V_k $, defined by
	$$ V_i|_{\varphi(q)}= \left(  d\pi|_{\mathcal{H}'_{\varphi(q)}}  \right)^{-1} \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))} $$ 
	are a local frame of $ \mathcal{H'}. $ It is in fact a smooth commuting local frame, as will be seen below. 

	First, notice that $ V_i $ and $ \partial/\partial x^i $ are $ \pi- $related, for $ i=1,\dots,k, $ because
	$$ \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))} = d\pi |_{\mathcal{H}'_{\varphi(q)}} \left( V_i |_{\varphi(q)} \right) = d\pi_{\varphi(q)}(V_i|_{\varphi(q)}), $$ 
	so by the naturality of Lie brackets,
	$$ d\pi_{\varphi(q)} \left( \left[ V_i,V_j \right]_{\varphi(q)} \right)= \left[ \frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j}   \right]_{\pi(\varphi(q))}=0, $$ 
	but as $ d\pi|_{\mathcal{H}'_{\varphi(q)}} $ is injective and $ [V_i,V_j]_{\varphi(q)}\in \mathcal{H}'_{\varphi(q)} $, since $ \mathcal{H} $ is involutive, $ [V_i,V_j]_{\varphi(q)}=0 $ for all $ q\in U, $ so $ \left\{ V_i \right\}_{i=1}^k $ form a smooth commuting frame for $ \mathcal{H}', $ and $ \left\{ d\varphi^{-1}(V_i) \right\}_{i=1}^k $ are a smooth commuting local frame for $ \mathcal{H}. $   

	Finally, to show that the existence of the commuting frame $ \left\{V_i \right\}_{i=1}^k $ for $ \mathcal{H}' $ is a sufficient condition for $ \mathcal{H} $ to be completely integrable, let $ \theta_i $ be the flow of $ V_i, $ $i=1,\dots,k.$ There is a neighborhood $ W $ of $ \varphi(p)  $, contained in $ \varphi(U) $ such that the composition  
	$ (\theta_1)_{t_1}\circ(\theta_2)_{t_2}\circ\cdots\circ(\theta_k)_{t_k} $
	is well defined, for sufficiently small $ t_1,\dots,t_k $ ($|t_i|<\epsilon  $, for an adequate $ \epsilon>0$). Define $ \Omega \subset \mathbb{R}^{m-k} $ as    
	$$ \Omega = \left\{ (s^{k+1},\dots,s^m)\in \mathbb{R}^{m-k}\ : \ (0,\dots,0,s^{k+1},\dots,s^m)\in W \right\}, $$ 
	and $\Phi:(-\epsilon,\epsilon)\times \Omega \rightarrow \varphi(U)$ as
	$$ \Phi(s^1,\dots,s^k,s^{k+1},\dots,s^m)=(\theta_1)_{s^1}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m). $$ 
	
	Notice that, by construction, $ \Phi( \left\{ 0 \right\}^k\times\Omega) = ({0}^k\times \mathbb{R}^{m-k})\cap W. $ Moreover, $ \partial/\partial s^i $ and $ V_i $ are $ \Phi- $related for $ i=1,\dots,k, $ because, as the flows commute, for a given $ s^0=(s^1,\dots,s^m)\in (-\epsilon,\epsilon)^k\times \Omega, $ 

	\begin{dmath*}
		d\Phi_{s^0} \left( \frac{\partial}{\partial s^i} \Big|_{s^0}  \right) f = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( \Phi \left( s^1,\dots,s^m \right) \right) = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( (\theta_1)_{s^1}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m) \right) = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( (\theta_i)_{s^i}\circ\cdots\circ(\theta_{i-1})_{s^{i-1}}\circ(\theta_{i+1})_{s^{i+1}}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m) \right),
	\end{dmath*}
	and for any $ q\in\varphi(U) $, $ t\mapsto (\theta_i)_t(q) $ is an integral curve of $ V_i, $ so the above expression is equal to $ V_i|_{\Phi(s^0)} f $, which shows that $ \partial/\partial s^i |_{s^0} $ and $ V_i $ are $ \Phi- $related.   

	By the previous computations, $$ d\Phi_0\left( \frac{\partial}{\partial s^i}\Big|_{0} \right) = V_i |_{\varphi(p)}, \ i=1,\dots,k, $$ and on the other hand, since $ \Phi(0,\dots,0,s^{k+1},\dots,s^m)=(0,\dots,0,s^{k+1},\dots,s^m), $ it follows that
	$$ d\Phi_0 \left( \frac{\partial}{\partial s^i}\Big|_{0}  \right) = \frac{\partial}{\partial x^i}\Big|_{\varphi(p)},\ i=k+1,\dots,m.  $$ 
	
	Therefore, $ d\Phi_0 $ takes the basis $ \left( \partial/\partial s^1 |_0,\dots,\partial/\partial s^m |_0 \right) $ of $ T_0 \mathbb{R}^m $ to the basis $ ( V_1|_{\varphi(p)},  \dots,$ $ V_k|_{\varphi(p)}, \partial/\partial x^{k+1}|_{\varphi(p)}, \dots, \partial/\partial x^{m}|_{\varphi(p)}) $ of $ T_{\varphi(p)} \varphi(U). $ By the inverse function theorem, $ \Phi $ is a local diffeomorphism (in a neighborhood of $ 0 $), and $ \phi=\Phi^{-1} $ is a smooth coordinate chart that takes $ V_i $ to $ \partial/\partial s^i $, for $ i=1,\dots,k, $ and takes $ \partial / \partial x^{i} $ to $ \partial/\partial s^i $, for $ i=k+1,\dots,m. $ Thus, the smooth coordinate chart flat for $ \mathcal{H} $ in a neighborhood of $ p\in M $ is $ \phi\circ\varphi, $ and since this is independent of $ p $, for every point there is a smooth coordinate chart flat for $ \mathcal{H}, $ what makes $ \mathcal{H} $ a completely integrable distribution.

\end{proof}

The next proposition is one of the main consequences of Frobenius theorem, and it is fundamental to study foliations, topic that is going to be discussed below.
\begin{prop}[Local structure of integral manifolds]\label{prop:local_structure}
	Let $ \mathcal{H} $ be an involutive distribution of rank $ k $ on a smooth manifold $ M $, and let $ (U,\varphi) $ be a flat chart for $ \mathcal{H} $. If $ N $ is any connected integral manifold of $ \mathcal{H}, $ then $ \varphi(U\cap N) $ is the union of countably many disjoint open subsets of parallel $ k- $dimensional slices of $ \varphi(U) $, whose preimages are open in $ N $ and embedded in $ M $.
\end{prop}

\begin{figure}
    \centering
    \incfig{local_structure}
    \caption{Local structure of an integral manifold.}
    \label{fig:local_structure}
\end{figure}

\begin{proof}(\cite{lee2003introduction}, Ch. 19, proposition 19.16)
	Let $ N $ be an integral manifold of $ \mathcal{H}. $ Since the inclusion map $ \iota: N \hookrightarrow M $ is continuous, $ \varphi( \iota^{-1}(U))=\varphi(N\cap U) $  is open in $ \varphi(N) $. Then, $ \varphi(U\cap N) $ is the union of open slices (\textit{i.e.}, open subsets of a slice of $ \varphi(U)$) with $ x_i=\text{constant} $, for $ i=k+1,\cdots,m.$ Moreover, this union is at most countable, because $ N $ is second countable, and since $ \varphi(N\cap U) $ is a union of open slices, $ \pi(\varphi(U\cap N)) $ consists of a countable number of points (recall that $ \pi: \varphi(U) \rightarrow \mathbb{R}^{m-k} $ is the projection onto the last $ m-k $ coordinates) in $ \mathbb{R}^{m-k}, $ which implies that the union of open slices is at most countable.  

	Finally, if $ V $ is an open slice in the slice $ S, $ the inclusion map $ \varphi^{-1}(V) \hookrightarrow M $ is a smooth embedding, because it is the composition of smooth embeddings $ \varphi^{-1}(V)\hookrightarrow \varphi^{-1}(S) \hookrightarrow M.$ 
\end{proof}

The last proposition implies that one can put all the maximal integral manifolds of an involutive distribution of rank $ k $  together, to obtain a partition on $ M $ into $ k- $dimensional submanifolds, that satisfy the following definition.
\begin{df}
	A smooth chart $ (U,\varphi) $ for $ M $ is called \textbf{flat for a collection $ \mathcal{F} $ of $ k- $dimensional submanifolds of $ M $} if $ \varphi(U) $ is a cube in $ \mathbb{R}^m, $ and the image of each submanifold via $ \varphi $ intersects $ \varphi(U) $ in either the empty set or in a countable union of $ k- $dimensional slices of the form $ x^{k+1}=c^{k+1},\dots,x^m=c^m. $   
\end{df}

\begin{df}
	A \textbf{foliation of dimension $ k $ on a smooth manifold $ M $} is a collection $ \mathcal{F} $ of disjoint, connected, nonempty, immersed $ k- $dimensional submanifolds of $ M $ (called the \textbf{leaves} of the foliation), whose union is $ M $, and such that in a neighborhood of each point $ p\in M $ there is a flat chart for $ \mathcal{F}. $  
\end{df}

The following are examples of foliations over a manifold, mainly taken from \cite{lee2003introduction}, Ch. 19, example 19.18.

\begin{ex}[Collection of affine subspaces]
	The collection of all $ k- $dimensional affine subspaces of $ \mathbb{R}^m $ parallel to $ \mathbb{R}^k\times \left\{ 0 \right\} $ is a $ k- $dimensional foliation for $ \mathbb{R}^m. $ 
\end{ex}

\begin{ex}[Spheres centered at the origin]
	The collection of all spheres centered at $ 0 $ is an $ (m-1)- $dimensional foliation of $ \mathbb{R}^m\setminus \left\{ 0 \right\} $. 
\end{ex}

\begin{ex}[Cartesian product of manifolds]\label{ex:product_foliation}
	If $ M $ and $ N $ are connected smooth manifolds, the collection of subsets of the form $ M\times \left\{ q \right\}, $ with $ q\in N $, is a foliation of $ M\times N, $ each of whose leaves is diffeomorphic to $ M. $  	
\end{ex}

From the definition of foliations, it is clear that \textit{if $ \mathcal{F} $ is a foliation on a smooth manifold $ M, $ the collection of tangent spaces to the leaves of $ \mathcal{F} $ forms an involutive distribution on $ M. $} In a reciprocal way, the collection of maximal integral manifolds of an involutive distribution forms a foliation over the manifold, as it is stated in the global Frobenius theorem.

\begin{thm}[Global Frobenius theorem]
	Let $ \mathcal{H} $ be an involutive distribution on a smooth manifold $ M. $ The collection of all maximal connected integral manifolds of $ \mathcal{H} $ forms a foliation of $ M. $ 
\end{thm}

Following the procedure of \cite{lee2003introduction}, Ch.19, the next lemma (\cite{lee2003introduction}, Ch. 19, lemma 19.22) is going to be used in the proof of this theorem.

\begin{lm}
	Suppose $ \mathcal{H}\subset TM $ is an involutive distribution, and let $ \left\{ N_\alpha \right\}_{\alpha\in A} $ be any collection of connected integral manifolds of $ \mathcal{H} $ with a point in common. Then, $ N=\bigcup_{\alpha} N_\alpha $ has a unique smooth manifold structure making it into a connected integral manifold of $ \mathcal{H}. $  
\end{lm}

\begin{proof}[Proof of the global Frobenius theorem]
	(\cite{lee2003introduction}, Ch. 19, theorem 19.21) For each $ p\in M $, let $ L_p $ be the union of all connected integral manifolds of $ \mathcal{H} $ containing $ p. $ By the preceding lemma, $ L_p $ is a connected integral manifold of $ \mathcal{H} $ containing $ p $, and it is clearly maximal. By maximality, if $ L_p $ and $ L_{p'} $ intersect, $ L_p=L_{p'} $, because $ L_p\cup L_{p'} $ is an integral manifold containing both $ p $ and $ p' $. Thus, the maximal connected integral manifolds are either disjoint or identical.    

	If $ (U,\varphi) $ is any flat chart for $ \mathcal{H}, $ then $ \varphi(L_p\cap U) $ is a countable union of open subsets of slices (by proposition \ref{prop:local_structure}). For any such slice $ S, $ if $ \varphi(U\cap L_p)\cap S $ is neither empty nor all of $ S, $ then $ L_p\cup \varphi^{-1}(S )$ is a connected integral manifold properly containing $ L_p, $ which contradicts the maximality of $ L_p. $ Therefore, $ \varphi(L_p\cap U) $ is precisely a countable union of slices, so the collection $ \left\{ L_p\ : \ p\in M \right\} $ is the desired foliation.
\end{proof}

With the global Frobenius theorem, one can address the question at the start of this subsection: in general, for an given distribution there is not a smooth horizontal curve that connects an arbitrary pair of points, because the points can be in different leaves of the foliation given by the distribution.

\begin{ex}[Foliations on a torus]
	The torus $ T= \mathbb{S}^1\times \mathbb{S}^1 $ can be endowed with the distribution induced by the cartesian product of manifolds (see example \ref{ex:product_foliation}). In this case, the foliation is conformed by copies of $ \mathbb{S}^1. $ The horizontal curves are segments of this copies, and if two points lay in different copies, there is not a horizontal curve that connects them.
\end{ex}

\section{Subriemannian Geometry}%
\label{sec:subriemannian_geometry}

\subsection{Subriemannian Structure and Geodesics}%
\label{sub:subriemannian_structure_and_geodesics}


 If a distribution is doted with a fiber inner-product, the pair of a manifold and a distribution over it defines a subriemannian structure, as is stated in the following definition.
\begin{df}
	A \textbf{subriemannian structure over a manifold} $ M $ is a pair $ (\mathcal{H}, <\cdot,\cdot>)$, where $ \mathcal{H}\subset TM $ is a distribution and $ <\cdot,\cdot> $ is a section of the bundle $ T^0_2 \mathcal{H} \xrightarrow[]{\pi} M, $ which restricts to a positive definite symmetric bilinear form in each fiber (see \cite{hatcher2003vector}, Ch. 1, page 12).

	$ \mathcal{H} $ is called \textbf{horizontal distribution}, and $ <\cdot,\cdot> $ is called \textbf{metric tensor}.  
\end{df}

Some examples of subriemannian structures are given below.
\begin{ex}[Riemannian Structure]\label{ex:riem_geo2}
	Every riemannian structure is in particular a subriemannian structure, where the distribution is all the tangent bundle.
\end{ex}

\begin{ex}[Heisenberg Group]\label{ex:heis_group2}
	The distribution of the Heisenberg group is commented in example \ref{ex:heis_group}. The inner product over a fiber $ \mathcal{H}_{(x,y,z)} $, with $ (x,y,z)\in \mathbb{R}^3 $  is given by $<\cdot,\cdot>:  \mathcal{H}_{(x,y,z)}\times\mathcal{H}_{(x,y,z)} \rightarrow { \mathbb{R} }:(v,w)\mapsto v_1w_1+v_2w_2,$ where $ v=(v_1,v_2,v_3) $ and $ w=(w_1,w_2,w_3). $  

\end{ex}
\begin{ex}[Vector Field over a Manifold]\label{ex:vect_field2}
	As seen in example \ref{ex:vect_field}, any smooth vector field $ X: M \rightarrow TM$ that does not cancel out in any point determines a distribution.  The fiber inner-product $ <\cdot,\cdot>: \mathcal{H}_p \times \mathcal{H}_p \rightarrow \mathbb{R} $ for $ p\in M $  is given by $<\lambda_1 X_p,\lambda_2 X_p>=\lambda_1 \lambda_2.$
\end{ex}
In the particular case of the horizontal curves, one can define the \textbf{length of a horizontal smooth curve} $ \gamma $ (denoted by $ \ell(\gamma) $) as in the case of riemannian geometry:
$$ \ell(\gamma) = \int ||\dot{\gamma}|| dt, $$ 
since the tangent vectors of the curve at all points are in the fibers of the horizontal distribution, where there is a inner product defined, and $ ||\dot{\gamma}||= \sqrt[]{<\dot{\gamma}, \dot{\gamma}>}.  $   

With the idea of length of horizontal curves, the \textbf{distance between two points} $ p,q\in M $, denoted by $ d(p,q), $   is defined as the infimum of the lengths of all absolutely continuous horizontal curves that begin in $ p $ and end in $ q $, that is, 

$$ d(p,q) = \operatorname{inf} \left\{ \ell(\gamma) \ |\ \gamma:[0,1] \rightarrow {M} \text{ is absolutely continuous and }\gamma(0)=p, \ \gamma(1)=q \right\}. $$ 

The distance between two points is said to be infinite if there is no curve joining them. Also, in analogy with riemannian geometry, an absolutely continuous horizontal curve that realizes the distance between two points is called a \textbf{geodesic}. 


\subsection{Chow's Theorem}%
\label{sub:chow_s_theorem}

The section \ref{sub:frobenius_theorem} provides a class of (involutive) distributions where it is not true that every two points can be connected through a horizontal curve.  Now, it is worthwhile to ask for a sufficient condition for a distribution to have the connectedness property through horizontal curves. To discuss such a condition, we need to cover some preliminaries. 

\begin{df}
	A distribution $ \mathcal{H}\subset TM $ is called \textbf{bracket generating} if any of its local frames $ X_1,\dots,X_k $ together with all of its iterated Lie brackets $ [X_i,X_j],[X_i,[X_j,X_k]],\dots, $ spans the tangent bundle $ TM. $  
\end{df}

\begin{lm}\label{lm:approx}
	Let $ X_1,X_2 $ be two smooth vector fields over the manifold $ M $, with respective local flows $ \Phi_1,\Phi_2:(-\epsilon,\epsilon)\times U \rightarrow {U}$, and let $ p\in U. $ Then, in any coordinate system the following relation holds:
	$$ \left[ \Phi_1(t), \Phi_2(t) \right](p) := \left( \Phi_1(t)\circ \Phi_2(t) \circ \Phi_1(t)^{-1}\circ \Phi_2(t)^{-1} \right)(p)=p+t^2 \left[ X_1,X_2 \right](p) + O(t^3). $$ 
\end{lm}
\begin{proof}
	By Taylor's theorem, we have $$ \Phi_i(t)(p)=p+tX_i(p)+ \frac{t^2}{2} X_i(X_i(p)) + O(t^3), \text{ for }i=1,2.  $$ 
	In the other hand, as $ \left\{ \Phi_i(t) \right\}_{t\in(-\epsilon,\epsilon)} $ is the family of diffeomorphisms associated with the flow of $ X_i, $ $ \Phi_i(t)^{-1}=\Phi_i(-t). $ Then,   
	\begin{dmath*}
	 (\Phi_1(t)^{-1}\circ \Phi_2(t)^{-1})(p) = p- t \left( X_1(p)+X_2(p) \right)+ t^2 X_1(X_2(p)) + t^2 \left( X_1(X_1(p))+ X_2(X_2(p)) \right) + O(t^3), 
	\end{dmath*}
	and evaluating $ \Phi_1(t)\circ\Phi_2(t) $ in this point gives

	\begin{dmath*}
	\left( \Phi_1(t)\circ \Phi_2(t) \circ \Phi_1(t)^{-1}\circ \Phi_2(t)^{-1} \right)(p) = p+t^2 \left[ X_1,X_2 \right](p)+ t^2 \left( X_1(X_1(p)) + X_2(X_2(p)) \right) - t( X_1(p)+X_2(p)) - t^2 \left( X_1(X_1(p)) + X_2(X_2(p)) \right) +t( X_1(p)+X_2(p)) + O(t^3) = p+t^2 \left[ X_1,X_2 \right](p) + O(t^3), 
	\end{dmath*}
	which is the desired result.	
\end{proof}

Chow's theorem guarantees that any bracket generating over a connected manifold distribution has the connectedness property through horizontal curves, and we going to derive this result in the rest of this section, following closely the procedure of \cite{montgomery2002tour}, Section 2.4. First of all, choose a base point $ p\in M $ and a local orthonormal frame $ X_i $, $ i=1,\dots, k $ for the distribution $ \mathcal{H} $. Let $ \Phi_i $ be their respective flows. These flows can be used to move easily in the horizontal directions (points connected to $ p $ through integral curves of the orthonormal frame), using the formula $ \Phi_i(t)(q)=q+tX_i(q)+O(t^2) $ for sufficiently small $ t. $ 

The assignments $ t\mapsto \Phi_i(t)(q) $ are horizontal curves for the distribution $ \mathcal{H}, $ and are called \textbf{simple horizontal curves.} As the frame is orthonormal, the length of a simple horizontal curve with $ 0\leq t\leq \epsilon  $ is $ \epsilon. $   

Applying $ \Phi_k(t_k)\circ\cdots\circ \Phi_2(t_2)\circ\Phi_1(t_1)$ to $ p $ and letting $ t_1,\dots,t_k $ vary over the cube $ |t_i|\leq\epsilon, $ we move from $ p $ to another point inside the $ k- $dimensional cube of volume $ (2\epsilon)^k. $ Each point of this cube can be reached from $ p $ through the concatenation of $ k $ or fewer flows, and this cube is inside of the subriemannian ball of radius $ k\epsilon $, that is,
\begin{align*}
 \operatorname{Box}_p(\epsilon):= \left\{ \Phi_k(t_k)\circ\cdots\circ \Phi_2(t_2)\circ\Phi_1(t_1)(p) \ | \ |t_i|<\epsilon, \ i=1,\dots,k \right\}\\ \subset \operatorname{B}(k\epsilon, p):= \left\{ q\in M \ | \ d(p,q)<k\epsilon \right\}.  
\end{align*}

We can move in the remaining directions along horizontal paths by successive applications of the commutators of flows, based on the bracket generating property of the distribution in the following way. Let $ \mathcal{H} $ denote also the sheaf of smooth vector fields tangent to $ \mathcal{H}, $ and define
$$ \mathcal{H}^2 := \mathcal{H}\oplus [\mathcal{H},\mathcal{H}],\quad \mathcal{H}^{r+1} := \mathcal{H}^r\oplus [\mathcal{H}, \mathcal{H}^r], $$
where
$$ \left[ \mathcal{H}, \mathcal{H}^j \right]:= \operatorname{span} \left\{ [X,Y] \ | \ X\in \mathcal{H},\ Y \in \mathcal{H}^j \right\}, \text{ for }j=1,2,\dots  $$ 
The movement in the $ \mathcal{H}^2/\mathcal{H} $ directions can be made along horizontal paths by applying the commutators $ \Phi_{ij}(t):= [\Phi_i(t),\Phi_j(t)] $ to $ p. $ As $ \Phi_{ij}(t)(p)=p+t^2[X_i, X_j](p) $ (by lemma \ref{lm:approx}) if $ |t|\leq\epsilon, $ we will move by an amount $ \epsilon^2 $ in the $ \mathcal{H}^2/\mathcal{H} $ directions. This process is realized inductively until exhausting the tangent space. Let $ I=(i_1,i_2,\dots,i_n), $ $ 1\leq i_j\leq k $, and $ X_I:=[X_{i_1}, X_J], $ where $ J=(i_2,\dots,i_n), $  so that $ X_I $ is the iteration of $ n $ Lie brackets. Similarly, define flows $ \Phi_I(t):=[\Phi_{i_1}(t), \Phi_J(t)] $. By successive application of lemma \ref{lm:approx}, we have that   
$$ \Phi_I(t)= \mathbb{1} +t^n X_I+ O(t^{n+1}).$$ 
Due to the bracket generating condition over any local frame of the distribution, we can select a local frame for the entire tangent bundle amongst the $ X_I, $ letting $ n $ and $ i_1,\dots,i_n $ vary accordingly. We choose such a frame and relabel it as $ Y_i, $ $ i=1,\dots,m, $ in a way that it satisfies: $ Y_1=X_1,\dots, Y_k=X_k $ span $ \mathcal{H} $ near $ p, $ $ \left\{ Y_1,\dots,Y_{n_2} \right\} $ span $ \mathcal{H}^2 $ near $ p, $ $ \left\{ Y_1,\dots,Y_{n_2},\dots,Y_{n_3} \right\} $ span $ \mathcal{H}^3 $ near $ p $,  and so on. The tuple $ (k,n_2,n_3,\dots, n_r) $ is called the \textbf{growth vector of the distribution at $ p $}, and the smallest integer $ r $ is called the \textbf{step or degree of nonholonomy of the distribution at $ p. $ }   

\begin{df}[\cite{montgomery2002tour}, page 49.] Let $ \left\{ Y_1,\dots, Y_m \right\} $ be the local frame of the tangent bundle in a neighborhood of $ p\in M $ constructed as stated before using the local frame of a bracket generating distribution. Let $ Y_i=X_I $, $ I=(i_1,\dots,i_{n_I}) $. We denote the length of $ I $ as $ w_i:= \left| I \right| $, and define the assignment $ i\mapsto w_i, $ called the \textbf{weighting associated to the growth vector}. 
	
\end{df}

We relabel the flows $ \Phi_I $ in a similar fashion, so that $ \Phi_i $ is the flow associated to $ Y_i. $ In this case, each point $ \Phi_i(t)(p) $ is the endpoint of the concatenation of $ w_i $ simple horizontal curves, each one of length $ t $. If we impose that $ \left| t \right|\leq \epsilon, $ then $ \Phi_i(t)(p) $ lies in the ball of radius $ w_i\epsilon $ centered at $ p. $ Moreover, in coordinates we have that 
$$ \Phi_i(t)(p)=p+t^{w_i}X_i(p)+ O(t^{w_i+1}), $$ 
so $ \Phi_i(t)(p) $ lies in the Euclidean box of volume $ \epsilon^{w_i} $, in the $ \mathcal{H}^{w_i} $ directions. From this we can deduct that the subriemannian ball $ B(\epsilon,p) $ contains an Euclidean coordinate box whose sides are of order $ \epsilon^{w_i} $ in the $ i $-th direction. This result is known as the ball-box theorem, and it will be stated and proved after the following definitions.

\begin{df}[\cite{montgomery2002tour}, definition 2.4.1] 
	Coordinates $ y_1,\dots,y_m $ are said to be \textbf{linearly adapted to the distribution $\mathcal{H}$ at $ p $ } if $ \mathcal{H}^i(p):= \{ X(p) \ | \ X$ is a section of $\mathcal{H}$ defined on $p$$\}$ is annihilated by the differentials $ dy_{n_i+1},\dots, dy_m $ at $ p, $ where $ n_i=n_i(p) $ are the coordinates of the growth vector at $ p. $  
\end{df}
\begin{df}
	The $ w $- weighted box of size $ \epsilon $ is the point set
	$$ \operatorname{Box}^w(\epsilon) := \left\{ y\in \mathbb{R}^m \ | \ |y_i|\leq \epsilon^{w_i}; \ i=1,\dots,m \right\}.  $$ 
\end{df}

Set $ y_i $ as the coordinates centered at $ p $ such that $ dy_i(p) $ are the dual basis to the $ Y_i(p), $ so that these coordinates are linearly adapted to the distribution by definition.

\begin{thm}[Ball-Box Theorem]
	There exist linearly adapted coordinates $ y_1,\dots,y_m $ and positive constants $ c<C, \ \epsilon_0>0, $ such that for all $ \epsilon<\epsilon_0, $ 
	$$ \operatorname{Box}^w(c\epsilon)\subset B(\epsilon, p)\subset \operatorname{Box}^w(C\epsilon).    $$ 
\end{thm}
\begin{figure}[ht]
    \centering
    \incfig{ballbox}
    \caption{Ball box theorem.}
    \label{fig:ballbox}
\end{figure}
\begin{proof}[Proof of $\operatorname{Box}^w(c\epsilon)\subset B(\epsilon, p)$] (\cite{montgomery2002tour}, theorem 2.4.2). As the approximation $ \Phi_{ij}(t)= \mathbb{1} + t^2 \left[ X_i,X_j \right] + O(t^3)$ has the coefficient $ t^2 $ that is always positive, we can not move in the negative $ [X_i,X_j] $ direction. To circunvent this, we define 
	$$ \Psi_{i j}(t)=\left\{\begin{array}{ll}{\left[\Phi_{i}(t), \Phi_{j}(t)\right]} & t \geq 0 \\ {\left[\Phi_{j}(t), \Phi_{i}(t)\right]} & t<0,\end{array}\right. $$ 
	so that
	$$\Psi_{i j}(t)=\left\{\begin{array}{ll}I+t^{2} X_{i j}+O\left(t^{3}\right) & t \geq 0 \\ I-t^{2} X_{i j}+O\left(t^{3}\right) & t<0.\end{array}\right.$$
This problem occurs wheneve the number $ w_i $ associated to the flow $ \Phi_I $ of $ Y_i $ is even. To solve this in general, we set
$$\Psi_{I}(t)=\left\{\begin{array}{ll}
\Phi_{I}(t) & t \geq 0 \\
{\left[\Phi_{J}(t), \Phi_{i_{1}}(t)\right]} & t<0.
\end{array}\right.$$
If $ w_i $ is odd, we keep $ \Psi_I=\Phi_I, $ and we relabel $ \Psi_I $ as $ \Psi_i $ accordingly. Now, we introduce the functions
$$\sigma_{i}(t)=\left\{\begin{array}{ll}
t^{w_{i}} & w_{i} \text { even, } t \geq 0 \\
-t^{w_{i}} & w_{i} \text { even, } t<0 \\
t^{w_{i}} & w_{i} \text { odd }
\end{array}\right.
$$
to simplify the notation of the approximation
$$ \Psi_I(t)= \mathbb{1}+ \sigma_i(t) Y_i + O(t^{w_i+1}). $$ 
Define the map $ F: \mathbb{R}^m \rightarrow {M} $ as $ F(t_1,\dots,t_m) = \left( \Psi_m(t_m) \circ \cdots \circ \Psi_1(t_1)\right)(p), $ and let $ y_i $ be linearly adapted coordinates for which the $ dy_i $ are dual to the $ Y_i $ of the basis of the tangent space at the base point $ p. $ Then, in coordinates,

$$ F_i(t_1,\dots,t_m) = \sigma_i(t_i) + o(t_i^{w_i}) = \pm t_i^{w_i} + o(t_i^{w_i}), $$ 
where the error $ o(t_i^{w_i}) $ corresponds to the composition of the previous $ \Psi_1(t), \dots,\Psi_{i-1}(t) $ flows evaluated in the big $ O- $errors of the previous sequential arguments. It remains to understand and bound these error terms, and for that we introduce the new variables $ s_i=\sigma_i(t), $ so that $ F_i(t_1,\dots,t_m)= s_i + o(s_i). $  

The map $ \sigma=(\sigma_1,\dots,\sigma_m) $ is a homeomorphism between neighborhoods of $ 0 $ in $ \mathbb{R}^m, $ so let $ S $ be the inverse of $ \sigma $ that is given by $ S=(s_1,\dots,s_m), $ where $ s_i(t_i)=\pm |t_i|^{1/w_i}. $ Then, it follows that
$$ y\circ F\circ S (s_1,\dots,s_m) = (s_1,\dots,s_m) + o(|s|), $$ 
from where we deduce that $ F\circ S$ is differentiable at the origin because of the differentiability of both $ y $ and $ y\circ G\circ S $, and its derivative is the identity in the $ s-y $ coordinates, so it is also $ C^1 $ near $ 0. $ We will proceed applying the inverse function theorem to invert $ F\circ S $ in a neighborhood of $ p. $ 

Write $ F\circ S(s_1,\dots,s_m) $ in coordinates as $ (y_1,\dots,y_m).$ Then, there exists a constant $ \epsilon_0 $ and constants $ c=c(\epsilon_0), \ C=C(\epsilon_0) $ such that $ c|s_i| \leq |y_i(s_1,\dots,s_m)|  \leq C|s_i|$ whenever $ |s_i|\leq \epsilon_0. $ Apply the constraint $ |s_i|\leq \epsilon^{w_i} $ to the $ s_i. $ It is clear that the inverse image of the point set $ |s_i|\leq \epsilon^{w_i} $ under the map $ S $ is the $ \epsilon- $cube box $ \operatorname{Box}(\epsilon)= \left\{ (t_1,\dots,t_m)\ | \ |t_i|\leq \epsilon \right\},  $  so that applying $ F $ to the $ \epsilon- $cube gives
$$ \operatorname{Box}^{w}(c\epsilon) \subset F( \operatorname{Box}(\epsilon) ) \subset \operatorname{Box}^w(C\epsilon).   $$ 
Each curve in $ F( \operatorname{Box} (\epsilon) )$ is the endpoint of a horizontal curve starting at $ p $ whose length is less than $ M\epsilon $, where $ M=M(w) $ counts the number of concatenations involved in $ F. $ Consequently,
$$ F( \operatorname{Box} (\epsilon)) \subset B(M\epsilon, p), $$ 
from where we get that $ \operatorname{Box}^w (c\epsilon)\subset B(\epsilon,p). $ 
\end{proof}
The remaining containment in the Ball-Box theorem won't be proved in this text, as the tools needed (privileged coordinates) are out of its scope. The proof of this containment can be found in \cite{montgomery2002tour}, section 2.7.

With the Ball-Box theorem, Chow's theorem can be derived easily.

\begin{thm}[Chow's Theorem]
	If $ \mathcal{H} $ is a bracket generating distribution on a connected manifold $ M $, then any two points of $ M $ can be connected by a horizontal path.
\end{thm}
\begin{proof} (\cite{montgomery2002tour}, page 52). The containment $ \operatorname{Box}^w(c\epsilon) \subset B(\epsilon,p) \subset \operatorname{Box}^w(C\epsilon)  $ shows that $ B(\epsilon, p) $ is a neighborhood of $ p $, which means that the accesible points from $ p $ through horizontal curves form a neighborhood of $ p. $ Let $ q\in M $ be another arbitrary point on the connected manifold, and take a smooth curve $ \gamma $ connecting $ p $ and $ q. $  

	The image of $ \gamma $ is compact, so we can cover it with finitely many succesive box neighborhoods, where the Ball-Box theorem holds. Denote these neighborhoods as $ U_1,\dots,U_n, $ with each one of these boxes centered on succesive points $ p_i $ along the image of $ \gamma, $ and $ p_1=p, $ $ p_n=q. $ Moreover, these open sets can be chosen in orden to satisfy $ U_i\cap U_{i+1}\neq\emptyset, $ so that there exists $ q_i \in U_i\cap U_{i+1}. $ By the Ball-Box theorem, we have paths connecting $ p_i $ with $ q_i, $ and $ q_i $ with $ p_{i+1}. $ Concatenating these paths yields a piecewise horizontal path connecting $ p $ and $ q. $ 
	
\end{proof}
\bibliographystyle{unsrt}
\nocite{*}
\bibliography{mybibliography}

\end{document}
