%%%% DESCRIPTION %%%%%
% Title of Document: 
% Start Date: 
%%%%%%%%%%%%%%%%%%%%%%%%
%%%FINAL CHECK%%%%%%%%%
%read text
%Bibliography list
%spell check
%chklatex
%unusedlabels
%Overfull

\documentclass[12pt, letterpaper, reqno]{amsart}

\usepackage[utf8]{inputenc}
% indicate the language, for example, spanish or russian
\usepackage[english]{babel}
%\usepackage[spanish]{babel}

%comments
\usepackage{comment}

%drawings
\usepackage{graphicx}

%quotes
\usepackage{dirtytalk}

%commutative diagrams
\usepackage[all]{xypic}

\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{breqn}
\usepackage{tikz-cd}
\usepackage{bbold}
\usepackage{url}
% Paragraph Settings:
%\setlength{\parindent}{1em}
\setlength{\parskip}{1em}
% Skip indentation
\usepackage{parskip}
%%%%%%%%%%%%%%%%%
\newcommand{\incfig}[2][1]{%
    \def\svgwidth{#1\columnwidth}
    \import{./figures/}{#2.pdf_tex}
}
% why do we need this command?
% \includegraphics does not work? 
% - it does work, but i need to use it
% because the images that i create are in
% .svg format (which provides more advantages),
% so they need to be converted to pdf and inserted
% using that command.
%%%%%%%%%%%%%%%%%%

\usepackage{etoolbox}

% Modifications to amsart ToC-related macros...
\makeatletter
\let\old@tocline\@tocline
\let\section@tocline\@tocline
% Insert a dotted ToC-line for \subsection and \subsubsection only
\newcommand{\subsection@dotsep}{4.5}
\newcommand{\subsubsection@dotsep}{4.5}
\patchcmd{\@tocline}
  {\hfil}
  {\nobreak
     \leaders\hbox{$\m@th
        \mkern \subsection@dotsep mu\hbox{.}\mkern \subsection@dotsep mu$}\hfill
     \nobreak}{}{}
\let\subsection@tocline\@tocline
\let\@tocline\old@tocline

\patchcmd{\@tocline}
  {\hfil}
  {\nobreak
     \leaders\hbox{$\m@th
        \mkern \subsubsection@dotsep mu\hbox{.}\mkern \subsubsection@dotsep mu$}\hfill
     \nobreak}{}{}
\let\subsubsection@tocline\@tocline
\let\@tocline\old@tocline

\let\old@l@subsection\l@subsection
\let\old@l@subsubsection\l@subsubsection

\def\@tocwriteb#1#2#3{%
  \begingroup
    \@xp\def\csname #2@tocline\endcsname##1##2##3##4##5##6{%
      \ifnum##1>\c@tocdepth
      \else \sbox\z@{##5\let\indentlabel\@tochangmeasure##6}\fi}%
    \csname l@#2\endcsname{#1{\csname#2name\endcsname}{\@secnumber}{}}%
  \endgroup
  \addcontentsline{toc}{#2}%
    {\protect#1{\csname#2name\endcsname}{\@secnumber}{#3}}}%

% Handle section-specific indentation and number width of ToC-related entries
\newlength{\@tocsectionindent}
\newlength{\@tocsubsectionindent}
\newlength{\@tocsubsubsectionindent}
\newlength{\@tocsectionnumwidth}
\newlength{\@tocsubsectionnumwidth}
\newlength{\@tocsubsubsectionnumwidth}
\newcommand{\settocsectionnumwidth}[1]{\setlength{\@tocsectionnumwidth}{#1}}
\newcommand{\settocsubsectionnumwidth}[1]{\setlength{\@tocsubsectionnumwidth}{#1}}
\newcommand{\settocsubsubsectionnumwidth}[1]{\setlength{\@tocsubsubsectionnumwidth}{#1}}
\newcommand{\settocsectionindent}[1]{\setlength{\@tocsectionindent}{#1}}
\newcommand{\settocsubsectionindent}[1]{\setlength{\@tocsubsectionindent}{#1}}
\newcommand{\settocsubsubsectionindent}[1]{\setlength{\@tocsubsubsectionindent}{#1}}

% Handle section-specific formatting and vertical skip of ToC-related entries
% \@tocline{<level>}{<vspace>}{<indent>}{<numberwidth>}{<extra>}{<text>}{<pagenum>}
\renewcommand{\l@section}{\section@tocline{1}{\@tocsectionvskip}{\@tocsectionindent}{}{\@tocsectionformat}}%
\renewcommand{\l@subsection}{\subsection@tocline{2}{\@tocsubsectionvskip}{\@tocsubsectionindent}{}{\@tocsubsectionformat}}%
\renewcommand{\l@subsubsection}{\subsubsection@tocline{3}{\@tocsubsubsectionvskip}{\@tocsubsubsectionindent}{}{\@tocsubsubsectionformat}}%
\newcommand{\@tocsectionformat}{}
\newcommand{\@tocsubsectionformat}{}
\newcommand{\@tocsubsubsectionformat}{}
\expandafter\def\csname toc@1format\endcsname{\@tocsectionformat}
\expandafter\def\csname toc@2format\endcsname{\@tocsubsectionformat}
\expandafter\def\csname toc@3format\endcsname{\@tocsubsubsectionformat}
\newcommand{\settocsectionformat}[1]{\renewcommand{\@tocsectionformat}{#1}}
\newcommand{\settocsubsectionformat}[1]{\renewcommand{\@tocsubsectionformat}{#1}}
\newcommand{\settocsubsubsectionformat}[1]{\renewcommand{\@tocsubsubsectionformat}{#1}}
\newlength{\@tocsectionvskip}
\newcommand{\settocsectionvskip}[1]{\setlength{\@tocsectionvskip}{#1}}
\newlength{\@tocsubsectionvskip}
\newcommand{\settocsubsectionvskip}[1]{\setlength{\@tocsubsectionvskip}{#1}}
\newlength{\@tocsubsubsectionvskip}
\newcommand{\settocsubsubsectionvskip}[1]{\setlength{\@tocsubsubsectionvskip}{#1}}

% Adjust section-specific ToC-related macros to have a fixed-width numbering framework
\patchcmd{\tocsection}{\indentlabel}{\makebox[\@tocsectionnumwidth][l]}{}{}
\patchcmd{\tocsubsection}{\indentlabel}{\makebox[\@tocsubsectionnumwidth][l]}{}{}
\patchcmd{\tocsubsubsection}{\indentlabel}{\makebox[\@tocsubsubsectionnumwidth][l]}{}{}

% Allow for section-specific page numbering format of ToC-related entries
\newcommand{\@sectypepnumformat}{}
\renewcommand{\contentsline}[1]{%
  \expandafter\let\expandafter\@sectypepnumformat\csname @toc#1pnumformat\endcsname%
  \csname l@#1\endcsname}
\newcommand{\@tocsectionpnumformat}{}
\newcommand{\@tocsubsectionpnumformat}{}
\newcommand{\@tocsubsubsectionpnumformat}{}
\newcommand{\setsectionpnumformat}[1]{\renewcommand{\@tocsectionpnumformat}{#1}}
\newcommand{\setsubsectionpnumformat}[1]{\renewcommand{\@tocsubsectionpnumformat}{#1}}
\newcommand{\setsubsubsectionpnumformat}[1]{\renewcommand{\@tocsubsubsectionpnumformat}{#1}}
\renewcommand{\@tocpagenum}[1]{%
  \hfill {\mdseries\@sectypepnumformat #1}}

% Small correction to Appendix, since it's still a \section which should be handled differently
\let\oldappendix\appendix
\renewcommand{\appendix}{%
  \leavevmode\oldappendix%
  \addtocontents{toc}{%
    \protect\settowidth{\protect\@tocsectionnumwidth}{\protect\@tocsectionformat\sectionname\space}%
    \protect\addtolength{\protect\@tocsectionnumwidth}{2em}}%
}
\makeatother

% #1 (default is as required)

% #2

% #3
\makeatletter
\settocsectionnumwidth{2em}
\settocsubsectionnumwidth{2.5em}
\settocsubsubsectionnumwidth{3em}
\settocsectionindent{1pc}%
\settocsubsectionindent{\dimexpr\@tocsectionindent+\@tocsectionnumwidth}%
\settocsubsubsectionindent{\dimexpr\@tocsubsectionindent+\@tocsubsectionnumwidth}%
\makeatother

% #4 & #5
\settocsectionvskip{10pt}
\settocsubsectionvskip{0pt}
\settocsubsubsectionvskip{0pt}
    
% #6 & #7
% See #3

% #8
\renewcommand{\contentsnamefont}{\bfseries\Large}

% #9
\settocsectionformat{\bfseries}
\settocsubsectionformat{\mdseries}
\settocsubsubsectionformat{\mdseries}
\setsectionpnumformat{\bfseries}
\setsubsectionpnumformat{\mdseries}
\setsubsubsectionpnumformat{\mdseries}

% #10
% Insert the following command inside your text where you want the ToC to have a page break
\newcommand{\tocpagebreak}{\leavevmode\addtocontents{toc}{\protect\clearpage}}

% #11
\let\oldtableofcontents\tableofcontents
\renewcommand{\tableofcontents}{%
  \vspace*{-\linespacing}% Default gap to top of CONTENTS is \linespacing.
  \oldtableofcontents}

\setcounter{tocdepth}{3}

%todonotes
\usepackage[colorinlistoftodos,prependcaption,backgroundcolor=white,size=tiny,textwidth=50pt]{todonotes}
\setlength{\marginparwidth}{2cm}

%%%%%%%% DIMENSIONS %%%%%%%%%%%
\textwidth=16truecm
\textheight=22truecm
\topmargin=0pt
\oddsidemargin=0pt
\evensidemargin=0pt
\baselineskip1.2truecm

%%%%%%%% THEOREMS %%%%%%%%%%%%
\theoremstyle{definition}
%\newtheorem{df}{Definition}
\newtheorem{df}{Definition}
\theoremstyle{plain}
\newtheorem{prop}{Proposition}
%\newtheorem{prop}{Proposición}
\newtheorem{thm}{Theorem}
%\newtheorem{thm}{Teorema}
\newtheorem{lm}{Lemma}
%\newtheorem{lm}{Lema}
\newtheorem{cor}{Corollary}
%\newtheorem{cor}{Corolario}
\theoremstyle{remark}
\newtheorem{ex}{Example}
%\newtheorem{ex}{Ejemplo}
\newtheorem{rem}{Remark}
%\newtheorem{rem}{Observación}

%%%%%%%% COMMENTS (REMOVE THEM IN THE FINAL VERSION!!!) %%%%%%%
\def\comment#1{{\par \tt #1}}

%%%%%%%%% FOR DRAFT%%%%%%%%%%%%%

%\renewcommand{\baselinestretch}{1.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%% PAPER DATA %%%%%%%%%%%%%%%%%%%
\author{}
\address{}


\title{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\pagenumbering{gobble}
\begin{titlepage}
    \begin{center}
        \vspace*{1cm}
            
        \Huge
	\textbf{ELEMENTS OF SUB-RIEMANNIAN GEOMETRY AND ITS APPLICATIONS}
        \vspace{0.5cm}
        \LARGE
            
        \vspace{1.5cm}
            
        \textbf{Julián Jiménez Cárdenas}\\
        \textbf{Directed by: Mikhail Malakhaltsev}
            
        \vfill
            
        A thesis presented for the degree of\\
        Master of Mathematics
            
        \vspace{0.8cm}
            
            
        \Large
        Departamento de Matemáticas\\
        Facultad de Ciencias \\
        Universidad de los Andes\\
        Bogotá, Colombia\\
        April 26, 2022
            
    \end{center}
\end{titlepage}
\maketitle
\newpage
\tableofcontents
\newpage
\begin{abstract}
	The goal of this work is to introduce the main theorems of sub-Riemannian geometry, and for that we will cover first the topic of distributions, stating the Frobenius' theorem and introducing the idea of foliation. Later on, we focus on the sub-Riemannian structures, and prove Chow's theorem, central in the study of connectivity through horizontal geodesics. The last part of this work focuses on $ G $-principal bundles endowed with compatible sub-Riemannian structures. We use this construction with ideas of symplectic geometry to prove the Theorem on normal geodesics of bundle type sub-Riemannian metrics and to study Wong's equations. This review of sub-Riemannian topics is based mostly on \cite{montgomery2002tour}.
\end{abstract}
\newpage
\pagenumbering{arabic}
\section*{Introduction}
\label{sec:0}

Riemannian geometry is an intense field of study due to the fact that it is the generalization of the idea of metric and distance onto general geometric spaces. This characteristic makes Riemannian geometry one of the preferred formalisms to work in physics' topics like general relativity and quantum mechanics. In this field we start with a manifold, endowed with a metric, which is a section of the $ (0,2) $-tensor bundle which is symmetric and non-degenerate at all points of the manifold. The non-degeneracy condition can be weakened, and this variation of the definition of Riemannian metric arises the field of study known as pseudo-Riemannian metric. In this case some important examples raise up, like the Lorentz/Minkowski geometry, the most widely used metric in special relativity. An extensive mathematical development of pseudo-Riemannian geometry can be found on \cite{o1983semi}.

Another variation of Riemannian metric arises when the condition of being a section of the $(0,2)$-tensor bundle is weakened to consider instead a continuous map $F: TM \rightarrow \mathbb{R}$, smooth on the set of nonzero vectors, whose restriction to each tangent space $T_pM$ is a norm \cite[p.~47]{lee2018introduction}. This definition is known as Finsler metric, and an approach to the consequences of this definition can be found on \cite{bao2012introduction}.

The variation of Riemannian geometry that will be covered throughout this text arises when we consider a sub-bundle (called distribution) of the tangent bundle of a given manifold: in this case, the metric will be a section of the $ (0,2) $-tensor bundle of this sub-bundle, with the same properties than in the case of Riemannian geometry (non-degeneracy and symmetry). This formulation receives the name of sub-Riemannian geometry, and it will be the main focus of this text. Before introducing the concept of sub-Riemannian structure, we focus in Section \ref{sec:1} on explaining the idea of distribution, their different definitions and associated results. To do this, we define a distribution in terms of local frames and 1-forms, we explain when a distribution is involutive, integrable and completely integrable, and use the Frobenius's theorem to connect these three concepts, while discussing when the points of a given manifold are connected via horizontal curves, \textit{i.e.}, curves whose tangent vector is always contained in the distribution.

Later on, in Section \ref{sec:sub-Riemannian_geometry} we introduce the concept of sub-Riemannian structure, and define the horizontal distance as the infimum of the length of all horizontal curves that connect two given points in the manifold, in analogy with Riemannian distance. We then introduce the bracket-generating distributions as a special class of distribution such that there is a local frame that locally spans the tangent bundle through successive applications of Lie brackets, and we state and show the Chow's theorem, which states that a sufficient condition for all points to be connected through horizontal curves is that the distribution is bracket-generating. Therefore, the distance between two points in a sub-Riemannian structure is always well-defined when the subjacent distribution is bracket-generating. 

In order to work with principal $ G $-bundles endowed with metric of bundle type, in Section \ref{sub:metrics_on_principal_bundles} we start introducing what is a submersion, and we endow it with a sub-Riemannian structure in the total space (equivalently, a Riemannian structure in the base space). With these tools, we start the topic of metrics on principal bundles explaining aspects of Lie groups and their actions, and we give some examples of principal $ G $-bundles in Section \ref{sub:examples_of_principal_g_bundles}. 

Following the steps of Riemannian geometry, in Section \ref{sub:theorem_on_normal_geodesics} we proceed studying the normal geodesics associated to sub-Riemannian structures, and in order to do that we make a brief introduction to symplectic geometry. This will allow to use the Hamiltonian formalism to characterize the horizontal geodesics as integral curves of the vector field associated to the sub-Riemannian Hamiltonian, which is defined in the same way than the Riemannian Hamiltonian, using the sub-Riemannian metric instead. With this formalism we proceed proving the Theorem on normal geodesics of bundle type sub-Riemannian metrics, which provides a way to identify normal (horizontal) geodesics in the (base) total space for a principal $ G $-bundle whose metric satisfies some special properties.

The cases where the conditions of the Theorem on normal geodesics of bundle type sub-Riemannian metrics do not apply are covered in Section \ref{sec:classical_particles_in_yang_mills_fields}, where we characterize the normal horizontal geodesics of a principal $ G $-bundle using the Wong's equations. These are a family of differential equations over the quotient of the cotangent space and the action of the Lie group $ G $ over it.
\section{Distributions}
\label{sec:1}

\subsection{Distributions and Horizontal Curves}%
\label{sub:distributions}

\begin{df}(\cite{luke2013vector}, section 1.3)\label{def:smooth_vector_bundle}
	The triple $ (E, M, \pi: E \rightarrow {M}) $ is a \textit{smooth vector bundle} if $ E,M $ are smooth manifolds, $ \pi $ is a smooth surjection; the fibers $ \pi^{-1}(p) $ for $ p\in M $  have the structure of finite dimensional vector spaces; and for every point $ p\in M $, there is an open neighborhood $ U $ of $ p $, a natural number $ k $ and a diffeomorphism $ \phi: U\times \mathbb{R}^k \rightarrow  \pi^{-1}(U),$ such that for all $ q\in U $ the following conditions hold:  

	\begin{itemize}
		\item $ (\pi\circ \phi)(q,v)=q $ for all $ v\in \mathbb{R}^k $, and  
		\item the map $ v \mapsto \phi(p,v) $ is a linear isomorphism between the vector spaces $\pi^{-1}(p) $ and $ \mathbb{R}^k. $     
	\end{itemize}
	The first condition means that the following diagram is commutative,	
	\begin{center}
		\begin{tikzcd}
		U\times \mathbb{R}^k \arrow[d, "p"'] \arrow[rr, "\phi"] &  & \pi^{-1}(U) \arrow[d, "\pi"] \\
		U \arrow[rr, "Id"']                                     &  & U                           
		\end{tikzcd}
	\end{center}
	where $ p:U\times \mathbb{R}^k \rightarrow U, \ p(q,v)=q$ is the projection onto the first factor.
\end{df}
We take the disjoint union of the tangent spaces at every point of the manifold in order to define the tangent bundle,
$ TM = \bigsqcup_{p\in M} T_pM, $ 
equipped with manifold structure given by the one of $ M. $ It is called a bundle because the triple $ (TM, M,\pi:TM \rightarrow {M}) $ satisfies the definition of smooth vector bundle, where $ \pi:TM \rightarrow {M} $  is the projection function, that assigns each tangent vector to the point where it is based. Each fiber of this bundle is a tangent space based on a point, and the tangent bundle is in particular a vector bundle because each fiber has structure of finite dimensional real vector space.



There is another important class of smooth vector bundles, namely, the tensor bundles, that are defined following \cite{wendl2008lecture}, examples 2.4 and 2.5.
\begin{df} 
	If $ (E,M,\pi:E \rightarrow {M}) $ is a smooth vector bundle, the dual bundle of this bundle is another smooth vector bundle $ (E^*,M,\pi^*:E^*\rightarrow {M}) $, known as \textit{ dual bundle}, whose fibers are the dual spaces to the fibers of $ E, $ that is,
	$$ (\pi^{*})^{-1}(p)=(\pi^{-1}(p))^*, \text{ for all }p\in M,$$ 
	and $$ E^* =\bigsqcup_{p\in M} (\pi^*)^{-1}(p). $$ 
\end{df}
\begin{df}
	If $ (E,M,\pi:E \rightarrow {M}) $ is a smooth vector bundle, the \textit{$ (k,l)- $tensor bundle} associated to this bundle, with $ k,l\geq0 $, is defined as the smooth vector bundle $ (T^k_l E, M, \pi_{kl}: T^k_l E \rightarrow {M}) $, whose fibers are the vector spaces of $ (k,l) -$tensors of the fibers of $ E, $ that is,     
	$$ \pi_{kl}^{-1}(p) = T^k_l \pi^{-1}(p)=\left( \bigotimes_{j=1}^l (\pi^{*})^{-1}(p)\right)\otimes \left( \bigotimes_{j=1}^k \pi^{-1}(p) \right), \text{ for all }p\in M, $$ 
	and
	$$ T^k_l E = \bigsqcup_{p\in M} \pi_{kl}^{-1}(p). $$ 
\end{df}
\begin{rem}
	If $ k=1,l=0, $ $T^0_1E=E,$ and if $ k=0,l=1, $ $ T^1_0=E^*. $ We associate $ T^0_0=M\times \mathbb{R} $ to the \textit{trivial line bundle} if both $ k=l=0. $ 
\end{rem}

The proof that both definitions are consistent definitions of smooth vector bundles can be found in \cite{luke2013vector}, section 1.3.
\begin{df}
	A \textit{smooth section} of a smooth vector bundle $ (E,M,\pi:E \rightarrow {M}) $ is a smooth application $ s: M \rightarrow {E} $ such that $ \pi\circ s= \mathbb{1}_{M}. $    
\end{df}
For an arbitrary smooth vector bundle bundle $ (E,B,\pi:E \rightarrow {B}), $ a sub-bundle of this bundle $ (E',B',\pi':E' \rightarrow {B'}) $  is a smooth vector bundle bundle that satisfies $ E'\subset E $, $ B'\subset B $, $ \pi|_{E'}=\pi' $ and the inclusion maps 
\begin{center}
	% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAFEByEAX1PUy58hFGQCMVWoxZsAQtz4DseAkTHlJ9Zq0Qde-EBmXC1pCdS0zds3pJhQA5vCKgAZgCcIAWyRkQOCCQAJmocOiwGNgALCAgAa303Tx9EdX9AxABmUPDI3Rj4xJAPb19QjLTLHRAAHRq0LG5qBjoAIxgGAAVBFREQdywHKJwikpSQ9KRsqW02OobbHiA
\begin{tikzcd}
E' \arrow[r, hook] \arrow[d, "\pi'"'] & E \arrow[d, "\pi"] \\
B' \arrow[r, hook]                    & B                 
\end{tikzcd}
\end{center}

are a morphism of vector bundles.
\begin{df}
	
	A \textit{distribution} $ \mathcal{H} $ over a manifold $ M $  is a vector sub-bundle of the tangent bundle $ TM $. \textit{ The rank $ k $}  of this distribution is defined as the dimension of its fibers.

	The fiber of $ \mathcal{H} $ at a point $ p\in M $ is denoted as $ H_p. $ 
\end{df}

The concept of distribution can be defined in an alternative but equivalent (see \cite{lee2003introduction}, Ch. 19, lemma 19.5) fashion using 1-forms, with the help of the following proposition.

\begin{prop}[Distribution (using 1-forms)]
	Suppose that $ M $ is a smooth $ m- $dimensional manifold, and $ \mathcal{H} \subset TM$ is a distribution of rank $k$. Then $ \mathcal{H} $ is smooth if and only if for every point $ p\in M $ there is a neighborhood $ U $ of that point where exist $n-k$ smooth 1-forms $ \omega^1,\dots,\omega^{n-k}, $ such that for all $ q\in U $,

	$$ \mathcal{H}_q = \operatorname{Ker} \omega^1|_q\cap \cdots \cap\operatorname{Ker} \omega^{n-k}|_q.  $$ 
\end{prop}

The following proposition gives an alternative way to represent a smooth distribution in terms of local frames (\cite{lee2003introduction}, Ch. 19, page 491).

\begin{prop} [Distribution (using local frames)]
	$ \mathcal{H}\subset TM $ is a smooth distribution over $M  $ if and only if  for each point $ p\in M $, there is an open neighborhood $ U $ of $ p $  and smooth vector fields $ X_1,\dots,X_n: U \rightarrow {TM} $ that at each point  $ q\in U $ form a base for $ \mathcal{H}_q. $ 
\end{prop}
Some examples of distributions over manifolds are given below.
\begin{ex}[Tangent Bundle]
	For any manifold $ M $, the tangent bundle $ TM $ is by definition a distribution over it. 
\end{ex}
\begin{ex}[Heisenberg Group]\label{ex:heis_group}
	Take $ \mathbb{R} ^3 $ as the manifold, and define over it the distribution $ \mathcal{H}\subset T \mathbb{R} ^3 $, whose fiber at an arbitrary $ (x,y,z)\in \mathbb{R}^3  $ is   
	$$ \mathcal{H}_{(x,y,z)} = \operatorname{Ker} \omega|_{(x,y,z)},$$
	where $ \omega = dz-(x dy-y dx)/2\in\Omega^1( \mathbb{R}^3).$ It is important to notice that $ \omega\neq 0 $ for all $ (x,y,z)\in \mathbb{R}^3. $ 
\end{ex}
\begin{rem}
	The last example is of particular interest because of its connection with the isoperimetrical problem. For more information see (\cite{montgomery2002tour}, Ch. 1).
\end{rem}
\begin{ex}[Vector field over a manifold]\label{ex:vect_field}
Any smooth vector field $ X: M \rightarrow {TM} $ which does not vanish  determines a distribution $ \mathcal{H}$ over the manifold $ M $ whose fiber at an arbitrary $ p\in M $ is the span of $ X_p. $
\end{ex}


Given a distribution $ \mathcal{H} $  over a manifold $M$,  a curve or vector field is said to be \textit{horizontal} if it is tangent to $ \mathcal{H} $. This means that, in the case of a curve, its tangent vector at every point is contained in the fibers of $ \mathcal{H} $; and in the case of a vector field, its value at every point is contained in the fibers of $ \mathcal{H} .$   

For example, every curve over a manifold with distribution given by its tangent bundle is horizontal. In the example \ref{ex:heis_group}, the liftings of the solutions of the isoperimetrical problem are horizontal. In example \ref{ex:vect_field}, the integral curves of the vector fields are examples of horizontal curves for that distribution.

\subsection{Frobenius' Theorem}%
\label{sub:frobenius_theorem}


Now the natural question that arises is, if given two points on a manifold with a given distribution, is there a smooth horizontal curve that joins them? 

\begin{df}
	Given a smooth distribution $ \mathcal{H} \subset TM$, we say that a nonempty immersed submanifold $ N\subseteq M $  is an \textit{integral manifold} of $\mathcal{H}$ if $ T_p N = \mathcal{H}_p $ for all $ p\in N $.
\end{df}
 As an example, in the distribution given in example \ref{ex:vect_field}, the image of any integral curve of the vector field that determines the distribution over the manifold is an integral manifold for that distribution. A particular example (taken from \cite{lee2003introduction}, example 19.1) of a distribution and its family of integral manifolds is given below.

\begin{ex}[Orthogonal complement of a given vector field]
Let $ \mathcal{H} $ be the distribution over $ \mathbb{R}^n $ determined by the radial vector field $ x^i \partial / \partial x^i $, and let $ \mathcal{H}^\perp $ be its perpendicular bundle, \textit{i.e.,} the distribution whose fibers are the orthogonal complement of the fibers of $ \mathcal{H}. $ $ \mathcal{H}^\perp $ is a distribution over $ \mathbb{R}^n  $, and the sphere centered at $0$, of radius $r>0$, is an integral submanifold of $ \mathcal{H}^\perp. $        
\end{ex}

There are distributions over a manifold that do not have integral manifolds, as is shown in the following example (\cite{lee2003introduction}, Ch. 19, example 19.1).

\begin{ex}[Distribution without integral manifolds] \label{ex:no_integral_manifolds}
	Consider the distribution $ \mathcal{H} $ over $ \mathbb{R}^3 $ spanned by the following vector fields: 
	$$ X = \frac{\partial}{\partial x} + y \frac{\partial}{\partial z}, \quad Y = \frac{\partial}{\partial y}.  $$ 
	This distribution does not have integral manifolds. To see this, suppose that $ N $ is an integral manifold that contains an arbitrary point $ \textbf{x} \in \mathbb{R}^3.  $ Because $ X $ and $ Y $ are tangent to $ N $, any integral curve of $ X $ or $ Y $ that starts in $ N $ stays in $ N $, at least for a short time (\textit{i.e.}, the integral curve $ \gamma $ must be defined over a sufficiently small interval such that its image is fully contained in $ N $).   

	Therefore, as the integral curve of $ X $ is a straight line contained in the plane that is parallel to the $ xz- $plane, there is a segment of this line that is contained in $ N $, and for every point in this segment, the integral curves of $ Y $ that passes through them are straight lines parallel to the $ y- $axis, so there must be an open neighborhood of $ \textbf{x}  $ that contains a plane generated by the segments of the integral curves of $ X $ and $ Y $ that passes through $ \textbf{x}$ (see figure \ref{fig:no_integral_manifolds}). However, the tangent plane at any point $ p $  of this plane  off of the segment induced by the integral curve of $ X $ is not equal to $ \mathcal{H}_p, $ since $ X $ depends of $ y $.   
\end{ex}

\begin{figure}
    \centering
    \incfig{no_integral_manifolds}
    \caption{Illustration of the planes generated at each point by the integral curves of the smooth vector fields that determine the distribution given in example \ref{ex:no_integral_manifolds}.}
    \label{fig:no_integral_manifolds}
\end{figure}

\begin{df}
	
A smooth distribution $ \mathcal{H} $ is said to be \textit{involutive} if given any pair of smooth vector fields $ X,Y $ defined on a open subset $ U $  of $ M $  that satisfy $X_p,Y_p\in \mathcal{H}_p $, $ p\in U, $ their Lie bracket also satisfies the same condition, \textit{i.e.}, it is tangent to the distribution in the given open subset. 
\end{df}

Let $ \Gamma(\mathcal{H}) $ be the set of all smooth vector fields globally defined, tangent to $ \mathcal{H}. $ It is clear from the definition of involutivity that if $ \mathcal{H} $ is involutive, $ \Gamma (\mathcal{H})\subset \mathfrak{X}(M) $ is a Lie subalgebra. The converse statement (if $ \Gamma(\mathcal{H}) $ is a Lie algebra, then $ \mathcal{H} $ is involutive) is also true, and can be proved extending any pair of smooth vector fields locally defined, tangent to $ \mathcal{H} ,$ to a pair of vector fields in $ \Gamma( \mathcal{H}), $ using an adequate bump function (\cite{lee2003introduction}, Proposition 19.2). 

\begin{df}
	A smooth distribution $ \mathcal{H} $ over a manifold $ M $ is called \textit{integrable} if each point of $ M $ is contained in an integral manifold of $ \mathcal{H}. $  
\end{df}
It is clear then that \textit{every integrable distribution is involutive}, because every pair of smooth vector fields tangent to $ \mathcal{H}, $ defined over an open set $ U\subset M $, satisfy that their Lie bracket is also tangent to $ \mathcal{H} $ in that open set. This can be seen because there exists a integral manifold $ N $  of $ \mathcal{H} $ for every point of $ U $ such that the pair of smooth vector fields are tangent to $ N $, and in consequence, their Lie bracket is also tangent to $ N. $  

In fact, the involutivity condition does not need to be checked for all smooth vector fields on $ \Gamma( \mathcal{H}), $ but it suffices to check if the Lie brackets of pairs of smooth vector fields of the local frame that determines the distribution are tangent to it, as the following lemma states (\cite{lee2003introduction}, lemma 19.4).

\begin{lm}[Local frame criterion for involutivity] 
	Let $ \mathcal{H}\subset TM $ be a distribution. If for every point in $ M $ there is a neighborhood such that there exists a local smooth frame $ (X_1,\dots, X_k) $ for $ \mathcal{H} $ such that $ [X_i,X_j] $ is a section of $ \mathcal{H} $ for each $ i,j, $ then $ \mathcal{H} $ is involutive.
\end{lm}

\begin{df}
	Given a smooth distribution $ \mathcal{H}\subset TM $  of rank $ k, $ a smooth coordinate chart $ (U,\phi) $ of $ M $ is said to be \textit{flat for $ \mathcal{H} $ } if $ \phi(U) $ is a cube in $ \mathbb{R}^m  $ (being $ m $ the dimension of $ M $), and at points of $ U $, $ \mathcal{H} $ is spanned by the first $ k $ coordinate vector fields $ \partial/\partial x^1,\dots,\partial/\partial x^k $ (see figure \ref{fig:fittogether}).
\end{df}
The geometrical meaning of this property for a distribution is that the manifold is locally homeomorphic to a cube in $ \mathbb{R}^m  $ through the flat chart for $ \mathcal{H}, $  and the vector subspaces induced by the distribution at each point fit together as affine spaces of dimension given by the rank of the distribution in $ \mathbb{R}^m $. Also, each slice of the form $ x^{k+1}=c^{k+1},\dots, x^m=c^m,$ for constants $ c^{k+1}, \dots, c^m $ in the image of $ U $ of such a chart is an integral manifold of the distribution generated by $ \partial/\partial x^1,\dots,\partial/\partial x^k $, and the preimage of this integral manifold is an integral manifold of $ \mathcal{H}, $ contained in $ U. $  

\begin{figure}
    \centering
    \incfig{fittogether}
    \caption{Flat chart for a distribution.}
    \label{fig:fittogether}
\end{figure}

The case when every point $p\in M $ has a coordinate chart flat for $ \mathcal{H} $ and centered in $ p $ is discussed in the following definition and geometrical interpretation.

\begin{df}
	A smooth distribution $ \mathcal{H}\subset TM $  is said to be \textit{completely integrable} if there exists a flat chart for $ \mathcal{H} $ in a neighborhood of each point of $ M. $ 
\end{df}

Therefore, if a distribution is completely integrable, is then integrable, since there exists an integral manifold for each point (that in particular is known as \textit{maximal integral manifold}, as the dimension of this manifold coincides with the rank of the distribution), given by the integral manifold that contains this point in the image of the coordinate chart flat for $ \mathcal{H}. $ In this way, \textit{ if a distribution is completely integrable, it is integrable, and therefore involutive.} In fact, these implications are actually equivalences, due to Frobenius's theorem.

\begin{thm}[Frobenius]
	Every involutive distribution is completely integrable.	
\end{thm}

\begin{proof}
	(\cite{lee2003introduction}, Ch. 19, theorem 19.12) First, it will be shown that any involutive distribution is spanned by independent commuting smooth vector fields, and as a consequence of this fact, the distribution is completely integrable.

	Let $ \mathcal{H} $ be an involutive distribution of rank $ k $ on an $ m- $dimensional manifold $ M $, and let $ p\in M $ . Let $ (U,\varphi) $ be a smooth coordinate chart centered in $ p. $ Then, $ \varphi(U)\subset \mathbb{R}^m $, and let $ X_1,\dots,X_k $ be a smooth local frame for $ \mathcal{H} $ in $ U. $

	Now, $ \left\{ d\varphi \left( X_i \right) \right\}_{i=1}^k $ is a set of linearly independent vector fields over $ \varphi(U). $ One can reordinate the coordinates of $ \mathbb{R}^m $ to make $ \mathcal{H}'_{\varphi(p)} $ (understood as the fiber of the distribution whose local frame is given by $ \left\{ d\varphi \left( X_i \right) \right\}_{i=1}^k $) complementary to the subspace generated by $ \left( \partial/\partial x^{k+1}|_{\varphi(p)},\dots,\partial/\partial x^{m}|_{\varphi(p)} \right). $   

	Let $ \pi: \mathbb{R}^m \rightarrow  \mathbb{R}^k$ the projection onto the first $ k $ coordinates, that is, $ \pi(x^1,\dots,x^m)=(x^1,\dots,x^k). $ This map induces a smooth (because it is the composition $\mathcal{H}' \hookrightarrow T\varphi(U) \xrightarrow[]{d\pi} T\pi(\varphi(U))$ )  bundle homomorphism $ d\pi: T \mathbb{R}^m \rightarrow \mathbb{R}^k	 $ that acts as follows:
	$$ d\pi \left( \sum_{i=1}^m v_i \frac{\partial}{\partial x^i} \Big|_{\varphi(q)}   \right) = \sum_{i=1}^k v_i \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))}, \text{ for }q\in U.$$ 

	By the choice of coordinates, $ \mathcal{H}'_{\varphi(p)}\subset T_{\varphi(p)} \mathbb{R}^m $ is complementary to the kernel of $ d\pi_{\varphi(p)}, $ so the restriction $ d\pi|_{\mathcal{H}'_{\varphi(p)}} $ is bijective. By continuity, the same is true for $ d\pi|_{\mathcal{H}'_{\varphi(q)}} $, with $ q\in U $, and therefore, the matrix entries of $ \left(d\pi|_{\mathcal{H}'_{\varphi(q)}} \right)^{-1}: T_{\pi(\varphi(q))} \mathbb{R}^k \rightarrow \mathcal{H}'_{\varphi(q)}$ are smooth, which makes the map smooth. With this in mind, the set of vector fields $ V_1,\dots,V_k $, defined by
	$$ V_i|_{\varphi(q)}= \left(  d\pi|_{\mathcal{H}'_{\varphi(q)}}  \right)^{-1} \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))} $$ 
	is a local frame of $ \mathcal{H'}. $ It is in fact a smooth commuting local frame, as will be seen below. 

	First, notice that $ V_i $ and $ \partial/\partial x^i $ are $ \pi- $related, for $ i=1,\dots,k, $ because
	$$ \frac{\partial}{\partial x^i} \Big|_{\pi(\varphi(q))} = d\pi |_{\mathcal{H}'_{\varphi(q)}} \left( V_i |_{\varphi(q)} \right) = d\pi_{\varphi(q)}(V_i|_{\varphi(q)}), $$ 
	so by the naturality of Lie brackets,
	$$ d\pi_{\varphi(q)} \left( \left[ V_i,V_j \right]_{\varphi(q)} \right)= \left[ \frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j}   \right]_{\pi(\varphi(q))}=0, $$ 
	but as $ d\pi|_{\mathcal{H}'_{\varphi(q)}} $ is injective and $ [V_i,V_j]_{\varphi(q)}\in \mathcal{H}'_{\varphi(q)} $, since $ \mathcal{H} $ is involutive, $ [V_i,V_j]_{\varphi(q)}=0 $ for all $ q\in U, $ so $ \left\{ V_i \right\}_{i=1}^k $ form a smooth commuting frame for $ \mathcal{H}', $ and $ \left\{ d\varphi^{-1}(V_i) \right\}_{i=1}^k $ is a smooth commuting local frame for $ \mathcal{H}. $   

	Finally, to show that the existence of the commuting frame $ \left\{V_i \right\}_{i=1}^k $ for $ \mathcal{H}' $ is a sufficient condition for $ \mathcal{H} $ to be completely integrable, let $ \theta_i $ be the flow of $ V_i, $ $i=1,\dots,k.$ There is a neighborhood $ W $ of $ \varphi(p)  $, contained in $ \varphi(U) $ such that the composition  
	$ (\theta_1)_{t_1}\circ(\theta_2)_{t_2}\circ\cdots\circ(\theta_k)_{t_k} $
	is well defined, for sufficiently small $ t_1,\dots,t_k $ ($|t_i|<\epsilon  $, for an adequate $ \epsilon>0$). Define $ \Omega \subset \mathbb{R}^{m-k} $ as    
	$$ \Omega = \left\{ (s^{k+1},\dots,s^m)\in \mathbb{R}^{m-k}\ : \ (0,\dots,0,s^{k+1},\dots,s^m)\in W \right\}, $$ 
	and $\Phi:(-\epsilon,\epsilon)\times \Omega \rightarrow \varphi(U)$ as
	$$ \Phi(s^1,\dots,s^k,s^{k+1},\dots,s^m)=(\theta_1)_{s^1}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m). $$ 
	
	Notice that, by construction, $ \Phi( \left\{ 0 \right\}^k\times\Omega) = ({0}^k\times \mathbb{R}^{m-k})\cap W. $ Moreover, $ \partial/\partial s^i $ and $ V_i $ are $ \Phi- $related for $ i=1,\dots,k, $ because, as the flows commute, for a given $ s^0=(s^1,\dots,s^m)\in (-\epsilon,\epsilon)^k\times \Omega, $ 

	\begin{dmath*}
		d\Phi_{s^0} \left( \frac{\partial}{\partial s^i} \Big|_{s^0}  \right) f = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( \Phi \left( s^1,\dots,s^m \right) \right) = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( (\theta_1)_{s^1}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m) \right) = \frac{\partial}{\partial s^i} \Big|_{s^0} f \left( (\theta_i)_{s^i}\circ\cdots\circ(\theta_{i-1})_{s^{i-1}}\circ(\theta_{i+1})_{s^{i+1}}\circ\cdots\circ(\theta_k)_{s^k}(0,\dots,0,s^{k+1},\dots,s^m) \right),
	\end{dmath*}
	and for any $ q\in\varphi(U) $, $ t\mapsto (\theta_i)_t(q) $ is an integral curve of $ V_i, $ so the above expression is equal to $ V_i|_{\Phi(s^0)} f $, which shows that $ \partial/\partial s^i |_{s^0} $ and $ V_i $ are $ \Phi- $related.   

	By the previous computations, $$ d\Phi_0\left( \frac{\partial}{\partial s^i}\Big|_{0} \right) = V_i |_{\varphi(p)}, \ i=1,\dots,k, $$ and on the other hand, since $ \Phi(0,\dots,0,s^{k+1},\dots,s^m)=(0,\dots,0,s^{k+1},\dots,s^m), $ it follows that
	$$ d\Phi_0 \left( \frac{\partial}{\partial s^i}\Big|_{0}  \right) = \frac{\partial}{\partial x^i}\Big|_{\varphi(p)},\ i=k+1,\dots,m.  $$ 
	
	Therefore, $ d\Phi_0 $ takes the basis $ \left( \partial/\partial s^1 |_0,\dots,\partial/\partial s^m |_0 \right) $ of $ T_0 \mathbb{R}^m $ to the basis $ ( V_1|_{\varphi(p)},  \dots,$ $ V_k|_{\varphi(p)}, \partial/\partial x^{k+1}|_{\varphi(p)}, \dots, \partial/\partial x^{m}|_{\varphi(p)}) $ of $ T_{\varphi(p)} \varphi(U). $ By the inverse function theorem, $ \Phi $ is a local diffeomorphism (in a neighborhood of $ 0 $), and $ \phi=\Phi^{-1} $ is a smooth coordinate chart that takes $ V_i $ to $ \partial/\partial s^i $, for $ i=1,\dots,k, $ and takes $ \partial / \partial x^{i} $ to $ \partial/\partial s^i $, for $ i=k+1,\dots,m. $ Thus, the smooth coordinate chart flat for $ \mathcal{H} $ in a neighborhood of $ p\in M $ is $ \phi\circ\varphi, $ and since this is independent of $ p $, for every point there is a smooth coordinate chart flat for $ \mathcal{H}, $ what makes $ \mathcal{H} $ a completely integrable distribution.

\end{proof}

The next proposition is one of the main consequences of Frobenius theorem, and is fundamental to study foliations, topic that is going to be discussed below.
\begin{prop}[Local structure of integral manifolds]\label{prop:local_structure}
	Let $ \mathcal{H} $ be an involutive distribution of rank $ k $ on a smooth manifold $ M $, and let $ (U,\varphi) $ be a flat chart for $ \mathcal{H} $. If $ N $ is any connected integral manifold of $ \mathcal{H}, $ then $ \varphi(U\cap N) $ is the union of countably many disjoint open subsets of parallel $ k $-dimensional slices of $ \varphi(U) $, whose preimages are open in $ N $ and embedded in $ M $.
\end{prop}

\begin{figure}
    \centering
    \incfig{local_structure}
    \caption{Local structure of an integral manifold.}
    \label{fig:local_structure}
\end{figure}

\begin{proof}(\cite{lee2003introduction}, Ch. 19, proposition 19.16)
	Let $ N $ be an integral manifold of $ \mathcal{H}. $ Since the inclusion map $ \iota: N \hookrightarrow M $ is continuous, $ \varphi( \iota^{-1}(U))=\varphi(N\cap U) $  is open in $ \varphi(N) $. Then, $ \varphi(U\cap N) $ is the union of open slices (\textit{i.e.}, open subsets of a slice of $ \varphi(U)$) with $ x_i=\text{constant} $, for $ i=k+1,\cdots,m.$ Moreover, this union is at most countable, because $ N $ is second countable, and since $ \varphi(N\cap U) $ is a union of open slices, $ \pi(\varphi(U\cap N)) $ consists of a countable number of points (recall that $ \pi: \varphi(U) \rightarrow \mathbb{R}^{m-k} $ is the projection onto the last $ m-k $ coordinates) in $ \mathbb{R}^{m-k}, $ which implies that the union of open slices is at most countable.  

	Finally, if $ V $ is an open slice in the slice $ S, $ the inclusion map $ \varphi^{-1}(V) \hookrightarrow M $ is a smooth embedding, because it is the composition of smooth embeddings $ \varphi^{-1}(V)\hookrightarrow \varphi^{-1}(S) \hookrightarrow M.$ 
\end{proof}

The last proposition implies that one can put all the maximal integral manifolds of an involutive distribution of rank $ k $  together, to obtain a partition on $ M $ into $ k $-dimensional submanifolds, that satisfy the following definition.
\begin{df}
	A smooth chart $ (U,\varphi) $ for $ M $ is called \textit{flat for a collection $ \mathcal{F} $ of $ k- $dimensional submanifolds of $ M $} if $ \varphi(U) $ is a cube in $ \mathbb{R}^m, $ and the image of each submanifold via $ \varphi $ intersects $ \varphi(U) $ in either the empty set or in a countable union of $ k- $dimensional slices of the form $ x^{k+1}=c^{k+1},\dots,x^m=c^m. $   
\end{df}

\begin{df}
	A \textit{foliation of dimension $ k $ on a smooth manifold $ M $} is a collection $ \mathcal{F} $ of disjoint, connected, nonempty, immersed $ k $-dimensional submanifolds of $ M $ (called the \textit{leaves} of the foliation), whose union is $ M $, and such that in a neighborhood of each point $ p\in M $ there is a flat chart for $ \mathcal{F}. $  
\end{df}

The following are examples of foliations over a manifold, mainly taken from \cite{lee2003introduction}, Ch. 19, example 19.18.

\begin{ex}[Collection of affine subspaces]
	The collection of all $ k $-dimensional affine subspaces of $ \mathbb{R}^m $ parallel to $ \mathbb{R}^k\times \left\{ 0 \right\} $ is a $ k $-dimensional foliation for $ \mathbb{R}^m. $ 
\end{ex}

\begin{ex}[Spheres centered at the origin]
	The collection of all spheres centered at $ 0 $ is an $ (m-1) $-dimensional foliation of $ \mathbb{R}^m\setminus \left\{ 0 \right\} $. 
\end{ex}

\begin{ex}[Cartesian product of manifolds]\label{ex:product_foliation}
	If $ M $ and $ N $ are connected smooth manifolds, the collection of subsets of the form $ M\times \left\{ q \right\}, $ with $ q\in N $, is a foliation of $ M\times N, $ each of whose leaves is diffeomorphic to $ M. $  	
\end{ex}

\begin{ex}[Foliations on a torus]
	The torus $ T= \mathbb{S}^1\times \mathbb{S}^1 $ can be endowed with the distribution induced by the cartesian product of manifolds (see example \ref{ex:product_foliation}). In this case, the foliation is conformed by copies of $ \mathbb{S}^1. $ The horizontal curves are segments of this copies, and if two points lay in different copies, there is not a horizontal curve that connects them.
\end{ex}

From the definition of foliations, it is clear that \textit{if $ \mathcal{F} $ is a foliation on a smooth manifold $ M, $ the collection of tangent spaces to the leaves of $ \mathcal{F} $ forms an involutive distribution on $ M. $} In a reciprocal way, the collection of maximal integral manifolds of an involutive distribution forms a foliation over the manifold, as it is stated in the global Frobenius theorem.

\begin{thm}[Global Frobenius theorem]
	Let $ \mathcal{H} $ be an involutive distribution on a smooth manifold $ M. $ The collection of all maximal connected integral manifolds of $ \mathcal{H} $ forms a foliation of $ M. $ 
\end{thm}

The next lemma (\cite{lee2003introduction}, Ch. 19, lemma 19.22) is going to be used to prove this theorem.

\begin{lm}\label{lm:man_struct}
	Suppose that $ \mathcal{H}\subset TM $ is an involutive distribution, and let $ \left\{ N_\alpha \right\}_{\alpha\in A} $ be any collection of connected integral manifolds of $ \mathcal{H} $ with a point in common. Then, $ N=\bigcup_{\alpha} N_\alpha $ has a unique smooth manifold structure making it into a connected integral manifold of $ \mathcal{H}. $  
\end{lm}

\begin{proof}[Proof of the global Frobenius theorem]
	(\cite{lee2003introduction}, Ch. 19, theorem 19.21) For each $ p\in M $, let $ L_p $ be the union of all connected integral manifolds of $ \mathcal{H} $ containing $ p. $ By lemma \ref{lm:man_struct}, $ L_p $ is a connected integral manifold of $ \mathcal{H} $ containing $ p $, and it is clearly maximal. By maximality, if $ L_p $ and $ L_{p'} $ intersect, $ L_p=L_{p'} $, because $ L_p\cup L_{p'} $ is an integral manifold containing both $ p $ and $ p' $. Thus, the maximal connected integral manifolds are either disjoint or identical.    

	If $ (U,\varphi) $ is any flat chart for $ \mathcal{H}, $ then $ \varphi(L_p\cap U) $ is a countable union of open subsets of slices (by proposition \ref{prop:local_structure}). For any such slice $ S, $ if $ \varphi(U\cap L_p)\cap S $ is neither empty nor entire $ S, $ then $ L_p\cup \varphi^{-1}(S )$ is a connected integral manifold properly containing $ L_p, $ which contradicts the maximality of $ L_p. $ Therefore, $ \varphi(L_p\cap U) $ is precisely a countable union of slices, so the collection $ \left\{ L_p\ : \ p\in M \right\} $ is the desired foliation.
\end{proof}

With the global Frobenius theorem, one can answer the question at the beginning of this subsection: in general, for an given distribution there is no smooth horizontal curve that connects an arbitrary pair of points, because the points can be in different leaves of the foliation given by the distribution.


\section{Sub-Riemannian Geometry}%
\label{sec:sub-Riemannian_geometry}

\subsection{Sub-Riemannian Structure and Geodesics}%
\label{sub:sub-Riemannian_structure_and_geodesics}
\begin{df}
	A \textit{sub-Riemannian structure over a manifold} $ M $ is a pair $ (\mathcal{H}, \langle\cdot,\cdot\rangle)$, where $ \mathcal{H}\subset TM $ is a distribution and $ \langle\cdot,\cdot\rangle $ is a section of the bundle $ T^0_2 \mathcal{H} \xrightarrow[]{\pi} M, $ whose values are positive definite symmetric bilinear forms (\cite{hatcher2003vector}, Ch. 1, page 12).

	The distribution $ \mathcal{H} $ is called \textit{horizontal}, and the tensor field $ \langle\cdot,\cdot\rangle $ is called \textit{metric}.  
\end{df}

Some examples of sub-Riemannian structures are given below.
\begin{ex}[Riemannian Structure]\label{ex:riem_geo2}
	Every Riemannian structure is in particular a sub-Riemannian structure, where the distribution is the entire tangent bundle.
\end{ex}

\begin{ex}[Heisenberg Group]\label{ex:heis_group2}
	The distribution of the Heisenberg group is commented in example \ref{ex:heis_group}. The inner product over a fiber $ \mathcal{H}_{(x,y,z)} $, with $ (x,y,z)\in \mathbb{R}^3 $  is given by $\langle\cdot,\cdot\rangle:  \mathcal{H}_{(x,y,z)}\times\mathcal{H}_{(x,y,z)} \rightarrow { \mathbb{R} }:(v,w)\mapsto v_1w_1+v_2w_2,$ where $ v=(v_1,v_2,v_3) $ and $ w=(w_1,w_2,w_3). $  

\end{ex}
\begin{ex}[Vector Field over a Manifold]\label{ex:vect_field2}
	As seen in example \ref{ex:vect_field}, any smooth vector field $ X: M \rightarrow TM$ that does not vanish determines a distribution.  The fiber inner-product $ \langle\cdot,\cdot\rangle: \mathcal{H}_p \times \mathcal{H}_p \rightarrow \mathbb{R} $ for $ p\in M $  is given by $\langle\lambda_1 X_p,\lambda_2 X_p\rangle=\lambda_1 \lambda_2.$
\end{ex}
For horizontal curves, one can define the \textit{length of a horizontal smooth curve} $ \gamma $ (denoted by $ \ell(\gamma) $) as in the case of Riemannian geometry:
$$ \ell(\gamma) = \int ||\dot{\gamma}|| dt, $$ 
since the tangent vectors of the curve at all points are in the fibers of the horizontal distribution, where an inner product is defined, and $ ||\dot{\gamma}||= \sqrt[]{\langle\dot{\gamma}, \dot{\gamma}\rangle}.  $   

\begin{df}\label{df:horizontal_distance}
	The \textit{distance between two points} $ p,q\in M $, denoted by $ d(p,q), $   is defined as the infimum of the lengths of all absolutely continuous horizontal curves that begin in $ p $ and end in $ q $, that is, 
$$ d(p,q) = \operatorname{inf} \left\{ \ell(\gamma) \ |\ \gamma:[0,1] \rightarrow {M} \text{ is absolutely continuous and }\gamma(0)=p, \ \gamma(1)=q \right\}. $$ 
The distance between two points is said to be infinite if there is no horizontal curve joining them.
\end{df}

The curves that are considered in Definition \ref{df:horizontal_distance} are required to be absolutely continuous, which is a weaker condition than smoothness in the sense that the curve is differentiable in almost all points of its domain, not necessarily in all its domain. Nevertheless, the distance remains the same if we consider instead the set of all smooth curves (see \cite{montgomery2002tour}, page 23), but the motivation to consider the bigger set of absolutely continuous curves is due to the fact that the curves that realize the distance between two points are not always smooth.

\begin{df}
	Given a sub-Riemannian structure $ (\mathcal{H}, \langle\cdot,\cdot\rangle) $ over a manifold $ M $  (or Riemannian structure, if $ \mathcal{H}=TM $), it is said that an absolutely continuous horizontal curve $ \gamma:  [a,b] \rightarrow M$, with $ \gamma(a)=p, \gamma(b)=q $ is a \textit{geodesic} if it realizes the distance between $ p $ and $ q $, that is,   
	$$ \ell(\gamma)= d(p,q). $$ 
\end{df}


\subsection{Chow's Theorem}%
\label{sub:chow_s_theorem}

The section \ref{sub:frobenius_theorem} provides a class of (involutive) distributions where it is not true that every two points can be connected through a horizontal curve.  Now, it is worthwhile to ask for a sufficient condition for a distribution to have the connectedness property through horizontal curves. To formulate such a condition, we need to make a preliminary discussion on bracket-generating distributions.

\begin{df}
	A distribution $ \mathcal{H}\subset TM $ is called \textit{bracket-generating} if for every $ p\in M $, there is a local frame $ X_1,\dots,X_k: U \rightarrow {TM} $ of $ \mathcal{H} $ such that 
	$$ TU = \operatorname{span}\left\{ [X_{i_1},\dots,[X_{i_{j-1}},X_{i_j}]]\ : \ i_1,\dots,i_j=1,\dots,k;\ j\in \mathbb{N} \right\}.  $$ 
\end{df}

\begin{lm}\label{lm:approx}
	Let $ X_1,X_2 $ be two smooth vector fields over the manifold $ M $, with respective local flows $ \Phi_1,\Phi_2:(-\epsilon,\epsilon)\times U \rightarrow {U}$, and let $ p\in U. $ Then, in any coordinate system the following relation holds:
	$$ \left[ \Phi_1(t), \Phi_2(t) \right](p) := \left( \Phi_1(t)\circ \Phi_2(t) \circ \Phi_1(t)^{-1}\circ \Phi_2(t)^{-1} \right)(p)=p+t^2 \left[ X_1,X_2 \right](p) + O(t^3). $$ 
\end{lm}
\begin{proof}
	By Taylor's theorem, we have $$ \Phi_i(t)(p)=p+tX_i(p)+ \frac{t^2}{2} X_i(X_i(p)) + O(t^3), \text{ for }i=1,2.  $$ 
	In the other hand, as $ \left\{ \Phi_i(t) \right\}_{t\in(-\epsilon,\epsilon)} $ is the family of diffeomorphisms associated with the flow of $ X_i, $ $ \Phi_i(t)^{-1}=\Phi_i(-t). $ Then,   
	\begin{dmath*}
	 (\Phi_1(t)^{-1}\circ \Phi_2(t)^{-1})(p) = p- t \left( X_1(p)+X_2(p) \right)+ t^2 X_1(X_2(p)) + t^2 \left( X_1(X_1(p))+ X_2(X_2(p)) \right) + O(t^3), 
	\end{dmath*}
	and evaluating $ \Phi_1(t)\circ\Phi_2(t) $ in this point gives

	\begin{dmath*}
	\left( \Phi_1(t)\circ \Phi_2(t) \circ \Phi_1(t)^{-1}\circ \Phi_2(t)^{-1} \right)(p) = p+t^2 \left[ X_1,X_2 \right](p)+ t^2 \left( X_1(X_1(p)) + X_2(X_2(p)) \right) - t( X_1(p)+X_2(p)) - t^2 \left( X_1(X_1(p)) + X_2(X_2(p)) \right) +t( X_1(p)+X_2(p)) + O(t^3) = p+t^2 \left[ X_1,X_2 \right](p) + O(t^3), 
	\end{dmath*}
	which is the desired result.	
\end{proof}

Chow's theorem guarantees that any bracket-generating distribution over a connected manifold has the connectedness property through horizontal curves, and we going to derive this result in the rest of this section, following closely the procedure of \cite{montgomery2002tour}, Section 2.4. First of all, choose a base point $ p\in M $ and a local orthonormal frame field $ X_i $, $ i=1,\dots, k $ for the distribution $ \mathcal{H} $. Let $ \Phi_i $ be the flow of $ X_i $. These flows can be used to move in the horizontal directions (points connected to $ p $ through integral curves of the orthonormal frame), using the formula $ \Phi_i(t)(q)=q+tX_i(q)+O(t^2) $ for sufficiently small $ t. $ 

The assignments $ t\mapsto \Phi_i(t)(q) $ are horizontal curves for the distribution $ \mathcal{H}, $ and are called \textit{simple horizontal curves.} As the frame is orthonormal, the length of a simple horizontal curve with $ 0\leq t\leq \epsilon  $ is $ \epsilon. $   

Applying $ \Phi_k(t_k)\circ\cdots\circ \Phi_2(t_2)\circ\Phi_1(t_1)$ to $ p $ and letting $ t_1,\dots,t_k $ vary over the cube $ |t_i|\leq\epsilon, $ we move from $ p $ to another point inside the $ k- $dimensional  cube of volume $ (2\epsilon)^k$ in the coordinate chart, whose sides are determined by the local frame in the image of $ p $. Each point of this cube can be reached from $ p $ through the concatenation of $ k $ or fewer flows, and this cube is inside of the sub-Riemannian ball of radius $ k\epsilon $, that is,
\begin{align*}
 \operatorname{Box}_p(\epsilon):= \left\{ \Phi_k(t_k)\circ\cdots\circ \Phi_2(t_2)\circ\Phi_1(t_1)(p) \ | \ |t_i|<\epsilon, \ i=1,\dots,k \right\}\\ \subset \operatorname{B}(k\epsilon, p):= \left\{ q\in M \ | \ d(p,q)<k\epsilon \right\}.  
\end{align*}

We can move in the remaining directions along horizontal paths by successive applications of the commutators of flows, based on the bracket-generating property of the distribution in the following way. Let $ \mathcal{H} $ denote also the sheaf of smooth vector fields tangent to $ \mathcal{H}, $ that is, the association between open sets $ U\subset M $ and horizontal smooth vector fields $ \mathcal{H}(U) $ defined locally on $ U $, and define the new vector sheaves
$$ \mathcal{H}^2 := \mathcal{H}\oplus [\mathcal{H},\mathcal{H}],\quad \mathcal{H}^{r+1} := \mathcal{H}^r\oplus [\mathcal{H}, \mathcal{H}^r], $$
where
$$ \left[ \mathcal{H}, \mathcal{H}^j \right]:= \operatorname{span} \left\{ [X,Y] \ | \ X\in \mathcal{H},\ Y \in \mathcal{H}^j \right\}, \text{ for }j=1,2,\dots  $$ 
The movement in the $ \mathcal{H}^2/\mathcal{H} $ directions can be made along horizontal paths by applying the commutators $ \Phi_{ij}(t):= [\Phi_i(t),\Phi_j(t)] $ to $ p. $ As $ \Phi_{ij}(t)(p)=p+t^2[X_i, X_j](p) $ (by lemma \ref{lm:approx}) if $ |t|\leq\epsilon, $ we will move by an amount $ \epsilon^2 $ in the $ \mathcal{H}^2/\mathcal{H} $ directions. This process is realized inductively until exhausting the tangent space. Let $ I=(i_1,i_2,\dots,i_n), $ $ 1\leq i_j\leq k $, and $ X_I:=[X_{i_1}, X_J], $ where $ J=(i_2,\dots,i_n), $  so that $ X_I $ is the iteration of $ n $ Lie brackets. Similarly, define flows $ \Phi_I(t):=[\Phi_{i_1}(t), \Phi_J(t)] $. By successive application of lemma \ref{lm:approx}, we have that   
$$ \Phi_I(t)= \mathbb{1} +t^n X_I+ O(t^{n+1}).$$ 
Due to the bracket-generating condition over any local frame of the distribution, we can select a local frame for the entire tangent bundle amongst the $ X_I, $ letting $ n $ and $ i_1,\dots,i_n $ vary accordingly. We choose such a frame and relabel it as $ Y_i, $ $ i=1,\dots,m, $ in a way that it satisfies: $ Y_1=X_1,\dots, Y_k=X_k $ span $ \mathcal{H} $ near $ p, $ $ \left\{ Y_1,\dots,Y_{n_2} \right\} $ span $ \mathcal{H}^2 $ near $ p, $ $ \left\{ Y_1,\dots,Y_{n_2},\dots,Y_{n_3} \right\} $ span $ \mathcal{H}^3 $ near $ p $,  and so on. The tuple $ (k,n_2,n_3,\dots, n_r) $ is called the \textit{growth vector of the distribution at $ p $}, and the smallest integer $ r $ is called the \textit{step or degree of nonholonomy of the distribution at $ p. $ }   

\begin{df}[\cite{montgomery2002tour}, page 49.] Let $ \left\{ Y_1,\dots, Y_m \right\} $ be the local frame of the tangent bundle in a neighborhood of $ p\in M $ constructed as stated before using the local frame of a bracket-generating distribution. Let $ Y_i=X_I $, $ I=(i_1,\dots,i_{n_I}) $. We denote the length of $ I $ as $ w_i:= \left| I \right| $, and define the assignment $ i\mapsto w_i, $ called the \textit{weighting associated to the growth vector}. 
	
\end{df}

We relabel the flows $ \Phi_I $ in a similar fashion, so that $ \Phi_i $ is the flow associated to $ Y_i. $ In this case, each point $ \Phi_i(t)(p) $ is the endpoint of the concatenation of $ w_i $ simple horizontal curves, each one of length $ t $. If we impose that $ \left| t \right|\leq \epsilon, $ then $ \Phi_i(t)(p) $ lies in the ball of radius $ w_i\epsilon $ centered at $ p. $ Moreover, in coordinates we have that 
$$ \Phi_i(t)(p)=p+t^{w_i}X_i(p)+ O(t^{w_i+1}), $$ 
so $ \Phi_i(t)(p) $ lies in the Euclidean box of volume $ \epsilon^{w_i} $, in the $ \mathcal{H}^{w_i} $ directions. From this we can deduct that the sub-Riemannian ball $ B(\epsilon,p) $ contains an Euclidean coordinate box whose sides are of order $ \epsilon^{w_i} $ in the $ i $-th direction. This result is known as the ball-box theorem, and it will be stated and proved after the following definitions.

\begin{df}[\cite{montgomery2002tour}, definition 2.4.1] 
	Coordinates $ y_1,\dots,y_m $ are said to be \textit{linearly adapted to the distribution $\mathcal{H}$ at $ p $ } if $ \mathcal{H}^i(p):= \{ X(p) \ | \ X$ is a section of $\mathcal{H}$ defined on $p$$\}$ is annihilated by the differentials $ dy_{n_i+1},\dots, dy_m $ at $ p, $ where $ n_i=n_i(p) $ are the coordinates of the growth vector at $ p. $  
\end{df}
\begin{df}
	The $ w $- weighted box of size $ \epsilon $ is the point set
	$$ \operatorname{Box}^w(\epsilon) := \left\{ y\in \mathbb{R}^m \ | \ |y_i|\leq \epsilon^{w_i}; \ i=1,\dots,m \right\}.  $$ 
\end{df}

Set $ y_i $ as the coordinates centered at $ p $ such that $ dy_i(p) $ are the dual basis to the $ Y_i(p), $ so that these coordinates are linearly adapted to the distribution by definition.

\begin{thm}[Ball-Box Theorem]
	There exist linearly adapted coordinates $ y_1,\dots,y_m $ and positive constants $ c<C, \ \epsilon_0>0, $ such that for all $ \epsilon<\epsilon_0, $ 
	$$ \operatorname{Box}^w(c\epsilon)\subset B(\epsilon, p)\subset \operatorname{Box}^w(C\epsilon).    $$ 
\end{thm}
\begin{figure}[ht]
    \centering
    \incfig{ballbox}
    \caption{Ball box theorem.}
    \label{fig:ballbox}
\end{figure}
\begin{proof}[Proof of $\operatorname{Box}^w(c\epsilon)\subset B(\epsilon, p)$] (\cite{montgomery2002tour}, theorem 2.4.2). As the approximation $ \Phi_{ij}(t)= \mathbb{1} + t^2 \left[ X_i,X_j \right] + O(t^3)$ has the coefficient $ t^2 $ that is always positive, we can not move in the negative $ [X_i,X_j] $ direction. To avoid this, we define 
	$$ \Psi_{i j}(t)=\left\{\begin{array}{ll}{\left[\Phi_{i}(t), \Phi_{j}(t)\right]} & t \geq 0 \\ {\left[\Phi_{j}(t), \Phi_{i}(t)\right]} & t<0,\end{array}\right. $$ 
	so that
	$$\Psi_{i j}(t)=\left\{\begin{array}{ll}I+t^{2} X_{i j}+O\left(t^{3}\right) & t \geq 0 \\ I-t^{2} X_{i j}+O\left(t^{3}\right) & t<0.\end{array}\right.$$
This problem occurs whenever the number $ w_i $ associated to the flow $ \Phi_I $ of $ Y_i $ is even. To solve this in general, we set
$$\Psi_{I}(t)=\left\{\begin{array}{ll}
\Phi_{I}(t) & t \geq 0 \\
{\left[\Phi_{J}(t), \Phi_{i_{1}}(t)\right]} & t<0.
\end{array}\right.$$
If $ w_i $ is odd, we keep $ \Psi_I=\Phi_I, $ and we relabel $ \Psi_I $ as $ \Psi_i $ accordingly. Now, we introduce the functions
$$\sigma_{i}(t)=\left\{\begin{array}{ll}
t^{w_{i}} & w_{i} \text { even, } t \geq 0 \\
-t^{w_{i}} & w_{i} \text { even, } t<0 \\
t^{w_{i}} & w_{i} \text { odd }
\end{array}\right.
$$
to simplify the notation of the approximation
$$ \Psi_I(t)= \mathbb{1}+ \sigma_i(t) Y_i + O(t^{w_i+1}). $$ 
Define the map $ F: \mathbb{R}^m \rightarrow {M} $ as $ F(t_1,\dots,t_m) = \left( \Psi_m(t_m) \circ \cdots \circ \Psi_1(t_1)\right)(p), $ and let $ y_i $ be linearly adapted coordinates for which the $ dy_i $ are dual to the $ Y_i $ of the basis of the tangent space at the base point $ p. $ Then, in coordinates,

$$ F_i(t_1,\dots,t_m) = \sigma_i(t_i) + o(t_i^{w_i}) = \pm t_i^{w_i} + o(t_i^{w_i}), $$ 
where the error $ o(t_i^{w_i}) $ corresponds to the composition of the previous $ \Psi_1(t), \dots,\Psi_{i-1}(t) $ flows evaluated in the big $ O- $errors of the previous sequential arguments. It remains to understand and bound these error terms, and for that we introduce the new variables $ s_i=\sigma_i(t), $ so that $ F_i(t_1,\dots,t_m)= s_i + o(s_i). $  

The map $ \sigma=(\sigma_1,\dots,\sigma_m) $ is a homeomorphism between neighborhoods of $ 0 $ in $ \mathbb{R}^m, $ so let $ S $ be the inverse of $ \sigma $ that is given by $ S=(s_1,\dots,s_m), $ where $ s_i(t_i)=\pm |t_i|^{1/w_i}. $ Then, it follows that
$$ y\circ F\circ S (s_1,\dots,s_m) = (s_1,\dots,s_m) + o(|s|), $$ 
from where we deduce that $ F\circ S$ is differentiable at the origin because of the differentiability of both $ y $ and $ y\circ G\circ S $, and its derivative is the identity in the $ s-y $ coordinates, so it is also $ C^1 $ near $ 0. $ We will proceed applying the inverse function theorem to invert $ F\circ S $ in a neighborhood of $ p. $ 

Write $ F\circ S(s_1,\dots,s_m) $ in coordinates as $ (y_1,\dots,y_m).$ Then, there exists a constant $ \epsilon_0 $ and constants $ c=c(\epsilon_0), \ C=C(\epsilon_0) $ such that $ c|s_i| \leq |y_i(s_1,\dots,s_m)|  \leq C|s_i|$ whenever $ |s_i|\leq \epsilon_0. $ Apply the constraint $ |s_i|\leq \epsilon^{w_i} $ to the $ s_i. $ It is clear that the inverse image of the point set $ |s_i|\leq \epsilon^{w_i} $ under the map $ S $ is the $ \epsilon- $cube box $ \operatorname{Box}(\epsilon)= \left\{ (t_1,\dots,t_m)\ | \ |t_i|\leq \epsilon \right\},  $  so that applying $ F $ to the $ \epsilon- $cube gives
$$ \operatorname{Box}^{w}(c\epsilon) \subset F( \operatorname{Box}(\epsilon) ) \subset \operatorname{Box}^w(C\epsilon).   $$ 
Each curve in $ F( \operatorname{Box} (\epsilon) )$ is the endpoint of a horizontal curve starting at $ p $ whose length is less than $ M\epsilon $, where $ M=M(w) $ counts the number of concatenations involved in $ F. $ Consequently,
$$ F( \operatorname{Box} (\epsilon)) \subset B(M\epsilon, p), $$ 
from where we get that $ \operatorname{Box}^w (c\epsilon)\subset B(\epsilon,p). $ 
\end{proof}
The remaining containment in the Ball-Box theorem will not be proved in this text, as the proof of Chow's theorem only requires the first containment. The proof of the remaining containment can be found in \cite{montgomery2002tour}, section 2.7.

With the Ball-Box theorem, Chow's theorem can be derived easily.

\begin{thm}[Chow's Theorem]
	If $ \mathcal{H} $ is a bracket-generating distribution on a connected manifold $ M $, then any two points of $ M $ can be connected by a horizontal path.
\end{thm}
\begin{proof} (\cite{montgomery2002tour}, page 52). The containment $ \operatorname{Box}^w(c\epsilon) \subset B(\epsilon,p)$ shows that $ B(\epsilon, p) $ is a neighborhood of $ p $, which means that the accesible points from $ p $ through horizontal curves form a neighborhood of $ p. $ Let $ q\in M $ be another arbitrary point on the connected manifold, and take a smooth curve $ \gamma $ connecting $ p $ and $ q. $  

	The image of $ \gamma $ is compact, so we can cover it with finitely many succesive box neighborhoods, where the Ball-Box theorem holds. Denote these neighborhoods as $ U_1,\dots,U_n, $ with each one of these boxes centered on succesive points $ p_i $ along the image of $ \gamma, $ and $ p_1=p, $ $ p_n=q. $ Moreover, these open sets can be chosen in orden to satisfy $ U_i\cap U_{i+1}\neq\emptyset, $ so that there exists $ q_i \in U_i\cap U_{i+1}. $ By the Ball-Box theorem, we have paths connecting $ p_i $ with $ q_i, $ and $ q_i $ with $ p_{i+1}. $ Concatenating these paths yields a piecewise horizontal path connecting $ p $ and $ q. $ 
	
\end{proof}
\begin{ex}[Cartan's Distribution]\label{ex:cartan_distribution}
	Consider the distribution over $ \mathbb{R}^3 $ determined by the 1-form $\omega =dy- zdx $, or in dual manner, by the smooth vector fields $ \partial /\partial x + z \partial / \partial y, \partial/\partial z. $ From its definition it is clear that Cartan's distribution is of rank 2, so we can not know beforehand if any two pair of points can be connected through a horizontal curve. Nevertheless, as 
	$$ \left[ \frac{\partial}{\partial z}, \frac{\partial}{\partial x}+z \frac{\partial}{\partial y}    \right] = \frac{\partial}{\partial y}  $$ 
	and $ T \mathbb{R}^3 = \operatorname{span}\{  \partial/\partial x + z \partial / \partial y, \partial/\partial z, \partial/\partial y\} $, Cartan's distribution is bracket-generating, so by Chow's theorem any two points in $ \mathbb{R}^3 $ can be connected by a horizontal path.

	The horizontal path whose existence is guaranteed by Chow's theorem can be found explicitly in the following way. Let $ (x_1,y_1,z_1), (x_2,y_2,z_2)\in \mathbb{R}^3 $ be distinct points. Their respective projections to $ \mathbb{R}^2 $, $(x_1, y_1), (x_2,y_2),$ can be connected through an integral curve of $ \partial/\partial x+ z\partial/\partial y, $ for a given $ z\in \mathbb{R}^3, $ given that $ x_1\neq x_2. $  Therefore, a horizontal curve that connects $  (x_1,y_1,z_1)$, $(x_2,y_2,z_2)$ is the absolutely continuous curve that starts at $ (x_1,y_1,z_1) $, goes to $ (x_1,y_1,z) $ through a vertical segment, from where it goes to $(x_2,y_2,z)  $ through an integral curve of $ \partial/\partial x+ z \partial/\partial y $, and it finally goes to $ (x_2,y_2,z_2) $ through a vertical segment. If $ x_1=x_2=x, $ we can connect $ (x,y_1,z_1) $ with $ (x,y_2,z_2) $ connecting $(x, y_1,z_1)$ with $ (\tilde x, y_2, z_1) $ (we assume without loss of generality that $ z_1\neq 0 $), to connect the latter with $ (\tilde x, y_2, 0), $ which can be connected with $ (x, y_2, 0), $ and this point can be connected with $ (x, y_2,z_2). $     
\end{ex}

\begin{ex}[Martinet Distribution (\cite{montgomery2002tour}, p. 44)]
	Consider the distribution on $ \mathbb{R}^3 $ determined by the 1-form $ \omega = dz-y^2dx, $ or equivalently, by the smooth vector fields $ \partial/\partial x+y^2\partial/\partial z, \partial/\partial y $. As the Cartan's distribution, we can not know beforehand if two pair of points can be connected through a horizontal curve given that the distribution is of rank $ 2. $ Even so, the Lie bracket of the two vector fields that generate this distribution is  

	$$ \left[ \frac{\partial }{\partial x} + y^2 \frac{\partial }{\partial z} , \frac{\partial }{\partial y}  \right] =-2y \frac{\partial }{\partial z}, $$ 
	and 
	$$ \left[\left[ \frac{\partial }{\partial x} + y^2 \frac{\partial }{\partial z} , \frac{\partial }{\partial y}  \right], \frac{\partial }{\partial y} \right] = -2 \frac{\partial }{\partial z}.  $$ 
	Given that $ T \mathbb{R}^3 = \operatorname{span} \left\{ \partial/\partial x+ y^2\partial/\partial z, \partial/\partial y, -2\partial/\partial z \right\},  $ the distribution is bracket-generating, and by Chow's theorem any two points in $ \mathbb{R}^3 $ can be connected by a horizontal path. In this case the horizontal path that connects two arbitrary points in $ \mathbb{R}^3 $ can be found following the same procedure of example \ref{ex:cartan_distribution}.
\end{ex}

\begin{ex}[Contact Distribution on $ \mathbb{R}^{2n+1} $, (\cite{montgomery2002tour}, p. 39)]
	The contact distribution on $ \mathbb{R}^{2n+1} $ generalizes the Cartan's distribution of example \ref{ex:cartan_distribution} when $ n=1 $. Let $ (x_1,\dots,x_n,y_1,\\\dots, y_n,z) $ be coordinates on $ \mathbb{R}^{2n+1} $. The contact distribution is generated by the 1-form $ \omega = dz+ x_i dy_i$, or equivalently by the vector fields $ \partial/ \partial y_i, \partial/ \partial x_i+ y_i \partial/\partial z, $ for $ i=1,\dots, n. $ The rank of this distribution is $ 2n, $ but as 
	$$ \left[ \frac{\partial }{\partial y_i} , \frac{\partial }{\partial x_i} + y_i \frac{\partial }{\partial z}  \right] = \frac{\partial }{\partial z},  $$ 
	this distribution is bracket-generating, and by Chow's theorem any pair of point in $ \mathbb{R}^{2n+1} $ can be connected through an horizontal curve.
\end{ex}

\begin{rem}[\cite{montgomery2002tour}, p. 45]
	The converse of Chow's theorem is false in general. That is, if any two points in $ (M,\mathcal{H}) $ can be connected through horizontal curves, it is not true that $ \mathcal{H} $ is bracket-generating. Even so, the converse holds for analytic distributions. A counterexample of  the converse of Chow's theorem can be found on (\cite{montgomery2002tour}, p. 45).
\end{rem}
\section{Sub-Riemannian metrics on Bundles}%
\label{sec:metrics_on_bundles}
\subsection{Ehresmann connection}%
\label{sub:ehresmann_connection}


Let $ \pi : Q \rightarrow {M} $ be a submersion, which means that for all $ q\in Q $, $ d\pi_q : T_q Q \rightarrow {T_{\pi(q)}}M $ is a surjective map. The fiber $ Q_m = \pi^{-1}(m) $, with $ m=\pi(q) $ is a submanifold because $ m $ is a regular value of $ \pi. $  

\begin{df}
	Given a submersion $ \pi:Q \rightarrow {M}, $ the \textit{vertical space at $ q\in Q $}, denoted as $ V_q $, is the tangent space to the fiber $ Q_m, $ with $ m=\pi(q), $ that is,  
	$$ V_q = \operatorname{Ker}(d\pi_q) = T_q Q_m.  $$ 
\end{df}

The collection of vertical spaces is a distribution $ V \subset TQ $ that assigns to each $ q\in Q $ the space $ V_q. $ The distribution is by construction integrable, and its integral manifolds are the fibers $ Q_m, $ $ m\in \pi(Q). $ 

\begin{df}[\cite{montgomery2002tour}, definition 11.1.1]
	A \textit{connection for a submersion} $ \pi:Q \rightarrow {M} $ is a distribution that is everywhere transverse to the vertical one, that is,  
	$$ V_q \oplus \mathcal{H}_q = T_q Q,\ \text{for all } q\in Q. $$ 
\end{df}

The restriction of $ d\pi_q $ to $ \mathcal{H}_q $ is a linear isomorphism between $ \mathcal{H}_q $ and $ T_{\pi(q)} M $  because $ d\pi_q $ is surjective, and by the isomorphism theorem we have that $ \mathcal{H}_q\cong T_{\pi(q)} M $. 

\begin{df}\label{df:ind_sub_struc}
If $ M $ is endowed with a metric $ g $, we can use the previous linear isomorphism to pull the inner product back to the horizontal distribution $ \mathcal{H}$: the sub-Riemannian structure $ (\mathcal{H},\langle \cdot, \cdot\rangle) $ induced by the Riemannian structure $ (M,g) $ is given by
$$ \langle v,w \rangle_q = g_{\pi(q)} \left( d\pi_q(v), d\pi_q(w) \right), \text{ for all }q\in Q \text{ and } v,w\in \mathcal{H}_q.   $$ 
This sub-Riemannian metric varies smoothly with $ q\in Q $ (\cite{montgomery2002tour}, page 194), and is referred to as the \textit{sub-Riemannian structure induced} over $ Q $ by the submersion $ \pi: Q \rightarrow M $ and the Riemannian metric over $ M. $ 
\end{df}
\begin{df}
	The \textit{horizontal lift} of a curve $ c: I \rightarrow {M} $ starting at $ m\in M $ is defined as the unique curve $ \gamma : I \rightarrow {Q} $ that is tangent to $ \mathcal{H}, $ starts at $ q\in Q_m, $ and projects to $c$, that is, $ \pi\circ\gamma = c. $ 
\end{df}

The uniqueness of the horizontal lift follows from the fact that $ \gamma: I \rightarrow Q $ is the solution of the initial value problem
$$ \frac{d\gamma(t)}{dt} = d\pi^{-1}_{c(t)} \left( \frac{dc(t)}{dt}  \right),\quad \gamma(0)=q.  $$ 
\begin{ex}[Canonical projection from $ \mathbb{R}^{m+n} $ to $ \mathbb{R}^m $  ]\label{ex:can_proj}
	\sloppy	Consider the canonical projection $ \pi: \mathbb{R}^{m+n} \rightarrow \mathbb{R}^m $ that maps the first $ m $-coordinates of a point in $ \mathbb{R}^{m+n} $  to $ \mathbb{R}^m. $ This map is a submersion, and its vertical space at a point $ q\in \mathbb{R}^{m+n} $ is $ V_q = \left\{ (0,\dots,0,v_1,\dots,v_n) : v_1,\dots,v_n\in \mathbb{R}  \right\} \cong \mathbb{R}^n. $ For a connection for this submersion we can take $ \left\{ (v_1,\dots,v_m, 0,\dots, 0): v_1,\dots,v_m\in \mathbb{R} \right\}\cong \mathbb{R}^m.  $ Given an arbitrary curve $ c: I \rightarrow \mathbb{R}^m, $ starting at $ \boldsymbol{p}= (p_1,\dots,p_m), $ its horizontal lift passing through the point $ (p_1,\dots,p_m,q_1,\dots,q_n)\in \pi^{-1}( \boldsymbol{p} ) $ is the curve $ \gamma: I \rightarrow \mathbb{R}^{m+n} $, $ t\mapsto (c(t),q_1,\dots,q_n). $   
\end{ex}
\begin{rem}
	The connection $ \mathcal{H} $ is called \textit{complete} (or \textit{Ehresmann connection})  if every smooth curve $ c: I \rightarrow {M} $ has a horizontal lift.
\end{rem}

\begin{prop}
	The induced sub-Riemannian structure satisfies the following properties:
	\begin{enumerate}
		\item The sub-Riemannian length of a horizontal path on $ Q $ equals the Riemannian length of its projection to $ M. $ 
		\item The horizontal lift of a Riemannian geodesic in $ M $ is a sub-Riemannian geodesic in $ Q. $ 
		\item The projection $ \pi $ is distance decreasing, that is, $ d_M(\pi(q_1), \pi(q_2))\leq d_Q(q_1,q_2), $ for all $ q_1,q_2\in Q. $ 
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item Let $ \gamma: I \rightarrow {Q} $ be a horizontal path to $ \mathcal{H} $ starting at $ q\in Q. $ Then, its longitude is 

		$$\ell_Q(\gamma) = \int_0^1 ||\dot{\gamma} (t) ||_{Q} dt = \int_0^1 || d\pi_{\gamma(t)}(\dot{\gamma}(t))||_M dt,$$ 

		having in mind that $d\pi_{\gamma(t)}$ induces an isomorphism between $ \mathcal{H}_{\gamma(t)} $ and $ T_{\pi(\gamma(t))} M,$ and this isomorphism determines the induced sub-Riemannian structure over $ Q. $ As $c=\pi\circ\gamma$ and $ d/dt(\pi\circ\gamma) = d\pi_{\gamma(t)}(\dot{\gamma}(t)) $, we have that $ \ell_Q(\gamma)=\ell_M(c). $  

		\item Suppose that $ c: I \rightarrow {M} $ is a Riemannian geodesic, and let $ \gamma: I \rightarrow {Q} $ be its respective horizontal lift. Take any other horizontal curve $ \eta: I \rightarrow {Q} $ with the same endpoints that $ \gamma. $ Then, by the first affirmation of this proposition and the fact that $ c $ is a geodesic, we have
			$$ \ell_Q(\eta) = \ell_M(\pi\circ \eta) \geq \ell_M(c) = \ell_Q(\gamma),  $$ 
		from where we get that $ \gamma: I \rightarrow {Q} $ is a sub-Riemannian geodesic.

	\item Let $ q_1,q_2\in Q. $ If $ d_Q(q_1,q_2) = \infty $ the result is immediate. Else, let $ \left\{ \gamma_i \right\}_{i\in \mathbb{N}} $ be a minimizing sequence of $ d_Q(q_1,q_2). $ Now consider the sequence of projected curves $ \left\{ \pi\circ\gamma_i \right\}_{i\in \mathbb{N}}, $ from where there are two possibilities: if this last sequence is minimizing, $ d_Q(q_1, q_2) = d_M(\pi(q_1), \pi(q_2)),$ as $ \ell_Q(\gamma_i)=\ell_M(\pi\circ\gamma) $;  if it is not minimizing,  $d_Q(q_1,q_2) = \lim_{i \rightarrow \infty} \ell_Q(\gamma_i) = \lim_{i \rightarrow \infty} \ell_M(\pi\circ\gamma_i) > d_M(\pi(q_1),\pi(q_2))$ by definition. Therefore, $ d_Q(q_1,q_2)\geq d_M(\pi(q_1),\pi(q_2)).$
	\end{enumerate}
\end{proof}

\begin{df}\label{df:compatible}
	A Riemannian metric on $ Q $ is said to be \textit{compatible} with the induced sub-Riemannian metric if the algebraic splitting $ TQ = V \oplus \mathcal{H} $ is an orthogonal decomposition with respect to the Riemannian metric on $ Q$.  
\end{df}

\begin{rem}
Thanks to the orthogonal algebraic splitting, a compatible Riemannian metric is determined by its restriction to $ V, $ and the induced sub-Riemannian structure restricted to $ \mathcal{H} $. Equivalently, we can take a Riemannian metric $ g_Q $ on $ Q. $ Let $ V_q^\perp $ be the orthogonal complement of the vertical space $ V_q $ in $ q\in Q $ with respect to the Riemannian metric, and set $ \mathcal{H}_q=V_q^\perp. $ The Riemannian metric defines inner products in $ V_q^\perp $  and $ T_mM, $ being defined in the first as the restriction of the Riemannian metric, and in the second is given by the metric and the isomorphism $ \mathcal{H}_q\cong T_mM. $ Nevertheless, this inner product on $ T_mM $ can depend on the point $ q\in Q_m $. If that is the case, we cannot construct a Riemannian metric on $ M, $ as there is no consistent way to choose which $ q\in Q_m $ is going to be used to define the inner product (\cite{montgomery2002tour}, page 195).
\end{rem}

\begin{df}\label{def:riemannian_submersion}
	Given a Riemannian manifold $ (Q, g_Q),$ and a submersion $ \pi: Q \rightarrow {M}
	$, we say that the pair $ (\pi, g_Q) $ is a \textit{Riemannian submersion} if for every $ m\in M $ and $ q\in Q_m $,  the isomorphism $ d\pi_q |_{\mathcal{H}_q} $ is an isometry between $ \mathcal{H}_q $ and $ T_m M$. 
\end{df}
\begin{ex}
	Note that the canonical projection $ \pi : \mathbb{R}^{m+n} \rightarrow \mathbb{R}^m $ given in example \ref{ex:can_proj} is a Riemannian submersion if $ \mathbb{R}^{m+n} $ is endowed with the usual metric, that is, the metric that arises Euclidean geometry.
\end{ex}
\subsection{Metrics on Principal Bundles}%
\label{sub:metrics_on_principal_bundles}

\begin{df}[\cite{lee2003introduction}, page 268]
	Let $ M, G, Q $ be manifolds. A \textit{(locally trivial) fiber bundle} over $ M $ with fiber $ G $ is a manifold $ Q, $ together with a smooth surjective map $ \pi: Q \rightarrow {M}
$ with the property that for each $ x\in M $ there is a neighborhood $ U $ of $ x $ and a diffeomorphism $ \phi:\pi^{-1}(U) \rightarrow {U\times G,}
 $ called a local trivialization of $ Q $ over $ U, $ such that the following diagram commutes:
 \begin{center}
 	\begin{tikzcd}
\pi^{-1}(U) \arrow[rd, "\pi"'] \arrow[rr, "\phi"] &   & U\times G \arrow[ld, "\operatorname{proj}_U"] \\
                                                  & U &                                              
\end{tikzcd}
 \end{center}
 $ Q $ is called the \textit{total space of the bundle}, $ M $ the \textit{base}, $ G $ the \textit{standard fiber},  and $ \pi $ the \textit{projection}.   
\end{df}

The following definition will require some definitions related to Lie group actions over manifolds, that we will cover next. 

\begin{df}
For a Lie group $ G $ and a manifold $ Q, $ a \textit{group right action or an action on the right} is a smooth application $ \alpha:  Q\times G \rightarrow Q $, denoted by $ \alpha(q,g) = q \cdot g, $ such that:

\begin{enumerate}
	\item For all $ q\in Q, $ $ q\cdot e = q $, where $ e $ is the identity element of $ G. $   
	\item For all $ g,h\in G $ and $ q\in Q $, $ (q\cdot g) \cdot h =q\cdot(gh). $ 
\end{enumerate}

\end{df}
If this action exists, we say that $ G $ acts on $ Q $ through $ \alpha. $ As a consequence of this definition, we can see that the map $ \alpha_g: Q \rightarrow Q: \ q\mapsto q\cdot g$ is a diffeomorphism for all $ g\in G $, as it is smooth and its inverse, $ \alpha_{g^{-1}}, $ is smooth too.

We say that the action $ \alpha $ \textit{is free (or that $ G $ acts freely on $ Q $)} if for every $ q\in Q $, $ q\cdot g =q$   implies that $ g=e. $ The \textit{orbit $ G_q $ of the action}  for a point $ q\in Q $  is defined as the image of the restriction $\alpha|_{\{q\}\times G},$  that is, $ G_q := \left\{q\cdot g \ | \ g\in G \right\}. $ We can construct an equivalence relation over $ Q $ in the following way: $ q\sim p $ if and only if $ G_p = G_q $. The set of all equivalence classes is denoted as $ Q/G $, and is known as the \textit{orbit space of the action}.     

\begin{rem}
The orbit space of an action is not, in general, a manifold, but because of the \textit{quotient manifold theorem} (see \cite{lee2003introduction}, theorem 21.10), it is sufficient to have a free, proper and smooth action in order to guarantee that $ Q/G $ is a topological manifold.
\end{rem}
\begin{df}\label{df:principalGbundle}
	The submersion $ \pi: Q \rightarrow M$  is called a \textit{principal $ G $-bundle} if its is a fiber bundle whose fiber $ G $ is a Lie group, and this group acts on $ Q $ in such a way that the following properties hold:
	\begin{enumerate}
		\item $ G $ acts freely on $ Q $.
		\item The action orbits are the fibers of $ \pi:Q \rightarrow {M} $, that is, for all $ m\in M, $ $ \pi^{-1}(m) = G_q, $ with $ q\in Q_m. $ 
		\item For each point $ m\in M, $ there exists a neighborhood $ U\ni m $ and a local trivialization $ \varphi: U\times G \rightarrow \pi^{-1}(U)$ equivariant with the action, that is,
			$$ \varphi(q, g\cdot h)=\varphi(q,g)\cdot h  $$ 
			for every $ q\in U, $ $ g,h\in G. $ 
	\end{enumerate}
\end{df}

From Definition \ref{df:principalGbundle} we can conclude that if $ \pi: Q \rightarrow M $ is a principal $ G- $bundle, then $Q/G  $ is a topological manifold, and $M $ is homeomorphic to $ Q/G $ (endowed with the quotient topology). This homeomorphism $ \phi: M \rightarrow {Q/G}$  is given by $ \phi(m)=[q], $ with $ \pi(q)=m. $ 

\begin{df}[\cite{montgomery2002tour}, p. 196]
	Given a principal $ G $-bundle $ \pi: Q \rightarrow M, $ we say that a horizontal distribution $ \mathcal{H} $ is a \textit{connection for this principal $ G $-bundle} if it is a connection for $ \pi $, and the $ G $-action on $ Q $ preserves the horizontal distribution $ \mathcal{H} $ in the sense that $ \mathcal{H}_{q\cdot g} = d(\alpha_g)_q (\mathcal{H}_q), $ for all $ q\in Q, $ $ g\in G $. In this case, we say that the pair $ (\pi$, $ \mathcal{H}) $ is a \textit{principal $ G $-bundle with connection}. 

\end{df}

\begin{rem}
A connection for any principal $ G $-bundle is an Ehresmann connection, as it is stated in the following result. 
\end{rem}
\begin{prop}[\cite{kobayashi1963foundations}, proposition 3.1]\label{prop:comp_bundle}
	Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle with connection and $ c: I \rightarrow M $ a smooth curve. For an arbitrary $ q\in Q_{c(0)}= G_q $, there is a unique horizontal lift $ \gamma: I \rightarrow Q $ of $ c $ ($\pi\circ\gamma =c$, $ \dot{\gamma}(t)\in \mathcal{H}_{\gamma(t)} $ for all $ t\in I $) that starts from $ q $.    	
\end{prop}

\begin{df}[\cite{montgomery2002tour}, definition 11.2.1]
	Let $ M $ be endowed with a Riemannian metric. A sub-Riemannian metric $  \langle\cdot,\cdot\rangle $ defined on the sub-bundle $ \mathcal{H} $  of the tangent space of the total space of the principal $ G $-bundle $ \pi: Q \rightarrow {M}
	$ is called a \textit{metric of bundle type} if it is an induced sub-Riemannian structure with respect to the submersion $ \pi $ and the metric on $ M $  (see Definition \ref{df:ind_sub_struc}).
\end{df}

\subsection{Examples of principal $ G $-bundles}%
\label{sub:examples_of_principal_g_bundles}

\subsubsection{Trivial bundle}%
\label{ssub:projection_of_cartesian_product_of_manifolds}

Let $ M$ be a manifold and $ G $ a Lie group. Define the projection onto the first factor $ \pi: M\times G \rightarrow M. $ It is clear that this map is surjective and a submersion. Moreover, it is a fiber bundle, whose local (global) trivialization is the identity map $ \iota : M\times G \rightarrow M\times G $.   

If we define the action $ \alpha: (M\times G) \times G \rightarrow M\times G $ as $ ((p, g),q)\mapsto (p,gq)  $, it is clear that $ G $ acts freely on $ M\times G $, $\iota(p, gh) = \iota(p,g)\cdot h $ (the local trivialization is equivariant with respect to the action) and $ \pi^{-1}(p) = \left\{ p \right\}\times G = G_{(p,g)} $, so that $ \pi $ is a principal $ G $-bundle. A connection for this bundle is the distribution $ \mathcal{H}_{(p,g)}= \operatorname{Ker} d\tilde{\pi}_(p,g)\subset T(M\times G) $, with $ \tilde{\pi}:M\times G \rightarrow G $ the projection onto the second factor.
\subsubsection{Hopf Fibration}%
\label{ssub:hopf_fibration}

All rotations in $ \mathbb{R}^3 $ can be expressed using quaternions. The set of quaternions is denoted as $ \mathbb{H} := \{ a+bi+cj+dj$  $|$  $a,b,c,d\in \mathbb{R} \}, $ and in it we can define sum and product operations. The sum of two quaternions $ a_1+b_1 i +c_1 j  + d_1k $, $ a_2+b_2 i +c_2 j  + d_2k $ is $ (a_1+a_2)+(b_1+b_2)i+(c_1+c_2)j+(d_1+d_2)k. $ The product is defined in order to satisfy the distributive property with respect to the sum, and it also satisfies the following rules: 
$$ i^2=j^2=k^2=-1, \quad ij=-ji=k, jk=-kj=i, ki = -ik=j.  $$ 
In analogy with the complex plane and its isomorphism with $\mathbb{R}^4$, we define the norm of $ z= a+bi+cj+dk $ as $ |z|=\sqrt{a^2+b^2+c^2+d^2}, $ and the conjugate of $ z $ as $ z^* = a-bi-cj-dk. $ Moreover, every quaternion $ z\neq 0 $ has a multiplicative inverse, given by $ z^{-1} = z^*/|z|^2. $ One remarkable property of quaternions is the relation $ |z_1 z_2| = |z_1||z_2|. $  Every rotation around an axis given by a vector $ \vec{v}=(b,c,d) $ and an angle $ \theta $ can be identified with an unitary quaternion $r = a+bi+cj+dk$ ($|z|=1$),  where $ \theta = 2\arccos(a) $ (see \cite{lyons2003elementary}, page 6). This rotation $ R_r: \mathbb{R}^3 \rightarrow\mathbb{R}^3 $ is given by $ x\mapsto rxr^{-1}= rxr^*$, and $ x $ identified as a pure quaternion, that is, $ x=x_1i+x_2j+x_3k. $ To show explicitly that this map is the desired rotation, one can first show that this linear map preserves norm and the vector $ bi+cj+dk $, that is, it is an eigenvector with eigenvalue 1, so it must be a rotation with respect the axis given by $ (b,c,d) $. The idea of the proof that the rotation angle is $ 2\arccos(a) $ can be found in \cite{lyons2003elementary}, page 6, investigation step 3. 

The set of all unitary quaternions is $ \mathbb{S}^3 $, so that $ \mathbb{S}^3 $ acts on $ \mathbb{R}^3 $ via rotations. The Hopf projection is defined as the map $ \pi: \mathbb{S}^3 \rightarrow \mathbb{S}^2 $ that sends the point $ (1,0,0) $ (identified as the quaternion $ i $)   to its respective image after rotating $ \mathbb{R}^3 $ with the associated quaternion, as an element of $ \mathbb{S}^3 $. That is, $ \pi(a,b,c,d) = R_r(1,0,0), $ where $ r=a+bi+cj+dk. $  The function $ \pi $ previously defined is surjective, as every point $ x\in\mathbb{S}^2 $ can be reached from $ (1,0,0) $ through an adequate rotation. Explicitly, it suffices to take a normal vector to both $ (1,0,0), x $ as the axis of rotation, and the angle of rotation is the angle between both vectors. 

	If we identify $ \mathbb{R}^4=\mathbb{C}\times \mathbb{C} $ and $ \mathbb{R}^3= \mathbb{R}\times\mathbb{C}  $, Hopf projection from $ \mathbb{S}^3= \{ (z_1,z_2)\  |$ $ \ z_1,z_2\in \mathbb{C}, \ |z_1|^2+|z_2|^2=1 \} $ to $ \mathbb{S}^2 = \{ (x,z)\ | \ z\in \mathbb{C},\ x\in \mathbb{R},\ |z|^2+$ $x^2=1 \} $  can be written as $ \pi: \mathbb{S}^3 \rightarrow { \mathbb{S}^2},$ $ \pi(z_1,z_2) =(|z_1|^2-|z_2|^2, 2z_1z_2^* ),$ because writing explicitly $ rir^{-1} $ with $ r=a+bi+cj+dk $ gives $ (a^2+b^2-c^2-d^2)i+2(ad+bc)j+2(bd-ac)k. $    In this form one can show that this map is a submersion analyzing the minors of the jacobian matrix in cartesian coordinates (see \cite{linintroductory}, proof of theorem 3.11).

	To recognize the fibers of this submersion, notice that $ \pi^{-1}(1,0) = \left\{ (w_1,0) \ | \ |w_1| =1 \right\} = \left\{ (e^{i\theta},0) \ | \ \theta\in (0,2\pi]  \right\} $. Now, in quaternion notation, if $ s,r\in \pi^{-1}(x), $ $ rir^{-1} = sis^{-1}=x $, that is, $ (s^{-1}r)i(r^{-1}s) = i $. Then, $ s^{-1}r \in \pi^{-1}(1,0), $ and $ r= se^{i\theta}, $ so $ \pi^{-1}(x) = \left\{ re^{i\theta}\ | \ \theta\in (0,2\pi] \right\} $, and each fiber is diffeomorphic to $ \mathbb{S}^1. $        

	With this, $ \mathbb{S}^3 $ can be seen as the disjoint union of these circles, and endowing this disjoint union with the standard manifold structure of $ \mathbb{S}^3 $, we identify $ \mathbb{S}^2 = \mathbb{C}P^1$, and take the open sets $ U_i= \left\{ \left[ z_0 : z_1 \right]\ | \ z_i\neq 0 \right\}$, with $ i=0,1. $ The local trivializations are (see \cite{luke2013vector}, page 68) $ \varphi_i: U_i \times \mathbb{S}^1 \rightarrow \pi^{-1}(U_i), $ $$ \varphi_i([z_0:z_1], \lambda) = \left( \frac{\lambda}{\sqrt{1+|\omega_i|^2}}, \frac{\lambda\omega_i}{\sqrt{1+|\omega_i|^2}}   \right), $$ with $ \omega_0=z_1/z_0 $ and $ \omega_1 = z_0/z_1. $ Now, we define an action $ \alpha: \mathbb{S}^3\times \mathbb{S}^1 \rightarrow { \mathbb{S}^3}
	$, given by $ \alpha(z_1,z_2,\lambda) = (z_1\lambda, z_2\lambda), $ where $ (z_1,z_2)\in \mathbb{S}^3\subset \mathbb{C}^2 $ and $ \lambda\in \mathbb{S}^1 \subset \mathbb{C}. $ This action acts freely on $ \mathbb{S}^3, $ and its orbits coincide with the fibers of $ \pi, $ so that $ \mathbb{S}^3/ \mathbb{S}^1 \cong \mathbb{S}^2. $ From this point it is clear that the Hopf bundle is a fiber bundle, and its local trivializations are equivariant with respect to the action, as $ \varphi_i([z_0:z_1], \lambda_1\lambda_2) = \varphi_i([z_0:z_1], \lambda_1)\lambda_2. $ Therefore, $ \pi: \mathbb{S}^3 \rightarrow { \mathbb{S}^2} $ is a principal $ \mathbb{S}^1$-bundle.

	To find a connection for this submersion, we recall that, by the preimage of regular value theorem, $ \pi^{-1}(m) = \mathbb{S}^1_q $ is a submanifold of $ \mathbb{S}^3 $, of dimension $ \operatorname{dim}( \mathbb{S}^3)- \operatorname{dim}( \mathbb{S}^2) = 1,  $ and its tangent space (vertical space of the submersion) $ T_q \mathbb{S}^1_q $ is $ \operatorname{Ker}(d\pi_q)  $. Now, if $ \mathbb{S}^3 $ is endowed with the standard Riemannian structure, there is only one connection compatible with the metric, and is given by $ \mathcal{H}_q = \operatorname{Ker}(d\pi_q)^\perp. $ The vector that determines $ \operatorname{Ker}(d\pi_q)  $ can be found using the action if we consider the tangent vector of the curve $ \gamma: (-\epsilon, \epsilon) \rightarrow \mathbb{S}^3, $ $ t\mapsto \gamma(z_1,z_2, e^{it})=(z_1e^{it},z_2e^{it}) $ at $ t=0 $, where $ q=(z_1,z_2). $ With this, $ \operatorname{Ker}(d\pi_q) = \langle(iz_1, iz_2)\rangle,  $ and the connection at $ q\in \mathbb{S}^3 $,  $ \mathcal{H}_q $, will be the orthogonal complement (with respect to $ \mathbb{R}^4 $ provided with the usual norm) of the vector space $ \langle(iz_1,iz_2), (z_1,z_2)\rangle  {= \langle(x_1,y_1,x_2,y_2), (-y_1,x_1,-y_2,x_2)\rangle}$, that is, $ \mathcal{H}_q = \langle(x_2,-y_2,-x_1,y_1),(y_2,x_2,-y_1,-x_1)\rangle, $ where $ q=(x_1+iy_1, x_2+iy_2). $   

	This principal $ \mathbb{S}^1$-bundle has connection because the kernel of $ d(\pi\circ \alpha_g)_q $ is the same of $ d\pi_q, $ as $ d\alpha_g $ is an isomorphism. Therefore, $ d(\alpha_g)_q ( \mathcal{H}_q) = \mathcal{H}_{q\cdot g}, $ and the $ \mathbb{S}^1 $-action preserves $ \mathcal{H}. $ By proposition \ref{prop:comp_bundle}, this connection $ \mathcal{H} $ is complete.  
 
\subsection{Theorem on normal geodesics of bundle type sub-Riemannian metrics}
\label{sub:theorem_on_normal_geodesics}
Before proceeding with one of the principal results on sub-Riemannian geometry and metrics on bundles, we need to recall some definitions and important results of symplectic geometry. Therefore, this subsection is dedicated to the study of these prerequisites and to the statement and proof of the theorem on normal geodesics of bundle type sub-Riemannian metrics. To start with, we define the concept of symplectic structure, and continue to explain the ideas of cotangent bundle and Hamilton's equations.
\begin{df}[\cite{arnol2013mathematical}, section 8A]
	Let $ M $ be an even-dimensional manifold. A \textit{symplectic structure on $ M $ } is a closed non-degenerate differential 2-form $ \omega $ on $ M $, that is, 
	\begin{enumerate}
		\item $ d\omega=0 $,
		\item $\forall \xi \neq 0: \ \omega_m(\xi,\cdot)\neq0 \ (\xi\in T_m M)$, $ \forall m \in M. $  
	  
	\end{enumerate}
	The non-degeneracy condition is equivalent to $ \operatorname{det} \omega_m\neq 0, \forall m\in M $. The pair $ (M,\omega) $ is called a \textit{symplectic manifold}. 
\end{df}

\begin{ex}[Canonical symplectic structure on $ \mathbb{R}^{2n}$]
	Consider $ \mathbb{R}^{2n} $ with coordinates $ (q_1,q_2,\dots,q_n,p_1,p_2,\dots,p_n) $. The 2-form $ \omega = dp_i\wedge dq_i $ is closed and non-degenerate, so that the pair $ ( \mathbb{R}^{2n}, dp_i\wedge dq_i) $ is a symplectic manifold.  
\end{ex}

\begin{df}[\cite{montgomery2002tour}, definition A.4.1]
	Given a symplectic manifold  $ (M,\omega) $, an \textit{observable} is a smooth function $ H: M \rightarrow \mathbb{R}. $ Depending of the context, a given observable can induce some structure on the symplectic manifold, and in these cases the observable will be referred as \textit{Hamiltonian.} 
\end{df}

Historically, the definition of a function over a symplectic manifold receives the name of observable because the physical space has been modeled through history as a manifold, and the dual tangent space of this manifold represents the position and momentum space, which is a symplectic manifold (as will be discussed below). In principle, all observables in a physical phenomena can be calculated with the variables of the dual tangent space of the manifold that represents physical space, and they are functions of the position and momentum. From this fact, a real function over the symplectic space receives the name of observable. Over all the physical observables, one of the most important is the Hamiltonian, as it describes the evolution of the system through Hamilton's equations as a function of time. Thus, a real function over the symplectic manifold that is important in the sense of giving additional structure to the manifold is called Hamiltonian.

\begin{df}[\cite{arnol2013mathematical}, page 203]
	For each vector $ \xi\in T_mM  $ tangent to a symplectic manifold $ (M,\omega), $ we associate a 1-form $ \omega_\xi\in T^*_mM $ by the formula $$ \omega_\xi(\eta)=\omega(\xi,\eta). $$  
\end{df}

This last definition induces an isomorphism between $ T_mM $ and $ T^*_mM $ given by the map $ \xi \mapsto \omega_\xi. $ If $ H: M \rightarrow \mathbb{R} $ is a Hamiltonian, then $ dH = \partial_i H dq^i $ is a differential 1-form on $ M, $ and by the previous isomorphism, at every point $ m\in M $ there is a tangent vector $ (X_H)_m \in T_mM $ such that $ (dH)_m = \omega_{(X_H)_m}. $ 

\begin{df}
	For a given Hamiltonian $ H: M \rightarrow \mathbb{R} $, the vector field $ X_H\in \mathfrak{X}(M) $ that satisfies $$ dH = \omega(X_H, \cdot) $$ is called \textit{Hamiltonian vector field} for $ H $, or \textit{symplectic gradient} of $ H. $ 
\end{df}

From any manifold $ M $ we can construct a symplectic manifold. Suppose that $ M $ is an $ n$-dimensional manifold. $ T^*M= \bigsqcup_{p\in M} T^*_p M$ is then a $ 2n $-dimensional manifold. There is a canonical choice of coordinates for this space, namely, given $ m\in M, $ there is a coordinate chart $ (U_m,\phi) $ on $ M $ such that $ q=\phi(m)=(q_1,\dots,q_n)\in \mathbb{R}^n, $ and for a given 1-form $ \alpha\in T_m^*M,$ in these coordinates we have that $ \alpha=p_i dq^i; $ the cross product of these two coordinate systems in a suitable neighborhood of an element $ \alpha_m\in T^*M $ gives the \textit{canonical coordinates of $ T^*M $}, where the element $ \alpha_m\in T^*M $ has coordinates $ (q^i,p_i) $.

\begin{thm}[\cite{arnol2013mathematical}, page 202]
	The cotangent bundle $ T^*M $ has a natural symplectic structure given in coordinates by $\omega = dq^i\wedge dp_i.$
\end{thm}

\begin{proof}
	Let $ v\in T_\alpha \left( T^*M \right)  $ be a vector tangent to the cotangent bundle at $ \alpha\in T^*_m M. $ If $ \pi:T^*M \rightarrow M $ is the natural projection, the differential $ d\pi : T \left( T^*M \right) \rightarrow TM $ takes $ v $ to $ d\pi(v)=d\pi_\alpha(v), $ which is a vector tangent to $ M $ at $ m. $ We define a 1-form $ \theta $ on $ T^*M $ by the relation $ \theta_\alpha(v)=\alpha(d\pi_\alpha(v)). $ In local coordinates the expression of this form is $ \theta= p_i dq^i, $ and the form $ \omega = d\theta $ is non-degenerate. 
\end{proof}

Given the symplectic structure $ (T^*M, \omega = dq^i\wedge dp_i) $, for a Hamiltonian $ H: T^*M \rightarrow \mathbb{R}, $ there is a vector field $ X_H \in \mathfrak{X}(T^*M) $ such that $ dH = \omega (X_H,\cdot) $. Writing $ X_H $ in coordinates, $ X_H = X_i \partial/\partial q^i + X^i \partial/\partial p_i, $ and evaluating $ \partial/\partial q^j $ and $ \partial/\partial p_j $ in $ dH $ gives  

$$ dH(\partial/\partial q^j) = \frac{\partial H}{\partial q^j} = \omega(X_H, \partial/\partial q^j) = -\omega(\partial/\partial q^j, X_H) = -X^j,$$ 
$$\text{and } dH(\partial/\partial p_j) = \frac{\partial H}{\partial p_j} =\omega(X_H, \partial/\partial p_j)=X_j, $$ 

so that $ X_H = (\partial H/\partial p_j)\partial/\partial q^j - (\partial H / \partial q^j)\partial/\partial p_j $, and its integral curves are solutions of the following system of differential equations:
\begin{equation}\label{eq:hamilton_equations}
 \dot{q^i} = \frac{\partial H}{\partial p_i}, \quad \dot{p_i} =- \frac{\partial H}{\partial q^i}.    
\end{equation}
This system of differential equations is called the \textit{Hamilton equations for $ H $.} Despite this formulation on the cotangent bundle came after Hamilton, this method turns out to be a generalization of Hamiltonian mechanics to symplectic manifolds, as one obtains the classical Hamiltonian equations of the classical mechanics using $ M= \mathbb{R}^n, $ and taking the Hamiltonian as the energy of the system. That is the reason why they are referred as Hamilton equations.

\begin{thm}\label{thm:constantCurves}
The Hamiltonian $ H: T^*M \rightarrow \mathbb{R} $ is constant along the integral curves of the vector field $ X_H. $ 	
\end{thm}

\begin{proof}
	Suppose that $ c:I\subseteq \mathbb{R} \rightarrow T^*M $ is an integral curve of $ X_H. $ Then, the composition $ (H\circ c) (t) $ can be differentiated: let $ t\in I, $ and $ (U_{c(t)}, \varphi) $ be a coordinate chart, then, 
	%\begin{multline}
		
	$$ \frac{d}{dt} (H\circ c)(t) = \frac{d}{dt} \left( \left( H\circ \varphi^{-1} \right)\circ \left( \varphi\circ c \right) \right)(t) = \frac{d(\varphi\circ c)^i}{dt}\cdot \frac{\partial (H\circ \varphi^{-1})}{\partial q^i}= X_H^i \partial_i H $$ $$= dH(X_H)=\omega(X_H, X_H)=0,$$    
	%\end{multline}

	and $ H $ is constant throughout the curve $ c $, given the skew-symmetry of $ \omega $. 
\end{proof}

\begin{df}[\cite{montgomery2002tour}, example 2, section A.4]
	For any vector field $ \xi\in \mathfrak{X}(M), $ we define its \textit{ momentum function $ P_\xi:T^*M \rightarrow \mathbb{R} $} by
	$$ P_\xi(\alpha)= \alpha(\xi(\pi(\alpha))). $$ 
\end{df}

\begin{ex}[\cite{montgomery2002tour}, example 1, section A.4]
	If $ \xi=\partial/\partial q^i\in \mathfrak{X}( \mathbb{R}^n), $ its momentum function is
	$$ P_{\partial/\partial q^i}(\alpha)=\alpha(\partial/\partial q^i) = \alpha_i, $$ 
	where $ \alpha$ is represented in canonical coordinates as $ \alpha_i dq^i $. On the other hand, if we take the Hamiltonian $ H(\alpha)=P_{\partial/\partial q^i}(\alpha), $ we get that $ X_H=\partial /\partial q^i. $ 
\end{ex}

In local coordinates, $ P_\xi = p_i \xi_q^i $, hence, computing its Hamilton equations gives
$$ \dot{q^i} = \xi_q^i,\quad \dot{p_i} = -p_j \frac{\partial \xi_q^j}{\partial q^i}.  $$ 
The first Hamilton equation says that the flow of the Hamiltonian vector field $ X_{P_\xi} $ on $ T^*M $ projects onto the flow of the original vector field $ \xi $ on $ M $ (\cite{montgomery2002tour}, page 278). To understand the second Hamilton equation, recall that the \textit{cotangent lift} $ \Phi_{T^*}: T^*M \rightarrow T^*M $ of any diffeomorphism $ \Phi : M \rightarrow M $ is given by 
$$ \Phi_{T^*}(p) = (\Phi^{-1})^*_{\Phi(q)}(p),\ p\in T^*_qM,$$ 
where $ (\Phi^{-1})^* $ is 
$$ (\Phi^{-1})^*_{\Phi(q)}(p)(\eta) = p \left( d\Phi^{-1}_{\Phi(q)}(\eta) \right) $$ 
for every $ \eta\in T_{\Phi(q)}M. $ If $ \Phi_t: M \rightarrow M $ is the flow of the vector field $ \xi, $ then the flow of $ X_{P_\xi} $ is $ (\Phi_t)_{T^*}, $ as
$$ (\Phi_t)_{T^*}(p) = p \left( d(\Phi_{-t})_{\Phi(q)}(\cdot) \right), $$ 
and the first component represents the flow of $ \xi, $ while the second component is in coordinates $ p_i (\partial (\Phi_{-t})^i/\partial q^j)dq^j, $ so differentiating this expression with respect to $ t $ at $ t=0 $ gives $ -p_i (\partial \xi_q^i/\partial q^j)dq^j, $ which is the 1-form whose coordinates are equal to the coordinates on $ p $ of $ X_{P_\xi} $. Therefore, the second Hamilton equation for $ P_\xi $ asserts that the Hamiltonian flow is the cotangent lift of this flow on the configuration space $ M $ (\cite{montgomery2002tour}, page 278). Summarizing, we have the formula 
$$ X_{P_\xi} = \frac{d(\Phi_t)_{T^*}}{dt} \Big|_{t=0}.  $$ 

\begin{df}
	Let $ M $ be a symplectic manifold, and $ f,g: M \rightarrow \mathbb{R} $ be two observables. We define the \textit{Poisson bracket of $ f $ and $ g $ } as 
	$$ \left\{ f,g \right\}= X_g(f),$$ 
	where $ X_g  $ is the Hamiltonian vector field associated with $ g. $ 
\end{df}
In coordinates, the Poisson bracket is 
$$ \left\{ f,g \right\} = \frac{\partial g}{\partial p_i}\frac{\partial f}{\partial q^i} - \frac{\partial g}{\partial q^i} \frac{\partial f}{\partial p_i}.   $$ 
Another way to write the Poisson bracket of $ f $ and $ g $ using the symplectic form $ \omega $ of $M$ is the following:
$$ \left\{ f,g \right\} = df(X_g)=\omega (X_f,X_g). $$ 
\begin{prop}
	The Poisson bracket satisfies the following properties:
	\begin{enumerate}
		\item $ \left\{ f,g \right\} = -\left\{ g,f \right\},$ 
		\item $ \left\{ af+bg,h \right\} = a\left\{ f,g \right\}+ b \left\{ g,h \right\} ,   $ 
		\item $ \left\{ f, \left\{ g,h \right\}  \right\} +\left\{ h, \left\{ f,g \right\}  \right\} + \left\{ g, \left\{ h,f \right\}  \right\} =0, $  
		\item $ \left\{ f,gh \right\} =g \left\{ f,h \right\} + \left\{ f,g \right\} h,$ 
	\end{enumerate}
	where $ f,g,h: M \rightarrow \mathbb{R} $ are observables, and $ a,b\in \mathbb{R}. $ 
\end{prop}
\begin{proof}
	(\cite{poisson}, proof of proposition 1.3) Properties 1,2 and 4 are trivial. The third property, known as the \textit{Jacobi identity},  is equivalent to the fact that $ \omega $ is a closed form, as will be shown below. Recall that $$ d\chi(X,Y,Z)=X\chi(Y,Z)-Y\chi(X,Z)+Z\chi(X,Y)-\chi([X,Y],Z)+\chi([X,Z],Y)-\chi([Y,Z],X) $$ 
	for any 2-form $ \chi $ and $ X,Y,Z\in \mathfrak{X}(T^*M). $ Therefore, 
	

$\begin{aligned}
	d \omega\left(X_{f}, X_{g}, X_{h}\right) &=X_{f}\{g, h\}-X_{g}\{f, h\}+X_{h}\{f, g\}+\left[X_{f}, X_{g}\right] h-\left[X_{f}, X_{h}\right] g+\left[X_{g}, X_{h}\right] f \\
&=\{f,\{g, h\}\}-\{g,\{f, h\}\}+\{h,\{f, g\}\}+\{f,\{g, h\}\}-\{g,\{f, h\}\} \\
&-\{f,\{h, g\}\}+\{h,\{f, g\}\}+\{g,\{h, f\}\}-\{h,\{g, f\}\} \\
&=3 \left( \left\{ f, \left\{ g,h \right\}  \right\} +\left\{ h, \left\{ f,g \right\}  \right\} + \left\{ g, \left\{ h,f \right\}  \right\}\right).  
\end{aligned}$

From the last expression it is clear that $ d\omega=0 $ is equivalent to the Jacobi identity.
\end{proof}
The first three properties of last proposition guarantee that $ \left( C^\infty(M), \left\{ \cdot,\cdot \right\}  \right) $ is a Lie algebra. The last property is known as Leibniz identity, because due to it the operator $ f\mapsto \left\{ f,H \right\}  $, with $ H $ a Hamiltonian, is a derivation of $ C^\infty(M): $ 

$$ \left\{ fg,H \right\} =f \left\{ g,H \right\} +g \left\{ f,H \right\} . $$ 
Therefore, $ f\mapsto \left\{ f,H \right\}  $ determines a vector field over $M$: the Hamiltonian vector field of $ H, \ X_H $ (\cite{montgomery2002tour}, page 279).

\begin{prop}[Hamilton equations in bracket form]\label{prop:HEBF}
	If $ c(t) $ is an integral curve for $ X_H $ and $ f\in C^\infty(T^*M) $ is an observable, then
	\begin{equation}\label{eq:HamEq}
		\frac{d}{dt} \left( f\circ c \right)(t) = \left\{ f,H \right\} (c(t)).
	\end{equation}
\end{prop}
\begin{proof}
	Following the steps of the proof of theorem \ref{thm:constantCurves}, we obtain that
	$$ \frac{d}{dt} \left( f\circ c \right) (t)=\omega(X_f, X_H)= \left\{ f,H \right\}(c(t)).  $$ 
\end{proof}

We write $ \dot{f}= \left\{ f,H \right\} $ to refer to the expression \eqref{eq:HamEq}, valid for any observable $ f. $ Equation \eqref{eq:HamEq} also receives the name of Hamilton equations, and when $ f $ runs over the canonical coordinates $ q^i,p_i, $ we get the Hamilton equations previously stated in \eqref{eq:hamilton_equations}.

\begin{prop}[Poisson bracket of momentum functions]\label{prop:poisson_bracket_momentum}
	For any two vector fields $ \xi,\eta \in \mathfrak{X}(M) $ with momentum functions $ P_\xi, P_\eta: T^*M \rightarrow \mathbb{R}, $ we have that
	$$ \left\{ P_\xi,P_\eta \right\} = -P_{[\xi,\eta]}, $$ 
	where $ [\xi,\eta] $ is the Lie bracket between $ \xi $ and $ \eta, $ and $ P_{[\xi,\eta]} $ is the momentum function of $ [\xi,\eta]\in \mathfrak{X}(M). $  
\end{prop}
\begin{proof}
	Follows directly from calculus in coordinates.
\end{proof}
If $ (M,g) $ is a Riemannian manifold, we define the \textit{Riemannian Hamiltonian} $ H_R: T^*M \rightarrow \mathbb{R} $ as
$$ H_R(q,p)=\frac{1}{2} g_q(p,p).$$
In local coordinates, $  H_R(q,p)= g^{ij}(q)p_ip_j/2. $ This Hamiltonian has the following Hamilton equations:
$$ \dot{q^i} = \frac{\partial H_R}{\partial p_i} = g^{ij}p_j, \quad \dot{p_i} = - \frac{\partial H}{\partial q^i} = - \frac{1}{2} \frac{\partial g^{jk}(q)}{\partial q^i} p_jp_k. $$ 
From the first Hamilton equation we deduce that $ p_i = g_{ij}\dot{q^j}, $ and substituting this expression in the second Hamilton equation gives $$ \dot{p_i} = \frac{1}{2} \frac{\partial g_{ml}}{\partial q^i}\dot{q^m}\dot{q^l} ,$$ so that 
$$ \ddot{q^i} = \frac{\partial g^{ij}(q)}{\partial q^k} \dot{q^k}p_j+ g^{ij}\dot{p_j}= \frac{1}{2} g^{ij} \left( \frac{\partial g_{kl}}{\partial q^j}-2 \frac{\partial g_{jl}}{\partial q^k}   \right)\dot{q^k}\dot{q^l} = -\Gamma_{kl}^i \dot{q^k}\dot{q^l},$$ 
where $ \Gamma_{kl}^i $ is the Levi-Civita connection for metric $ g, $  and $ q $ satisfies the geodesic equation, from where we deduce that the integral curves of $ X_{H_R} $ are geodesics. Moreover, any geodesic $ q(t) $ satisfies Hamilton equations, given that $ p_i = g_{ij}\dot{q^j}. $ From this discussion we derive the following proposition.

\begin{prop}\label{prop:geo}
	If $ (M,g) $ is a Riemannian manifold, and $ H_R: T^*M \rightarrow \mathbb{R} $ is its Riemannian Hamiltonian, $ q(t) $ is a geodesic if and only if $ (q^i(t), g_{ij}(q(t))\dot{q^j}(t)) $ is an integral curve of $ X_{H_R}. $ 
\end{prop}

Recall that given a Riemannian manifold $ (M,g), $ we can construct a metric $ g^*_q $  over every cotangent fiber $ T^*_q M, $ using the identification
$$ g^*_q(v^*,w^*):=g_q(v,w), $$ 
where $ v^*,w^*\in T^*_qM, $ and $ v,w\in T_qM $ are the preimages of $ v^*,w^* $ via the isomorphism $ T^*_qM\cong T_qM $ induced by the metric $ g $, that is, $ v^*=g_q(v,\cdot) $ and $ w^*=g_q(w,\cdot) $. In coordinates, if $ g_q=g_{ij}(q) $, then $ g^*_q=g^{ij}(q). $

Now, if $ M $ is a manifold with a sub-Riemannian structure $ \left( \mathcal{H}, \langle \cdot,\cdot \rangle \right)  $, we can define a \textit{cometric}, that is just a metric over the fibers of the cotangent bundle as follows. Given a metric $ \langle \cdot,\cdot \rangle_q $ for $ \mathcal{H}_q, $ for any $ v^*\in T^*_qM $ there exists a single $ V\in \mathcal{H}_q $ such that $ v^*|_{\mathcal{H}_q} = \langle V,\cdot \rangle_q $. With this property, we can define the cometric $ (\cdot,\cdot)\in \mathfrak{X}_2^0(M) $ as a bilinear form (in general it is not a metric) over the fibers of the cotangent space as follows:
$$ (v^*,w^*)_q= \langle V,W \rangle_q, $$ 
where $ v^*,w^*\in T^*_qM $, and $ V,W\in \mathcal{H}_q $ are such that $ v^*|_{\mathcal{H}_q}= \langle V,\cdot \rangle_q, $ $ w^*|_{\mathcal{H}_q}= \langle W,\cdot \rangle_q. $ 
\begin{df}[\cite{montgomery2002tour}, definition 1.5.2]
	If $ M $ is a manifold, and $ \left( \mathcal{H}, \langle\cdot,\cdot\rangle \right) $ is a sub-Riemannian structure over it, we define the sub-Riemannian Hamiltonian $ H_{sR}: T^*M \rightarrow \mathbb{R} $ as $$ H_{sR}(p,q)= \frac{1}{2} (p,p)_q, $$   	
	where $ (\cdot,\cdot) $ is the cometric induced by $ \langle\cdot,\cdot\rangle. $ 
\end{df}
If $ \pi: Q \rightarrow M $ is a submersion endowed with an Ehresmann connection $ \mathcal{H} $, and $ (M,g) $ is a Riemannian manifold, we have a sub-Riemannian structure on $ Q: $ $ (\mathcal{H},\langle\cdot,\cdot\rangle) $, where $ \langle\cdot,\cdot\rangle $ is defined by the isomorphism $ d\pi_q|_{\mathcal{H}_q}: \mathcal{H}_q \rightarrow T_{\pi(q)}M $ and the metric $ g $ on $ M. $ 

The sub-Riemannian Hamiltonian $ H_{sR}: T^*Q \rightarrow \mathbb{R}$ can be written in terms of the Riemannian Hamiltonian $ H_R: T^*M \rightarrow \mathbb{R} $ in the following way: given the splitting $ TQ= \mathcal{H}\oplus V, $ we have that $ T^*Q = \mathcal{H}^* \oplus V^*, $ and so we have the canonical projection $ \operatorname{pr}_1: T^*Q \rightarrow \mathcal{H}^*. $ Now, we define a second map $ \operatorname{pr}_2: \mathcal{H}^* \rightarrow T^*M $ by the formula $ \operatorname{pr}_2(\alpha)(v)=\alpha(h_q v), $ where $ \alpha\in \mathcal{H}^*_q, $ $ v\in T_{\pi(q)}M, $ and $h_qv$ is the horizontal lift of $ v $ into $ \mathcal{H}_q $ (well-defined and unique, because $ \mathcal{H} $ is an Ehresmann connection).
\begin{prop}[\cite{montgomery2002tour}, proposition 11.1.5]
	The induced sub-Riemannian Hamiltonian is given by $H_{sR}= H_R \circ \operatorname{pr},$ where $ \operatorname{pr}= \operatorname{pr_2}\circ \operatorname{pr_1}. $ 
\end{prop}

\begin{proof}
	For any $ Y \in \mathfrak{X}(M) $, its horizontal lift is a vector field $ hY \in \mathfrak{X}(Q) $ that satisfies the following properties: $ (hY)_q \in \mathcal{H}_q $ and $ d\pi_q( (hY)_q) = Y_{\pi(q)}$ for all $ q\in Q. $  If $\{Y_a\}_{a=1}^n $ is an orthonormal frame for the Riemannian structure on $ M, $ then $ \{hY_a\}_{a=1}^n $ is a horizontal orthonormal frame for the induced sub-Riemannian structure on $ Q, $ and therefore
	$$ H_R = \frac{1}{2} \sum^{}_{a} P_{Y_a}^2 \text{ and } H_{sR} = \frac{1}{2} \sum^{}_{a} P_{(hY)_a}^2, $$ 
	where $ P_{Y_a} $ and $ P_{(hY)_a} $ are the momentum functions associated to $ Y_a $ and $ (hY)_a, $ respectively. Now, for any $ Y\in \mathfrak{X}(M) $, $ \operatorname{pr} ^* P_Y = P_{hY}$ because if $ \alpha: T^*Q \rightarrow \mathbb{R}, $ then
	\begin{align*}
	(\operatorname{pr}^*P_Y)(\alpha)=P_Y( \operatorname{pr} (\alpha)) = \operatorname{pr} (\alpha) (Y_{\pi(q)}) = \operatorname{pr} (\alpha) \left( d\pi_q((hY)_q) \right) \\= \operatorname{pr}_1(\alpha) \left( (hY)_q \right) =\alpha( (hY)_q ) =  P_{hY}(\alpha).  
	\end{align*}
	With this, 
	$$ H_R \circ \operatorname{pr} = \frac{1}{2} \sum^{}_{a} (P_{Y_a}\circ \operatorname{pr} )^2 = \frac{1}{2} \sum^{}_{a} (\operatorname{pr}^* P_{Y_a})^2 = \frac{1}{2} \sum^{}_{a} P_{(hY)_a}^2=H_{sR}. $$ 
\end{proof}
\begin{df}
	Let $ (M,g) $ be a Riemannian manifold, and $G $ a Lie group that acts on $ M $ via the application $ \alpha: M\times G \rightarrow M, $ $ \alpha(m,h)= m\cdot h. $ We say that \textit{the metric $ g $ is $ G $-invariant} if  
	$$ g_{m\cdot h}((d\alpha_h)_m(v),(d\alpha_h)_m(w))=g_m(v,w), $$ 
	for all $ m\in M, $ $ v,w\in T_mM $ and $ h\in G. $ 
\end{df}

\begin{df}\label{df:compatible_riemannian_metric}
	Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle with connection $ \mathcal{H}. $ If $ (\mathcal{H},\langle\cdot,\cdot\rangle) $ is a metric of bundle type, we say that a metric $ h $ on $ Q $ is a \textit{compatible Riemannian metric} if $ h $ is $ G $-invariant and compatible (see Definition \ref{df:compatible}).
\end{df}
 From Definition \ref{df:compatible_riemannian_metric}, it is clear that $ h|_{G_q}: TG_q \oplus TG_q \rightarrow \mathbb{R} $ is a right-invariant metric, which we will use to define a metric on $ G $ later on.
 \begin{df}
Let $ \mathfrak{g}= \operatorname{Lie}(G)=T_eG, $ and $ \operatorname{exp} : \mathfrak{g}\rightarrow G $ be the exponential application. \textit{The infinitesimal generator map for the group action $ \sigma_v: Q\rightarrow T_qQ $ }, for $ v \in \mathfrak{g} $,  is defined as
$$ \sigma_v(q) = \frac{d}{d\epsilon} \Big|_{\epsilon=0} \left( q\cdot \operatorname{exp} (\epsilon v) \right).$$ 
 \end{df}


\begin{df}[\cite{montgomery2002tour}, definition 11.2.3]
	For a given $ q\in Q, $ the bilinear form on $ \mathfrak{g}, $ $ \mathbb{I}_q: \mathfrak{g}\times \mathfrak{g}\rightarrow \mathbb{R}, $ given by
	$$ \mathbb{I}_q(v,w) = h_q(\sigma_v q, \sigma_w q) $$ 
	is called the \textit{moment of inertia tensor at $ q. $ } 
\end{df}

Recall that for a Lie group $ G $, the map $ \operatorname{ad}_g: G \rightarrow G  $ given by $ h\mapsto ghg^{-1} $ is a diffeomorphism, and its differential at identity, $ d( \operatorname{ad}_g )_e $,  is denoted as $ \operatorname{Ad}_g: \mathfrak{g}\rightarrow \mathfrak{g} $. 

\begin{prop}\label{prop:equiv_infinitesimal}
	The family of vector fields $ \left\{ \sigma_v \right\}_{v\in \mathfrak{g}} $ satisfies the following property:
	$$ \sigma_v(q\cdot g) = d(\alpha_g)_q\left(\sigma_{\operatorname{Ad}_g(v)}(q)\right) ,$$ 
	where $ \alpha: Q\times G \rightarrow Q $ is the action of $ G $ on $ Q. $ 
\end{prop}
\begin{proof}
	Let $ \gamma:(-\epsilon,\epsilon) \rightarrow G $ be the one parameter subgroup such that $ \gamma(0)=e, $ $ \dot{\gamma}(0)=\xi\in \mathfrak{g}. $ Then, $ \operatorname{Ad}_g \left( \xi \right) = d/dt|_{t=0}(g\gamma(t)g^{-1}), $ and evaluating this on $ \sigma_q $ gives

	$$ \sigma_{\xi}(q) = \frac{d}{d\epsilon} \Big|_{\epsilon=0} q\cdot \operatorname{exp} \left( \epsilon \frac{d}{dt} \Big|_{t=0} g\gamma(t)g^{-1} \right) = \frac{d}{d\epsilon} \Big|_{\epsilon=0} q\cdot g\gamma(\epsilon)g^{-1}. $$ 
	Finally, if we evaluate this on $ d(\alpha_g)_q, $ we get that
	\begin{dmath*}
		d(\alpha_g)_q \left( \frac{d}{d\epsilon} \Big|_{\epsilon=0} q\cdot g\gamma(\epsilon)g^{-1} \right) = \frac{d}{d\epsilon} \Big|_{\epsilon=0}  q \cdot g\gamma(\epsilon)= \frac{d}{d\epsilon} \Big|_{\epsilon=0} q\cdot g \operatorname{exp} \left( \epsilon\xi \right) = \frac{d}{d\epsilon} \Big|_{\epsilon=0} (q\cdot g) \cdot \operatorname{exp} (\epsilon\xi)= \sigma_\xi(q\cdot g). 
	\end{dmath*}
\end{proof}

Thanks to the last proposition and the fact that $ h $ is $ G $-invariant, we have that
\begin{dmath*}
	\mathbb{I}_{q\cdot g}(v,w)= h_{q\cdot g} \left( d(\alpha_g)_q\left(\sigma_{\operatorname{Ad}_g(v)}(q)\right), d(\alpha_g)_q\left(\sigma_{\operatorname{Ad}_g(w)}(q)\right)\right) = h_q \left( \sigma_{\operatorname{Ad}_g(v)}(q),\sigma_{\operatorname{Ad}_g(w)}(q)\right) = \mathbb{I}_q \left( \operatorname{Ad}_g(v), \operatorname{Ad}_g(w) \right).
\end{dmath*}

\begin{df}
	Let $ G $ be a Lie group. A bilinear form $ \beta \in \Lambda^2(\mathfrak{g}) $ is called \textit{bi-invariant} or \textit{adjoint invariant} if
	$$ \beta \left( \operatorname{Ad}_g v, \operatorname{Ad}_g w \right) = \beta(v,w) \text{ for all }g\in G,\ v,w\in \mathfrak{g}. $$ 
\end{df}

Any bilinear form $ \beta\in \Lambda^2( \mathfrak{g}) $ can be extended to a tensor field of type $ (2,0) $ on $ G $   using left or right translations $ L_g: G \rightarrow G, h \mapsto gh, $ $ R_g: G \rightarrow G, h \mapsto hg $ in the following way:
$$ \beta_g (v,w) = \beta \left( d (L_{g^{-1}})_g(v),d (L_{g^{-1}})_g(w) \right), \text{ or}  $$ 
$$ \beta_g (v,w) = \beta \left( d (R_{g^{-1}})_g(v),d (R_{g^{-1}})_g(w) \right),  $$ 
for all $ g\in G $, $ v,w\in T_g G. $ If $ \beta $ is bi-invariant, both extensions coincide, because
\begin{dmath*}
	\beta \left( d (R_{g^{-1}})_g(v),d (R_{g^{-1}})_g(w) \right) =    \beta \left( d (R_{g^{-1}})_g\circ d(L_g)_e\circ d(L_{g^{-1}})_g(v),d (R_{g^{-1}})_g\circ d(L_g)_e\circ d(L_{g^{-1}})_g(w) \right) = \beta \left( \operatorname{Ad}_g\circ d(L_g^{-1})_g(v),\operatorname{Ad}_g\circ d(L_g^{-1})_g(w) \right) = \beta \left( d (L_{g^{-1}})_g(v),d (L_{g^{-1}})_g(w) \right). 
\end{dmath*}
Therefore, an adjoint invariant positive definite bilinear form on the Lie algebra defines a \textit{bi-invariant Riemannian metric on $ G $.}

\begin{df}
	[\cite{montgomery2002tour}, definition 11.2.4] The $ G $-invariant Riemannian metric (or pseudometric) $ h $ on $ Q $ is said to be of \textit{constant bi-invariant type} if its inertia tensor $ \mathbb{I}_q $ equals the same bi-invariant bilinear form on $ \mathfrak{g}, $ for all $q\in Q. $ 
\end{df}

Note that if $ G $ is a Lie group acting on itself via the multiplication map $ \alpha: G\times G \rightarrow G,\ (k,h) \mapsto kh $, $ \alpha_h = R_h, $ and if $ g $ is a $ G $-invariant metric on $ G $ we have that 
$$ g_{kh} \left( d(R_h)_k(v), d(R_h)_k(w) \right) = g_k(v,w) $$ 
for all $ k,h\in G,\ v,w\in T_kG. $ Therefore, a metric on $ G $ is $ G $-invariant under the canonical action of $ G $ on itself if and only if this metric is right invariant. Moreover, $ g $ is of constant bi-invariant type if and only if it is bi-invariant, because for any $ v,w\in T_kG, $  there exist $ \xi,\eta\in \mathfrak{g} $ such that $ d(L_k)_e\xi=v, d(L_k)_e\eta=w, $ and
$$\mathbb{I}_k(\xi,\eta)= g_k(v,w)= \mathbb{I}_{hk}(\xi,\eta)= g_{hk} \left( d(L_h)_kv, d(L_h)_k w \right) $$
as $ \sigma_\chi(k) = d(L_k)_e\chi $ for all $ k\in G, \ \chi\in \mathfrak{g}. $ 

\begin{prop}\label{prop:essential_fact1}
	If $ g $ is a bi-invariant metric on a Lie group $ G, $ its geodesics through the identity coincide with its one-parameter subgroups.
\end{prop}
\begin{proof}
	If $ m: G\times G \rightarrow G $ is the multiplication map, let $ h,k\in G $, and $ \gamma,\eta: \left( -\epsilon,\epsilon \right) \rightarrow G $ be two curves such that $ \gamma(0)=h, \dot{\gamma}(0)=v \in T_hG,\eta(0)=k,\dot{\eta}(0)=w\in T_kG. $ The differential $ dm_{(h,k)}: T_{(h,k)}G\times G\cong T_hG\oplus T_kG \rightarrow T_{hk} G $ is bilinear, so that if $ l,s: \left( -\epsilon,\epsilon \right) \rightarrow H $ are constant maps with $ l(t)=h,s(t)=k, $ then

	$$ dm_{(h,k)}(v,0)= \frac{d}{dt} \Big|_{t=0} \left( \gamma(t) k \right) = d(R_k)_h(v), $$ 
	and
	$$ dm_{(h,k)}(0,w) = \frac{d}{dt} \Big|_{t=0}\left( h\eta(t) \right) = d(L_h)_k(w). $$ 
	Therefore, $ dm_{(h,k)}(v,w) = d(R_k)_h(v)+ d(L_h)_k(w)  $ by linearity.  Using this result, if $ \gamma: \left( -\epsilon,\epsilon \right)  $ is a curve such that $ \gamma(0)=0, \dot{\gamma}(0)=v\in T_hG, $ differentiating the expression $ \gamma(t) \left[ \gamma(t) \right]^{-1}=e $ gives
	$$ 0 = d(R_{h^{-1}})_h(v)+d(L_h)_{h^{-1}} \left( d\iota_h(v) \right),  $$ 
	where $ \iota: G \rightarrow G $ is the inversion map $ h \mapsto h^{-1}. $ From last expression we get that $ d\iota_h(v)=-d(L_{h^{-1}})_e\circ d(R_{h^{-1}})_h(v) $. As $ g $ is a bi-invariant metric, $ g_{h^{-1}}(d\iota_h(v),d\iota_h(w)) = g_h(v,w), $ and as $ \iota: G \rightarrow G $ is a diffeomorphism, it is an isometry. 

	Now, if $ \gamma: \left( -\epsilon,\epsilon \right) \rightarrow G $ is a geodesic with $ \gamma(0)=e,\dot{\gamma}(0)=v\in T_eG, $ as $ \iota $ is an isometry, $ \iota\circ\gamma(t)= \left[ \gamma(t) \right]^{-1} $ is also a geodesic. Moreover, $ d\iota_e(v)=-v, $ so that $ \gamma(t) $ and $ \left[ \gamma(t) \right]^{-1} $ are the same geodesic, with $ \left[ \gamma(t) \right]^{-1} = \gamma(-t).  $ For small $ t_0\in \mathbb{R} $ (sufficiently small in order to have that $ \operatorname{Im} \gamma|_{[0,t_0]}\subset U,  $ where $ U $ is a totally normal neighborhood of $ e $), consider the curve $ \eta:(-t_0,0) \rightarrow G $, $ t \mapsto  \gamma(t_0)\gamma(t)= L_{\gamma(t_0)}(\gamma(t)) $. This curve is a geodesic because $ g $ is bi-invariant, with $ \gamma(0)=\gamma(t_0), \eta(-t_0)=e. $ Due to the uniqueness of minimizing geodesics in a totally normal neighborhood, $ \eta(t)=\gamma(t_0+t), $ that is, $ \gamma(t_0)\gamma(t)= \gamma(t_0+t), $ for $ t\in (-t_0,0). $  Using the relation $ \gamma(s+t)=\gamma(s)\gamma(t) $  and the local uniqueness of minimizing geodesics we can extend this property over all the domain of the geodesic $ \gamma. $ With this, $ \gamma $ is a one-parameter subgroup, and
	$$ \operatorname{exp} (v)=\gamma(1)= (\operatorname{exp}_R)_e(v),  $$ 
	where $ (\operatorname{exp}_R)_e : T_eG \rightarrow G  $ is the Riemannian exponential.
\end{proof}

\begin{prop}\label{prop:essential_fact2}
	If $ G $ is a Lie group endowed with a bi-invariant metric $ g, $ the Riemannian Hamiltonian $ H_R : T^*G \rightarrow \mathbb{R}, (q,p) \mapsto g_q(p,p)/2$ commutes with every right or left invariant observable $ f\in C^\infty ( T^*G). $ 
\end{prop}
\begin{proof}
	From Proposition \ref{prop:HEBF}, if $ f: T^*G \rightarrow G $ is an observable, then $ d/dt \left( f\circ c \right) (t)= \left\{ f, H_R \right\}(c(t)),  $ where $ c(t) $ is an integral curve of the Hamiltonian vector field associated to $ H_R. $ By Proposition \ref{prop:geo}, $ c(t)=(q(t), g_{q(t)}(\cdot, \dot{q}(t))) $, where $ q(t) $ is a geodesic by Hopf-Rinow Theorem. As $ G $ is complete (because $ g $ is bi-invariant), there is a geodesic that connects $ e $ with every $ h\in G, $ and by last proposition, this geodesic is a one-parameter subgroup, which implies that $ d/dt(f\circ c)(t)=0, $ because the quantity $ f\circ c(t) $ is constant since $ f $ is left or right invariant.	
\end{proof}

\begin{thm}[Theorem on normal geodesics of bundle type sub-Riemannian metrics, \cite{montgomery2002tour}, theorem 11.2.5]\label{thm:normal_geodesics}
	%kk
	Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle with connection $ \mathcal{H}. $ Suppose that $ Q $ is a Riemannian manifold such that its metric is a Riemannian submersion (see Definition \ref{def:riemannian_submersion}), compatible with $ \mathcal{H}, $ $ G $-invariant, and its associated vertical metric has constant bi-invariant type. Therefore, given any geodesic $\gamma: I \rightarrow Q, $ the horizontal lift of $ \pi\circ\gamma $ is a sub-Riemannian geodesic. All sub-Riemannian geodesics can be obtained in this manner. Moreover, the projected curve $ \pi\circ\gamma$ is a geodesic in the base space $ M $ if and only if $ \gamma $ is a horizontal geodesic in $ (Q, \mathcal{H}). $ 
\end{thm}

\begin{rem}
The assumptions of this theorem are equivalent to suppose that $ \pi: Q \rightarrow  M $ is a principal $ G $-bundle endowed with a sub-Riemannian metric of bundle type, and that this metric can be extended to a compatible Riemannian metric whose associated vertical metric has constant bi-invariant type.	
\end{rem}
\begin{proof}
	Let $ H_R $ be the Riemannian Hamiltonian of $ Q, $ $ H_{sR} $ its sub-Riemannian Hamiltonian, and let $ H_G$ be the vertical part of the Riemannian Hamiltonian, that is, $ H_R = H_{sR}+H_G. $  We will need the following two claims for this proof:
	\begin{enumerate}
		\item $ H_{sR} $ and $ H_G $ Poisson-commute, that is, $ \left\{ H_{sR}, H_G \right\} =0. $ 
		\item The projection to $ Q $ of any integral curve in $ T^*Q $ for the Hamiltonian vector field defined by $ H_G $ is of the form $ q \operatorname{exp}(tv),  $ for some fixed $ v\in \mathfrak{g}, $ which depends of the initial conditions of the integral curve.
	\end{enumerate}
	\begin{proof}
		[Proof of the claims] It suffices to show that the claims hold over any locally trivialized neighborhood $ \pi^{-1}(U) $ in $ Q. $ Let $ \phi_U: \pi^{-1}(U) \rightarrow U\times G $ be the corresponding local trivialization, which induces a diffeomorphism $ T^*Q \cong T^*U\times T^*G.$

		Let $ (x,p)\in T^* U $ and $ (g,\mu)\in T^*G $, being $ \mu\in \mathfrak{g}^*. $ Then, we have that
		\begin{equation}\label{eq:ham1}
			H_G(x,p,g,\mu) = \beta^*(\mu)
		\end{equation}
		and
		\begin{equation}\label{eq:ham2}
			H_{sR}(x,p,g,\mu)= f(x,p,\mu).	
		\end{equation}
		Equations \eqref{eq:ham1} and \eqref{eq:ham2} come from the fact that the metric is of constant bi-invariant type and $ G $-invariant. Using these equations, the Poisson bracket of $ H_{sR} $ and $ H_{G} $ is

		$$ \left\{ f,\beta^* \right\} = \underbrace{\left\{ f,\beta^* \right\}_U}_0 + \left\{ f,\beta^* \right\}_G = \sum^{}_{a} \frac{\partial f}{\partial g^a} \frac{\partial \beta^*}{\partial \mu_a} = \sum^{}_{a} \frac{\partial f}{\partial \mu_a} \frac{\partial \mu_a}{\partial g^a} \frac{\partial \beta^*}{\partial \mu_a}  = \sum^{}_{a} \frac{\partial f}{\partial \mu_a} \left\{ \mu_a, \beta^* \right\}_G, $$ 
		using both the Leibniz rule and the product Poisson structure, $ \mu_a $ are coordinates on $ \mathfrak{g}^*, $ and $ g^a $ are coordinates on $ G. $ As the $ \mu_a $ are right-invariant functions on $ T^*G$, by proposition \ref{prop:essential_fact2}, $ \left\{ \mu_a,\beta^* \right\}_G =0 $, and this proves the first claim.

		To prove the second claim, note that the flow of $ H_G $ is of the form $\Phi_G(t)(x,p,g,\mu)= (x,p; \Phi_\beta(t)(g,\mu))$, where $ \Phi_\beta(t): T^*G \rightarrow T^*G$ is the flow associated with $ \beta^*, $ that is, $ \Phi_\beta(t)(g,\mu)=( \operatorname{exp}_g(tv), \mathfrak{v}_{ \operatorname{exp}_g(tv) }(\cdot, d/dt \operatorname{exp}_g(tv) ) ) $, where $ \mathfrak{v} $ is the vertical metric, and $ v \in \mathfrak{g} $ satisfies $ \mu = \mathfrak{v}_g(\cdot,v). $ With this, the projection to $ Q $ of $ \Phi_G(t)(x,p,g,\mu) $ is $ x \operatorname{exp}_g(tv). $  
	\end{proof}
	With the claims proved, we proceed with the proof of the theorem. The Riemannian exponential map is the composition of four maps:
	\begin{center}
		% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRABUB9ARwEUQAvqXSZc+QigCM5KrUYs27fkJHY8BIgCYZ1es1aIOAPQBUy4SAxrxRAMw65+xafOqxGlABYHehYeWyMFAA5vBEoABmAE4QALZIZCA4EEjSIAx0AEYwDAAKouoS6TAROCC68gYgADrV+Dh0ghbRcanUyUjaIHAAFlilCSogLfGIXR2I9o5+NdW5fZwASgAUkgCUTZExo1MT3tNVtRBoMFF0yVFgdLEwwGgxAFYCghQCQA
\begin{tikzcd}
T_qQ \arrow[r, "\iota"] & TQ \arrow[r] & T^*Q \arrow[r, "\Phi_R(1)"] & T^*Q \arrow[r, "\operatorname{proj}"] & Q,
\end{tikzcd}
	\end{center}
	where the first map $ \iota $ is the inclusion, the second map is the metric induced identification, $ \Phi_R(1) $ is the time 1-flow of $ H_R, $ and $ \operatorname{proj}  $ is the canonical projection. The Riemannian geodesics are obtained by the same sequence of compositions, changing $ \Phi_R(1) $ to $ \Phi_R(t). $ Since $ H_{sR} = H_R - H_G, $ and the flows for $ H_R, $ $ H_{sR} $ and $ H_R $ all commute according to claim (1), we have that $ \Phi_{sR}(t)= \Phi_R(t)\circ \Phi_G(-t). $  Applying the projection $ \operatorname{proj} :T^*Q \rightarrow Q $ to this formula, and considering the claim (2), we find that the normal sub-Riemannian geodesics all have the form 
	\begin{equation}\label{eq:normal_geodesic_form}
		\operatorname{exp}_R(tv)  \operatorname{exp}_G(-tw).
	\end{equation}
	These sub-Riemannian geodesics must be horizontal, which leads to $ w=A(v)\in \mathfrak{g}, $ where $A\in \Omega^1(Q, \mathfrak{g})$ is the connection one-form annihilating the horizontal space.

	As the flow $ \Phi_G $ is purely vertical ($\pi(qg)=\pi(q)$ for any $ g\in G $), \eqref{eq:normal_geodesic_form} projects to $ \pi( \operatorname{exp}_R(tv)) $ in the quotient $ M=Q/G, $ and its horizontal lift will be \eqref{eq:normal_geodesic_form}. This proves that the lifting of any projected geodesic for the extended metric is a normal sub-Riemannian geodesic.

	Finally, observe that if $ \gamma: I \rightarrow Q $ is a horizontal geodesic, its projection $ \pi\circ\gamma $ is a geodesic in $ M. $ Reciprocally, if $ \pi\circ\gamma $ is a geodesic, as the distance between points in $ M $ is the distance between fibers in $ Q, $ $ \pi(\gamma(t) ) $ is a geodesic if and only if $\gamma(t)$ minimizes distances between fibers, but this implies that this curve is normal to the fibers (if it were not normal, we could construct a shorter curve, leading to a contradiction), and therefore it is a sub-Riemannian geodesic.  
\end{proof}

\section{Classical particles in Yang-Mills fields}%
\label{sec:classical_particles_in_yang_mills_fields}


What we aim to show in this section is that, given a principal $ G $-bundle $ \pi:Q \rightarrow M $ with metric of bundle type $ (\mathcal{H}, \langle\cdot, \cdot \rangle) $,   there is a system of differential equations that describes the projected normal geodesics $ \pi\circ\gamma, $ where $ \gamma: I \rightarrow Q $ is a horizontal geodesic. When the fiber is a circle, these projected equations arise the \textit{Lorentz equations of electromagnetism} in a concrete system. When the fiber is a general Lie group $ G, $ these equations are called the \textit{nonabelian Lorentz equations,} also known as \textit{Wong's equations} (\cite{montgomery2002tour}, p. 209). Moreover, the results of this section are useful to find the sub-Riemannian geodesics in cases where Theorem \ref{thm:normal_geodesics} can not be applied, which may happen when the Riemannian geodesics on $ M $ are not known, or are harder to compute than the sub-Riemannian geodesics.

The sub-Riemannian geodesic equations are ordinary differential equations on $ T^*Q. $ For metrics of bundle type, the Hamiltonian $ H: T^*Q \rightarrow  \mathbb{R} $ is $ G $-invariant, and hence the action of $ G $ on $ T^*Q $ takes sub-Riemannian geodesics to sub-Riemannian geodesics because of Theorem \ref{thm:constantCurves}. Therefore, we should be able to find differential equations for projections of the sub-Riemannian geodesics on $ T^*Q/G. $ 

 \subsection{Associated bundles}%
 \label{sub:associated_bundles}

\begin{df}
	Let $ G $ be a Lie group. A \textit{representation of $ G $ on a vector space $ E $} is a Lie group homomorphism $ \rho: G \rightarrow \operatorname{GL} (E). $ 
\end{df}

\begin{df}[\cite{montgomery2002tour}, p. 210]
	Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle, and $ \rho: G \rightarrow \operatorname{GL}(E) $ be a representation of $ G $ on a vector space $ E. $ Consider the right action on $ Q\times E $ given by $ (q,v)\cdot g = (q\cdot g, \rho(g^{-1})v). $  The orbit space associated to this action is denoted as $ (Q\times E)/G $, $ Q\times_\rho E $ or $ \rho(Q). $  A point of $ \rho(Q) $ corresponding to the orbit of $ (q,v) $ is written as $ [q,v] $ or $ qv. $  

	\textit{The associated bundle of $ \pi:Q \rightarrow M $ } is the vector bundle $ \pi_{ \rho(Q)}: \rho(Q) \rightarrow M $ with fiber $ E, $ where $ \pi_{\rho(Q)}(qv)=\pi(q). $ The sum between two elements $ qv,qw$ in the same fiber is $ q(v+w). $  
\end{df}

The associated bundle is a vector bundle because the fibers are isomorphic to $ E, $ as $ \pi_{\rho(Q)}^{-1}(q)= \left\{ [q,v]: v\in E \right\}.  $ Moreover, the local trivialization property holds: as $ \pi: Q \rightarrow M $ is a principal $ G $- bundle, for every $ m\in M, $ there is an open neighborhood $ U $ of $ m $ and a diffeomorphism $ \phi: \pi^{-1}(U) \rightarrow U \times G, $ $ q \mapsto (m, \varphi(q)) $ that realizes the local trivialization property of $ Q; $ with this, the diffeomorphism that realizes the local trivialization property of $ \rho(Q) $ is $ \Phi: \pi_{\rho(Q)}^{-1}(U) \rightarrow U\times E $, $ [q,v] \mapsto (m, \rho(\varphi(q))v) $ (\cite{sharpe2000differential}, p. 37).  

\begin{ex}[\cite{montgomery2002tour}, p. 210]
	Let $ \xi: R \rightarrow M $ be a real vector bundle of rank $ n $, and $ \pi: Q \rightarrow M $ is the principal $ \operatorname{GL}(n, \mathbb{R})  $-bundle whose fibers are $$ \pi^{-1}(m) = \left\{ q: \mathbb{R}^n \rightarrow \xi^{-1}(m) \ | \ q\in \operatorname{Isom}( \mathbb{R}^n, \xi^{-1}(m)) \right\},  $$ that is, each fiber consists of all frames for $ \xi^{-1}(m), $ and each element $ q\in Q_m $ is a linear isomorphism between $ \mathbb{R}^n $ and $ R_m, $ with the given basis being the image of the standard basis of $ \mathbb{R}^n. $ The principal $ \operatorname{GL} (n, \mathbb{R}) $-bundle $ \pi $ is called \textit{frame bundle} of the vector bundle $ \xi $.

	The action of $ \operatorname{GL} (n, \mathbb{R})$ on $ Q_m $ is given by $ q\mapsto qg:=q\circ g, $ and $ \operatorname{GL} (n, \mathbb{R}) $ acts on $ \mathbb{R}^n $ in the standard way. Now, let us show that the associated bundle of $ \pi: Q \rightarrow M $ is $ \xi: R \rightarrow M. $ We consider the standard representation of $ \operatorname{GL} (n, \mathbb{R}), $ that is, the identity map $ \rho: \operatorname{GL} (n, \mathbb{R}) \rightarrow \operatorname{GL} (n, \mathbb{R}) $, so that the action on $ Q \times \mathbb{R}^n$ is given by $ (q,v)\cdot g = (q\circ g, g^{-1}(v)),$ where $ q\in Q, $ $ v\in \mathbb{R}^n $ and $ g\in \operatorname{GL} (n, \mathbb{R}). $ Now, the orbit space associated to this action, $ \rho(Q), $ is diffeomorphic to $ R $ through the maps
	$$ \psi: \rho(Q) \rightarrow R, \ qv\mapsto q(v), \quad \psi^{-1}: R \rightarrow \rho(Q), \ r \mapsto [q,q^{-1}(r)], \text{ where }q\in \pi^{-1}(\xi(r)), $$ 
	and the following diagram commutes because $ \xi\circ \psi(qv)=\xi(q(v))=\pi(q)=\phi(qv).$ Explicitly, $ \xi(q(v))=\pi(q) $ because $ q\in\pi^{-1}(m) $ and $ q(v)\in \xi^{-1}(m) $ for a given $ m\in M, $ so that $ \xi(q(v))=m=\pi(q). $ Therefore, the associated bundle of the frame bundle $ \pi: Q \rightarrow M $ is $ \xi : R \rightarrow M. $ 
	\begin{center}
		% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAB12AnACwgAoAigEoQAX1LpMufIRQBGclVqMWbAErjJIDNjwEiZecvrNWiEAFktUvbKKLj1U2ovWxymFADm8IqAAzLggAWyQyEBwIJEUQBjoAIxgGAAVpfTk4mACcEGdVcw52NGwbECDQ8OoopAAmfLM2TjQeLDy4xOS0uwMLLixvHlyJQOCwxHrI6MQAZmp4pNT0+z6BofaXQvkAfXdtCvHYmtmG1yKADzaPMSA
\begin{tikzcd}
\rho(Q) \arrow[r, "\psi"] \arrow[d, "\phi"'] & R \arrow[d, "\xi"] \\
M \arrow[r, "1_M"']                          & M                 
\end{tikzcd}
	\end{center}

	This example can be extended to vector bundles endowed with additional structure. For example, for complex vector bundles we take $ Q_m $ as the space of complex linear maps $ \mathbb{C}^n \rightarrow  R_m; $ for a vector bundle $ \xi $ with a fiber metric we take $ Q_m $ to be the space of linear isometries $ \mathbb{R}^n \rightarrow R_m; $ and if $ \xi $ is complex with a fiber-Hermitian structure we take $ Q_m $ to consist of the unitary maps $ \mathbb{C}^n \rightarrow R_m. $ 
\end{ex}
The adjoint representation of a Lie group $ G $ on its Lie algebra $ \mathfrak{g} $ is given by the adjoint map $ \operatorname{Ad} : G \rightarrow \operatorname{Aut}( \mathfrak{g}),  $ where $ \operatorname{Ad} (g)= \operatorname{Ad}_g= d( \operatorname{ad}_g )_e : \mathfrak{g}\rightarrow \mathfrak{g}. $ Its dual representation is $ \operatorname{Ad}^*: G \rightarrow \operatorname{Aut} ( \mathfrak{g}^* ), $ $ \operatorname{Ad}^*(g)= \operatorname{Ad} (g^{-1})^*, $ defined on the dual Lie algebra $ \mathfrak{g}^*. $ From these representations, given a principal $ G $-bundle $ \pi: Q \rightarrow M, $ we can construct the associated bundles $ \operatorname{Ad}(Q) $ and $ \operatorname{Ad}^*(Q), $ called \textit{adjoint and co-adjoint bundles of $ \pi:Q \rightarrow M $, } respectively. These two bundles are \textit{dual vector bundles over $ M $,} which means that fibers of $  \operatorname{Ad}^*(Q)$ are the dual spaces to the fibers of $ \operatorname{Ad} (Q). $ 

\begin{ex}[\cite{montgomery2002tour}, p. 211]
	If $ \pi:Q \rightarrow M $ is the frame bundle of some vector bundle $ \xi: R \rightarrow M, $ then $ \operatorname{Ad}(Q) $ can be identified with the bundle whose fiber over $ m\in M $ is the space of linear maps on $ \xi_m $ in the sense that $ \operatorname{Ad} (Q)_m \cong \operatorname{Hom}(\xi_m,\xi_m),  $ because $ \operatorname{Ad}(Q)_m\cong \mathfrak{gl}(n, \mathbb{R}).  $ 
\end{ex}
\begin{df}\label{df:equivariant}
	Let $ Q $ be a manifold, $ G $ a Lie group that acts on $ Q $, $ E $ a vector space and $ \rho: G \rightarrow GL(E) $ a representation of $ G $ on $ E $. We say that $ F: Q \rightarrow E $ is \textit{$G$-equivariant} if $ F(q\cdot g) = \rho(g^{-1})F(q). $ The set of all $ G $-equivariant maps will be denoted as $ C_G(Q,E). $  
\end{df}
\begin{prop}\label{prop:equiv_section_equivariant}
	
If $ \pi: Q \rightarrow M $ is a principal $ G $-bundle and $ \rho: G \rightarrow \operatorname{GL} (E) $ is a representation  of $ G, $ the module of sections of $ \rho(Q) \rightarrow M $ is in one-to-one correspondence with $ C_G(Q,E). $
\end{prop}
\begin{proof}
	Assign to each $ F\in C_G(Q,E) $ the section $s $ defined by $s(m)=[q, F(q)]\in \rho(Q)_m $ whenever $ \pi(q)=m\in M. $  This map is well-defined because if $ h= q\cdot g, $ $ [h,F(h)]=[q\cdot g, \rho(g^{-1})F(q)]=[q,F(q)]$. It is a section, since $ \pi\circ s = 1_M, $ and it is smooth because it can be seen as the quotient with respect to the $ G $-action of the smooth application $ 1_Q\times F: Q \rightarrow Q\times E. $ 

	On the other hand, if $s: M \rightarrow \rho(Q)$ is a section, we can construct a $ G $-equivariant map $ F $ in the following way: the map $ s\circ\pi: Q \rightarrow  \rho(Q) $ sends an element $ q\in Q $ to the fiber $ \pi_{ \rho(Q)}^{-1}(\pi(q)), $ because $ s $ is a section; therefore, $ s\circ \pi(q)=[q\cdot g, v], $ for some $ g\in G $ and $ v\in E $ that depend on $ \pi(q). $ The element of this equivalence class whose first component is $ q $ is $ (q,\rho(g)v), $ because $ [q\cdot g, v] = [q,\rho(g)v]$. We set then $ F(q)=\rho(g)v, $ where $ 1_q\times(s\circ\pi)(q)=[q,\rho(g)v]. $ This map is $ G $-equivariant because $ F(q\cdot h) $ is determined by the same equivalence class of $ F(q), $ as $ s\circ\pi(q\cdot h)= s\circ \pi(q), $ but in this case $ [q\cdot g, v] = [(q\cdot g)\cdot(g^{-1}h), \rho(h^{-1}g)v] = [q\cdot h, \rho(h^{-1}g)v], $ so that $ F(q\cdot h) = \rho(h^{-1})F(q), $ as desired. This assignation is smooth because it is equivalent to the smooth map $ \Psi\circ \phi: Q\times(G\times E) \rightarrow E,$ where $ \phi: Q \times(G\times E) \rightarrow Q\times \rho(Q), $ $ (q,(g,v)) \mapsto (q, [q\cdot g, v]) $, and $ \Psi: Q\times \rho(Q) \rightarrow E, $ $ (q,[q\cdot g, v])=\rho(g)v. $    

	Finally, to show that this is a one-to-one correspondence, observe that the associated $ G $-equivariant map of the section $ s(m)=[q, F(q)] $ is $ F, $  while the associated section of the $ G $-equivariant map $ F(q)=\rho(g) v $ is $ s(m)=[q,\rho(g)v]=[q\cdot g, v], $ as expected.
\end{proof}

\begin{ex}[\cite{montgomery2002tour}, p. 211]
	A function $ \xi: Q \rightarrow \mathfrak{g}  $ which is $ \operatorname{Ad}  $-invariant, meaning that $ \xi(q\cdot g)= \operatorname{Ad}_{g^{-1}}\xi(q) $, defines a section of the adjoint bundle. 
\end{ex}

This relation between bundles and sections extends to forms, as will be seen next.

\begin{df}
	A \textit{$ k $-form $ \omega $ with values in the associated bundle $ \rho(Q) $} is a multilinear totally skew assignation, taking $ v_1,\dots, v_k\in T_mM $ to a vector $ \omega_m(v_1,\dots,v_k)\in \rho(Q)_m. $  We denote as $ \Omega^k(M, \rho(Q)) $ the space of these forms.
\end{df}

Any $ k $-form $ \omega\in \Omega^k(M,\rho(Q)) $ is \textit{horizontal} if it annihilates any vertical vector, that is, $ \omega_m(V,\cdot,\dots)=0 $ whenever $ V $ is a vertical vector in $ Q. $ For such a form, $ \omega_m(X_1+V_1,\dots,X_k+V_k)=\omega_m(X_1,\dots, X_k) $ for $ V_i $ vertical.

\begin{prop}
	The space of $ k $-forms on $ Q $ with values in $ E $ which are $ G $-equivariant and horizontal (denoted as $ \Omega^k_G(Q,E) $) is isomorphic to $ \Omega^k(M,\rho(Q)). $ 
\end{prop}
\begin{proof}
	For a given $ \tilde \omega\in\Omega^k_G(Q,E), $ we assign to it the form $ \omega\in\Omega^k(M, \rho(Q)) $ given by $ \omega_m(v_1,\dots,v_k) = [q,\tilde\omega(z_1,\dots,z_k)],  $  $v_i\in T_mM, $ where the $ z_i $ are any $ k $ vectors in $ T_qQ $ projecting onto the $ v_i, $ that is, $ d\pi_q(z_i)=v_i. $  
\end{proof}

Given a projection $ \pi: Q \rightarrow M $ and a Lie group G acting on the total space $ Q, $ the infinitesimal generators of the $ G $-action $ \sigma_v: Q \rightarrow T_qQ, $ $ v\in \mathfrak{g,} $ 
$$ \sigma_v(q) = \frac{d}{d\epsilon} \Big|_{\epsilon=0} q\cdot \operatorname{exp} (\epsilon v),$$
satisfy $ V_q = \operatorname{Ker}d\pi_q = \left\{ \sigma_v(q): v\in \mathfrak{g} \right\} .  $ From this, $ \sigma_\cdot(q) $ is a linear isomorphism from $ \mathfrak{g} $ to $ V_q. $ Moreover, the map $ \eta_q(v)  = \sigma_v(q) $ is equivariant (see definition \ref{df:equivariant})
$$ \eta_{q\cdot g}\circ \operatorname{Ad}_{g^{-1}} = d\alpha_g  \circ \eta_q $$ 
due to Proposition \ref{prop:equiv_infinitesimal}. Thinking $ \sigma $ as a map from $ Q\times \mathfrak{g} $ to $ V, $ $ \sigma:Q\times \mathfrak{g}\rightarrow V, $ $ \sigma(q,v)= \sigma_v(q), $ we have that it is an \textit{equivariant bundle map} over $ Q, $ that is, it is a fiber bundle such that $ G $ acts on the total and base spaces, and the following equivariant property holds:
$$ \sigma \left( (q,v)\cdot g \right) = \sigma(q,v) \cdot g. $$ 

\begin{prop}\label{prop:isomorphism_vb}
	The map $ \sigma: \operatorname{Ad} (Q) = (Q\times \mathfrak{g})/G \rightarrow V/G $ is an isomorphism between vector bundles over $ M. $ 
\end{prop}
\begin{proof}
	The group $ G $ acts on $ V = \bigsqcup_{q\in Q}V_q $ through the assignment $$ w_q\cdot g = (d\alpha_g)_q(w_q), $$ 
	where $ w_q\in V_q. $ From this, we can consider the equivalence classes of this action, denoted by $ V/G:= \left\{ [w_q]: w_q\in V \right\}.  $ The map $ \sigma: \operatorname{Ad} (Q) \rightarrow V/G $ sends an element $ [q,v]\in \operatorname{Ad} (Q) $ to $ [\sigma_v(q)]\in V/G. $ From the equivariant property of $ \sigma, $ this map is well defined. The inverse map $ \sigma^{-1} : V/G \rightarrow \operatorname{Ad}(Q) $ is $ \sigma^{-1}[w_q] = [q,\sigma^{-1}_{w_q}], $ given that $ \sigma_\cdot(q): \mathfrak{g}\rightarrow V_q $ is a linear isomorphism. To conclude this proof, we need to show that the following diagram is commutative,
	\begin{center}
		% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAB12I0YAnOnBF5g6AWxjAAglAC+ACgCKAShAzS6TLnyEUARnJVajFmwBqAegDiq9SAzY8BIgCYD1es1aIOXHv0HCYhLS8so2Gg7aRPq6hh4m3gCyqoYwUADm8ESgAGa8EKJIZCCCSADM1Ax0AEYwDAAKmo46ILxY6QAWOCDuxl4+aFgA+sCc3HwCQiLiUrKKSjLhIHkFSPolEOW9nmycgyMWlouVNXWNkU7eWGDYsEsrhYiuG1tGO957w6O+EwHTwXNlIs1Ll8o9iqVEOt4v1ONh0qI6PcwWtqJDnjDdux4YiAHrAAC0umBFBkQA
\begin{tikzcd}
\operatorname{Ad}(Q) \arrow[rd, "\pi_{\operatorname{Ad}(Q)}"'] \arrow[r, "\sigma"] & V/G \arrow[d, "\pi_{V/G}" description] \arrow[r, "\sigma^{-1}"] & \operatorname{Ad}(Q) \arrow[ld, "\pi_{\operatorname{Ad}(Q)}"] \\
                                                                                   & M                                                               &                                                              
\end{tikzcd}
	\end{center}
	but this is immediate, since $ \pi_{Ad(Q)}[q,v]=\pi_{V/G}[w_q]=\pi(q). $ 
\end{proof}
Under the isomorphism of this Proposition, given the one-to-one correspondence between sections of $ \operatorname{Ad} (Q)\rightarrow M $ and $ G $-equivariant maps $ C_G(Q, \mathfrak{g}), $ sections of the adjoint bundle correspond to $ G $-invariant vertical vector fields. This is because such a vector field defines and is uniquely defined by a section of $ V/G \rightarrow M. $ To see this, let $ X: Q \rightarrow V $ be a $ G $-invariant vertical vector field, that is, $ (d\alpha_g)_q(X_q) = X_{q\cdot g}, $ and $ X_q\in V_q $ for all $ q\in Q. $ The map $ \phi: M \rightarrow V/G $, $ \phi(m)= [X_q], $ where $ q\in \pi^{-1}(m) $ is well defined because of the $ G $-invariant property of $ X. $ Now, if $ \phi: M \rightarrow V/G $ is a section of $ V/G \rightarrow M, $ we can construct the $ G $-invariant vertical vector field $ X: Q \rightarrow V, $ $ X_q=w_q, $ where $ \phi(m)=[w_q], $ that is, we choose the element of the equivalence class $ \phi(m) $ that is based on $ q. $ This is a smooth vector field because the following diagram is commutative,
\begin{center}
	% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBoBGAXVJADcBDAGwFcYkQBFAHS7wFt4AAg4gAvqXSZc+QijIAmanSat23XlgFxBAWTESQGbHgJFypRTQYs2iTj35CAagHoA4vsnGZZikuuqdk6ehlImssjyFv4qtvYaWoI8fPQ4ABYAZgBO9ADWwADmoiFG0qZypMQxNmpiSjBQBfBEoNkQfEjmIDgQSFHKNXbkAPrqjto8aGlYIDSM9ABGMIwACmE+dllYBWk4IW0diP09SADMVrHsPDA49LMg80ur6+UgWzt74q1Z7Uhk3b1EF1Hss1t5Xu9dvcAnERmNNEJJjMviADkgACw0E5HC6DEA8ADG032P0OmIBZzmi1BL1kb22UNxgXxXBu9EJWCyBMJxJRaMQAFYsYD-jD2HCHAi4HD7iDnuC6ZDPgZ+UKKYhzgNmQANOqiIA
\begin{tikzcd}
Q \arrow[d, "1_Q\times1_Q"'] \arrow[rd, "X"] &                                &                                                                     \\
Q\times Q \arrow[d, "1_Q\times \pi"']        & V                              &                                                                     \\
Q\times M \arrow[r, "1_Q\times \phi"']       & Q\times V/G \arrow[u, "\eta"'] & Q\times \mathfrak{g} \arrow[l, "\chi"] \arrow[lu, "\eta\circ\chi"']
\end{tikzcd}
\end{center}
where $ \eta: Q\times V/G \rightarrow V $ maps $ (q, [w_{\tilde q}]) $ to the element of the equivalence class of $ [w_{\tilde q}] $ that is based on $ q, $ and $ \chi: Q\times\mathfrak{g}\rightarrow V/G $ is the map that assigns $(q,v)$ to $ (q, [\Psi(v)]), $ where $ \Psi: \mathfrak{g} \rightarrow V_q $ is the natural isomorphism. The composition $ \eta\circ\chi: Q\times \mathfrak{g} \rightarrow V $ is the immersion of $ \Psi $ to $ V, $ from where we can conclude that $ \eta $ is smooth, and in consequence $ X:Q \rightarrow V $ is smooth.

The isomorphism between sections of $ \operatorname{Ad} (Q) $ and $ V/G $ will be denoted as $ \sigma: \Gamma( \operatorname{Ad} (Q)) \rightarrow \Gamma(V)_G, $ $ \xi \mapsto \sigma\xi, $ where $ \Gamma $ denotes the space of sections.

\begin{df}[\cite{montgomery2002tour}, p. 212]
	\textit{The gauge group} of $ \pi: Q \rightarrow M $ consists of all the $ G $-maps $ \Phi: Q \rightarrow  Q$ which induce the identity on $ M. $ That is, $ \Phi $ is a diffeomorphism that satisfies $ \Phi(q\cdot g) =\Phi(q)\cdot g, $ and it makes the following diagram commutative.
	\begin{center}
		% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAEUQBfU9TXfIRQAmclVqMWbTjz7Y8BIgEZSS8fWatEIALLdxMKAHN4RUADMAThAC2SMiBwQkKiZrYAdDwAUAFlm5eECtbe2onJFE3KW0vNADqBjoAIxgGb34FIRBLLCNfHECLaztEVwjEKI0YkDiArgouIA
\begin{tikzcd}
Q \arrow[rr, "\Phi"] \arrow[rd, "\pi"'] &   & Q \arrow[ld, "\pi"] \\
                                        & M &                    
\end{tikzcd}
	\end{center}
\end{df}
Despite of not being a (finite dimensional) Lie group, we can associate to it a Lie algebra to it, and this algebra corresponds to the space of equivariant vector fields: if $ \Phi_t: Q \rightarrow Q $ is a one-parameter subgroup of the gauge group, we can consider the vector field $$ X_q = \frac{d \Phi_t(q)}{dt} \Big|_{t=0}\in T_qQ. $$ This vector field is equivariant, because $$ (d\alpha_g)_q(X_q)=(d\alpha_g)_q \left( \frac{d \Phi_t(q)}{dt} \Big|_{t=0} \right)= d(\alpha_g \circ \Phi_t(q))_{t=0}= \frac{d\Phi_t(q\cdot g)}{dt} \Big|_{t=0}=X_{q\cdot g}  $$
due to the fact that $ \Phi $ is a $ G $-map. Moreover, if $ X\in \mathfrak{X}(Q) $ is an equivariant vector field, its flow is an element of the gauge group. Therefore, sections of the adjoint bundle form the Lie algebra of the gauge group via the isomorphism $ \sigma: \Gamma( \operatorname{Ad} (Q)) \rightarrow  \Gamma(V)_G. $ 

\begin{df}[\cite{montgomery2002tour}, p. 212]
	Let $ \pi:Q \rightarrow M $ be a principal $ G $-bundle with connection $ \mathcal{H} $. \textit{The connection one-form on $ Q $}, denoted as $ A, $ is a Lie-algebra-valued one-form on $ Q $, that is, $ A_q: T_qQ \rightarrow \mathfrak{g} $,  which satisfies the following conditions:

	\begin{enumerate}
		\item $ \operatorname{Ker} A_q = \mathcal{H}_q, \ \forall q\in Q. $ 
		\item $ A_q \circ \eta_q = 1_{ \mathfrak{g}}, \ \forall q\in Q. $ 
	\end{enumerate}
\end{df}
The second condition of previous definition is a normalization condition: as the image of $ \eta_q $ is $ V_q, $ when restricting to the vertical $ A_q $ is the canonical identification between $ V_q $ and $ \mathfrak{g} $. This connection one-form is unique, and it satisfies the following equivariance condition:
$$ \operatorname{Ad}_{g^{-1}}\circ A_q = A_{q\cdot g}\circ (d\alpha_g)_q\circ \eta_q\circ A_q. $$ 
As seen in Proposition \ref{prop:isomorphism_vb}, differentiating the group action on $ Q $ yields the infinitesimal generator map $ \sigma: \operatorname{Ad}(Q) \rightarrow (TQ)/G,  $ whose image is $ V/G. $ $ (TQ)/G \rightarrow M $ is a vector bundle over $ M, $ with projection $ [q,w] \mapsto \pi(q). $ Similarly, $ d\pi: TQ \rightarrow TM $ is equivariant with respect to the $ G $-action, where $ G $ acts trivially on $ M, $ which means that $ d\pi: (TQ)/G \rightarrow M $ is well-defined. As $ \operatorname{Ker} d\pi = \operatorname{Im} \sigma,   $ these maps fit together in the following exact sequence
\begin{center}
	%https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAB12I0YAnOnBF5g6AWxjAAglAC+ACgCKAShAzS6TLnyEUARnJVajFmzkAVZQHoA4qvUgM2PASIAmA9XrNWiEGYCyqoYwUADm8ESgAGa8EKJIZCCCSPpG3myc2KGidHbRsfGIqcmI7mkmvlCcaFhBMkA
	\begin{tikzcd}
\operatorname{Ad}(Q) \arrow[r, "\sigma"] & (TQ)/G \arrow[r, "d\pi"] & TM
\end{tikzcd}
\end{center}
of vector bundles over $ M. $ This sequence is called the \textit{Atiyah sequence.}  

A connection one-form is a splitting of this exact sequence:
\begin{center}
	% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAB12I0YAnOnBF5g6AWxjAAglAC+ACgCKAShAzS6TLnyEUARnJVajFmzkAVZQHoA4qvUgM2PASIAmA9XrNWiEGYCyqoYwUADm8ESgAGa8EKJI7iCCSPpG3mwAFiDUDHQARjAMAAqazjogvFihGTh20bHxiKnJiGRpJr6S2SC5BcWl2myV1bUyFDJAA
\begin{tikzcd}
\operatorname{Ad}(Q) & (TQ)/G \arrow[l, "A"'] & TM, \arrow[l, "h"']
\end{tikzcd}
\end{center}
where $ h $ is the collection of horizontal lifts $ h_q: T_mM \rightarrow T_qQ $ composed with the canonical map $ TQ \rightarrow (TQ)/G, $ and $ A $ results when we consider the connection one form $ A: TQ \rightarrow Q\times \mathfrak{g}, $ $ w_q \mapsto (q, A_q(v)) $, and take its quotient by the $ G $-action. These maps satisfy the following algebraic relations:
\begin{align*}
\operatorname{Im} h_q = \mathcal{H}_q = \operatorname{Ker} A_q,\\
\operatorname{Im} \eta_q = V_q = \operatorname{Ker} d\pi_q,\\
A_q\circ\eta_q = 1_{ \mathfrak{g}}, \quad d\pi_q\circ h_q = 1_{T_mM}.
\end{align*}

\begin{prop}\label{prop:splitting}
	The vector bundles $ (TQ)/G $ and $ TM\oplus \operatorname{Ad} (Q) $ are isomorphic.
\end{prop}
\begin{proof}
	Take an element $ v\oplus[q,w]\in T_mM\oplus \operatorname{Ad} (Q)  $ to $ [h_q(v)+\sigma_w(q)]\in (TQ)/G. $ The inverse sends $ [w_q]\in (TQ)/G $ to $ d\pi_q(w_q)\oplus [q, A_q(w_q)] $. The proof that these maps are inverses relies on the algebraic relations stated above, and the commutativity of the diagram 
	\begin{center}
		% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRABUBZAHW4jWZxe-GACc6OCKLB0AtjGABBKAF8AFAEUAlCBWl0mXPkIoATOSq1GLNl2ECmQvmjESpM+UtWadeg9jwCIgBGC2p6ZlZEEDV2bQB6AHFdfRAMAOMQ0mDLCJtozl1LGCgAc3giUAAzUQhZJDIQSSQAZj8QGrqkcyaIVvbO+sRQ3v7UwYbqZsRTAdqhnunglQoVIA
\begin{tikzcd}
TM\oplus\operatorname{Ad}(Q) \arrow[rd] \arrow[r] & (TQ)/G \arrow[d] \arrow[r] & TM\oplus\operatorname{Ad}(Q) \arrow[ld] \\
                                                  & M                          &                                        
\end{tikzcd}
	\end{center}
	is immediate from the definition.
\end{proof}

\begin{df}[\cite{montgomery2002tour}, definition 4.1.1]
	\textit{The curvature of a distribution $ \mathcal{H} $ } is the linear bundle map $ F: \Lambda^2 \mathcal{H} \rightarrow TQ/\mathcal{H} $ defined by $ F(X,Y) = -[X,Y] \operatorname{mod} \mathcal{H}.  $ 	
\end{df}
The connection one-form $ A $ provides an identification $ (TQ)/ \mathcal{H} \rightarrow \mathfrak{g}, $ given that the kernel of $ A_q $ is precisely $ \mathcal{H}_q. $ 

\begin{df}[\cite{montgomery2002tour}, p. 214]
	\textit{The curvature form} is a $ G $-equivariant horizontal two-form $ \Omega $ defined by the assignment $ \Omega(X,Y) = -A([X,Y]), $ if $ X,Y $ are horizontal, and $ \Omega(X,Y)=0 $ if $ X $ or $ Y$ are vertical vectors.  
\end{df}

\begin{df}[\cite{montgomery2002tour}, p. 214]
	Let $ \rho(Q) $ be an associated bundle of the principal $ G $-bundle $ \pi: Q \rightarrow M $ with connection $ \mathcal{H}, $  and $ \rho:  G \rightarrow \operatorname{GL}(E) $ be a representation of $ G $ on a vector space $ E. $  If $ \psi: M \rightarrow \rho(Q) $ is a section of this bundle, and if $ X\in \mathfrak{X}(M), $ we define the \textit{covariant derivative $ D_X\psi $ of $ \psi $ in the direction of $ X $} as follows. The section $ \psi $ corresponds to an equivariant map $ F: Q \rightarrow E $, and $ hX $ is a $ G $-equivariant horizontal vector field on $ Q, $ so that $ dF(hX) $ is an equivariant map $ Q \rightarrow E, $ which corresponds to a section of $ \rho(Q), $ $ D_X\psi. $ 
\end{df}
\begin{df}[\cite{montgomery2002tour}, p. 214]\label{df:covariantly_constant}
	Let $ c:I \rightarrow M $ be a curve. A section $ \psi: M\rightarrow \rho(Q) $ is said to be \textit{covariantly constant over $ c $} if $ D_{\dot{c}}\psi=0. $  	
\end{df}
The $ G $-invariant vector fields on $ Q $ can be identified with sections of $ (TQ)/G, $ and due to Proposition \ref{prop:splitting} we can split them up into horizontal and vertical vector fields, according to $ (TQ)/G = TM \oplus \operatorname{Ad} (Q). $ The following Proposition will be useful to find the Poisson brackets of horizontal and vertical vector fields.

\begin{prop}
	Let $ X,Y\in \mathfrak{X}(M) $ and $ \xi,\chi: M \rightarrow \rho(Q). $ We have the following relations:
\begin{align}
 [hX, hY] = h([X,Y])\oplus -\eta(\Omega(hX,hY)), \label{eq:horizontal-horizontal}\\
 [\sigma\xi, \sigma\chi] = \sigma([\xi,\chi]), \label{eq:vertical-vertical} \\
 [hX,\sigma \xi] = - \sigma(D_X\xi). \label{eq:horizontal-vertical} 
\end{align}

\end{prop}

\begin{proof}

	\begin{itemize}
		\item To prove equation \eqref{eq:horizontal-horizontal}, we will find its horizontal and vertical components. The horizontal component can be found projecting the bracket $ [hX,hY] $ using $ d\pi, $ and as $ X $ ($ Y $) and $ hX $ ($hY$)   are $ \pi $-related, $ d\pi[hX, hY]=[X,Y], $ so that the horizontal component of $ [hX,hY] $ is $ h([X,Y]) $. Now, to find the vertical component of $ [hX,hY], $ we evaluate the curvature form on $ hX $ and $ hY $ to get the identification of the vertical component of $ [hX,hY] $ in $ \mathfrak{g}, $ and to obtain the vertical component we use the isomorphism $ \eta $ between $ \mathfrak{g} $ and the vertical space. The minus sign comes from the definition of the curvature form.

		\item As $ \sigma \xi $ and $ \sigma\chi $ are both vertical vectors, their horizontal components are zero, so that both are $ \pi $-related with the zero vector field, which implies that the horizontal component of $ [\sigma\xi, \sigma\chi] $ is zero. To show the equality \eqref{eq:vertical-vertical} we have to prove that $ \sigma $ is a Lie algebra homomorphism, and this can be done noticing that $ [\xi,\chi]_m = [\xi_m, \chi_m]\in \mathfrak{g},$ where $ \xi_m,\chi_m\in \mathfrak{g} $ are given by the identification between fibers of $ Ad(Q) $ and $ \mathfrak{g}. $ With this, $ \sigma[\xi, \chi]_q = \sigma_{[\xi,\chi]_{\pi(q)}}(q), $  while $ [\sigma\xi,\sigma\chi]_q = [\sigma_{\xi_{\pi(q)}}, \sigma_{\chi_{\pi(q)}}] $  is identified with $ [\xi_m,\chi_m] $, so that it is equal to $ \sigma_{[\xi, \chi]_{\pi(q)}}(q), $ from where we obtain the desired equality.

		\item For the same reason of the last proof, the horizontal component of $ [hX,\sigma \xi] $ is zero. On the other hand, note that $ [hX, \sigma \xi] = - \sigma\xi(hX),$ which is equivalent to $ -\sigma(D_X\xi) $.
	\end{itemize}
\end{proof}
\subsection{Wong's equations}%
\label{sub:wong_s_equations}
Let $ \pi: Q \rightarrow M $ be a principal $ G $-bundle with connection $ \mathcal{H}, $ and let $ \left( \mathcal{H}, \langle \cdot,\cdot \rangle \right)  $ be a metric of bundle type. The sub-Riemannian Hamiltonian $ H $ associated with the sub-Riemannian structure $ ( \mathcal{H}, \langle \cdot,\cdot \rangle) $ on $ Q $ is $ G $-invariant. We choose a local frame $ \left\{ X_i \right\}_{i=1}^n $ for the base space $ M $ to express $ H $: write $ g_{ij}=g(X_i,X_j) $ for the corresponding inner products with respect to the Riemannian metric $ g $ on $ M $. We take the horizontal lifts $ \left\{ hX_i \right\}_{i=1}^n $ to obtain a local horizontal frame on $ Q. $ If $ P_i:= P_{hX_i} $ are the momentum functions, then
\begin{equation}\label{eq:sub-RiemannianHamiltonian}
	H(\alpha)= \frac{1}{2} g_{ij} \left( \pi(\pi_{T^*Q}(\alpha)) \right) P_i(\alpha) P_j(\alpha),	
\end{equation}
because 
\begin{dmath*}
	\frac{1}{2} (\alpha,\alpha)_{\pi_{T^*Q}(\alpha)} = \frac{1}{2} \langle P_i(\alpha) hX_i, P_j(\alpha)hX_j \rangle_{\pi_{T^*Q}(\alpha)} = \frac{1}{2}  P_i(\alpha)P_j(\alpha) \langle hX_i, hX_j \rangle_{\pi_{T^*Q(\alpha)}} = \frac{1}{2}  g_{ij}(\pi(\pi_{T^*Q}(\alpha))) P_i(\alpha)P_j(\alpha),
\end{dmath*}
where $ \alpha|_{ \mathcal{H}_{\pi_{T^*Q}(\alpha)}} = g_{\pi(\pi_{T^*Q}(\alpha))}(P_i(\alpha) hX_i, \cdot).$ 
\begin{df}[\cite{montgomery2002tour}, p. 282]
	Let $ Q $ be a manifold, and $ G $ a Lie group that acts on $ Q $. \textit{The momentum map $ J: T^*Q \rightarrow \mathfrak{g}^*$ } is defined by	
	$$ J(\alpha) := \eta^*_q(\alpha), \ \pi_{T^*Q}(\alpha)=q, $$ 
	where $ \eta_q: \mathfrak{g}\rightarrow T_qQ $ is given by $ \eta_q = \sigma_\cdot(q), $ and $ \eta_q^*: T_q^*Q \rightarrow \mathfrak{g}^* $ is the dual map, that is, $ \eta_q^*(\alpha)=\alpha\circ \eta_q. $ 
\end{df}

\begin{prop}[\cite{montgomery2002tour}, p. 282]\label{prop:momentum_map}
	$ J: T^*Q \rightarrow \mathfrak{g}^* $ is constant along normal sub-Riemannian geodesics.
\end{prop}
The isomorphism between $ TQ/G $ and $ TM \oplus \operatorname{Ad} (Q) $ given in Proposition \ref{prop:splitting} can be dualized to obtain the isomorphism $ T^*Q/G \rightarrow T^*M \oplus \operatorname{Ad}^*(Q) $ given by
$$ \left[ \alpha \right] \mapsto h^*_q\alpha \oplus \left[ q, \eta_q^*(\alpha)\right], \ q=\pi_{T^*Q}(\alpha). $$ 
By Proposition \ref{prop:momentum_map}, if $ \alpha: I \rightarrow T^*Q $ is a sub-Riemannian geodesic, $ J(\alpha(t)) $ is constant. We denote as $ \lambda: I \rightarrow \operatorname{Ad}^*(Q) $ the curve that makes the following diagram commutative,
\begin{center}
	% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRAEkQBfU9TXfIRQBGclVqMWbACoA9AFQBFbrxAZseAkQBMY6vWatEIOUoD0AcRV8NgnaWHiDU46YCyAHQ8Q0zOAAIvHxgAJzocCBCwOgBbGGAAQSguBQAKRQBKazV+TSFkXW0nSSMQILRQ8MjouMTktMzucRgoAHN4IlAAMxCIGKQyEAikUQlDNi9GNAALOmyevpHqYcRtHm7e-tXliCQAZmoGLDBSqAgmACMGVmppmDooJDAmBgZluiwGNkgT+c39nZIAAs+hKE28FTCESisXiaF6ACsuAB9YDlSrQmrxJIpeTpDJcP6LRCDFYgsYuMoeBixC5QOaHOgXGAMAAKuTsxhCWFa0xwTS4QA
\begin{tikzcd}
I \arrow[r, "\alpha"] \arrow[rrdd, "\lambda"'] & T^*Q \arrow[r] & T^*Q/G \arrow[d, Rightarrow]                                                                \\
                                               &                & T^*M\oplus \operatorname{Ad}^*(Q) \arrow[d, "\operatorname{proj}_{\operatorname{Ad}^*(Q)}"] \\
                                               &                & \operatorname{Ad}^*(Q)                                                                     
\end{tikzcd}
\end{center}
that is, $ \lambda(t) = \left[ \pi_{T^*Q}(\alpha(t)), \eta^*_{\pi_{T^*Q}(\alpha)}(\alpha(t)) \right]  $. 

\begin{thm}
	Suppose that $ \pi: Q \rightarrow M $  is a principal $ G $-bundle with connection $ \mathcal{H} $ endowed with a sub-Riemannian metric of bundle type,  and $ \rho: G \rightarrow \operatorname{GL} (E) $ is a representation of $ G $ on a vector space $ E. $ Let $ c: I \rightarrow M $ be a curve on $ M. $ A section $ \psi: M \rightarrow \rho(Q) $   is covariantly constant (see Definition \ref{df:covariantly_constant}) over $ c $  if and only if $ \psi(t)= [q(t), \psi_0] $, where $ \pi\circ q = c,  $ and $ \psi_0\in E $ is constant.
\end{thm}
\begin{proof}
	Suppose that $ \psi(t)= [q(t), \psi_0] $ for a horizontal lift $ q: I \rightarrow Q $ of $ c: I \rightarrow M $, and $ \psi_0\in E $ constant. By Proposition \ref{prop:equiv_section_equivariant}, the section $ \phi: \operatorname{Im} (c)\subset M \rightarrow \rho(Q) $ given by $ \phi(c(t))=\psi(t) $ corresponds to the equivariant map $ F: \operatorname{Im} (q)  \subset Q \rightarrow E, $ $ F(\tilde q)= \rho(g)\psi_0, $ where $ g $ is determined by $ \phi\circ\pi(\tilde q) = [\tilde q \cdot g, \psi_0]. $ Nevertheless, as $ \phi_0\in E $ is constant, $ g=e, $ and $ F=\psi_0 $ becomes the constant map, so that $ dF(h\dot{c})=0 $ is the null equivariant map, which precisely corresponds to the section $ s: \operatorname{Im} (c) \subset M \rightarrow \rho(Q) $ given by $ s(c(t)) =[q(t), 0] $, and $ D_{\dot{c}}\psi=0. $ 

	Now, if we suppose that $ D_{\dot{c}}\psi=0, $ we get that the equivariant map associated to the section $ \phi: \operatorname{Im} (c)\subset M \rightarrow \rho(Q) $ is constant, from where we obtain that $ \psi(t)=[q(t), \psi_0] $ for $ \psi_0\in E $ constant, and $ q $ must be a horizontal lift of $ c $ in order to satisfy $ \pi_{T^*Q}\circ\psi =c. $ 
\end{proof}

\begin{cor}[First Wong's equation]\label{cor:fwe}
	$\alpha: I \rightarrow T^*Q$ is a normal sub-Riemannian geodesic if and only if $ \lambda$ is covariantly constant, that is, $$ D_{\dot{c}}\lambda =0, $$ where $ c=\pi\circ\pi_{T^*Q}\circ\alpha, $ and $ \lambda(t)=[ \pi_{T^*Q}\circ\alpha(t), J\circ\alpha(t)]. $ 
\end{cor}
Every $ G $-invariant vector field on $ Q $ can be split into their vertical and horizontal components, so that any of these vector fields is determined by lifted horizontal vector field $ hX, $ where $ X: M \rightarrow TM, $ and a $ G $-invariant vertical vector field $ \sigma\xi, $ where $ \xi: M \rightarrow \operatorname{Ad} (Q) $ is a section, and $ \sigma: \Gamma( \operatorname{Ad} (Q)) \rightarrow \Gamma(V)_G $ is the isomorphism between sections described below Proposition \ref{prop:isomorphism_vb}.

We can identify $ \xi: M \rightarrow \operatorname{Ad} (Q) $ with a $ G $-equivariant map $ F: Q \rightarrow \mathfrak{g} $ using Proposition \ref{prop:equiv_section_equivariant}. In this case, the momentum function associated to $ \sigma\xi $ is
$$ P_{\sigma\xi}(\alpha)= J(\alpha) \left( F(\pi_{T^*Q}(\alpha)) \right).  $$ 
To see this, by Proposition \ref{prop:isomorphism_vb} we have that $ \sigma\circ \xi: M \rightarrow V/G $ is a section of $ V/G \rightarrow M, $ and the $ G $-invariant vertical vector field associated to it is $ \sigma\xi: Q \rightarrow V $, $ q \mapsto \sigma_v(q), $ where $ \xi(\pi(q))=[q,v] $ for a given $ v\in \mathfrak{g} $, and $ \sigma\circ\xi(\pi(q)) = \sigma([q,v])=[\sigma_v(q)] $. From this point, we can see that $ P_{\sigma\xi}(\alpha) = \alpha(\sigma\xi) = \alpha(\sigma_v(q)) = \alpha\circ \eta_q(v) = \eta_q^*(\alpha)(v) = J(\alpha)(v)= J(\alpha) \left( F(\pi_{T^*Q}(\alpha)) \right), $ as desired.    

\begin{df}\label{df:lifted_configuration_function}
	We say that a map $ f: T^*Q \rightarrow \mathbb{R} $ is a lifted configuration function if there exists a function $ \tilde f: M \rightarrow \mathbb{R} $ such that the following diagram commutes,
	\begin{center}
		% https://tikzcd.yichuanshen.de/#N4Igdg9gJgpgziAXAbVABwnAlgFyxMJZABgBpiBdUkANwEMAbAVxiRABUA9AKgEUQAvqXSZc+QigCM5KrUYs2-ISOx4CRaZNn1mrRCACyg4SAyrxRMluo6F+gDr2AtnRwALAEYfgAJQGDZGCgAc3giUAAzACcIJyQyEBwIJABmG3k9EAiQagY6DxgGAAVRNQkQKKxgtxxjSJi4xASkpGk5XTZHNCwAfWAuPn9lLIbW6hbEACZ0jod7brqR2KRpxOTENPa7EC63LEXo5abx9dXbTK6sRwBjLCjry76B3n9c-MKS83V9LDBsWACAiAA
\begin{tikzcd}
T^*Q \arrow[d, "f"'] \arrow[r, "\pi_{T^*Q}"] \arrow[rd, "\pi\circ\pi_{T^*Q}" description] & Q \arrow[d, "\pi"]  \\
\mathbb{R}                                                                                & M \arrow[l, "\tilde f"]
\end{tikzcd}
	\end{center}
	which implies that $ f $ is constant along fibers of $ \pi\circ \pi_{T^*Q}. $ 
\end{df}
\begin{lm}[\cite{montgomery2002tour}, Lemma 12.3.1]
	The vertical and horizontal momentum functions $ P_{\sigma\xi} $ and $ P_{hX}, $ and lifted configuration functions $ f,g: T^*Q \rightarrow \mathbb{R} $ satisfy the following Poisson bracket relations: 	
	\begin{align}
		\left\{ P_{hX}, P_{hY} \right\} = -P_{h[X,Y]}+P_{\sigma\Omega(X,Y)},\label{eq:lemma_1}\\ 
	\left\{ P_{\sigma \xi}, P_{\sigma\chi} \right\} = P_{[\xi, \chi]},\\
	\left\{ P_{hX}, P_{\sigma\xi} \right\} = -D_{\sigma(D_X\xi)},\\
	\left\{ f, P_{hX} \right\} = d\tilde f(X),\\ \label{eq:lemma_4}
	\left\{ f, P_{\sigma\xi} \right\} = \left\{ f,g \right\} =0,
	\end{align}
	where $\left[ \xi, \chi \right]$ 	represents the corresponding point-wise bracket of the associated $ G $-equivariant maps of $ Q \rightarrow \mathfrak{g} $ of $ \xi,\chi, $ while $ \tilde f : M \rightarrow \mathbb{R} $ is the function that makes the diagram of Definition \ref{df:lifted_configuration_function} commutative.
\end{lm}
\begin{proof}
	These commutation relations follow from Proposition \ref{prop:poisson_bracket_momentum}, and from commutation relations between vertical and horizontal vector fields \eqref{eq:horizontal-horizontal}-\eqref{eq:horizontal-vertical}. The relations involving lifted configuration functions follow from calculation in canonical coordinates on $ T^*Q. $ 
\end{proof}
Returning to the Hamiltonian \eqref{eq:sub-RiemannianHamiltonian}, note that the metric function $ g_{ij} $ is a lifted configuration function, while by definition $ P_i=P_{hX_i} $ are horizontal momentum functions. If $ f: T^*Q \rightarrow \mathbb{R} $ is a function of $ Q $ alone, by equation \eqref{eq:lemma_4} we have that $ \left\{ f, P_i \right\} = d\tilde f(X), $ so that the Poisson bracket between $ f $ and the Hamiltonian \eqref{eq:sub-RiemannianHamiltonian} is 
\begin{align*}
	\dot{f} &= \left\{ f, H \right\} = \frac{1}{2} \left\{ f, g^{ij}P_iP_j \right\} = \frac{1}{2} g^{ij} \left\{ f, P_iP_j \right\} \\&= \frac{1}{2} \left( P_i \left\{ f,P_j \right\} +P_j \left\{ f,P_i \right\}  \right) = g^{ij}P_i \left\{ f,P_j \right\} = g^{ij} P_i d\tilde f( X_j). 
\end{align*}
If $ f= \varphi\circ\pi_{T^*Q}=:q $ becomes the coordinate chart for $ Q $, we get that 
$$ \dot{q} = g^{ij}P_i \underbrace{hX_j(q)}_{\text{in coordinates}}, $$ 
from where we conclude that $ q(t) $ is horizontal, and its tangent vector $ \dot{q} $ is a horizontal lift of the vector $ \dot{c} $ on $ M $ metrically dual to the covector with components $ P_i(q(t), p(t)). $ To compute how $ P_i $ evolves, let $ X_i=\partial/\partial x_i $ be a coordinate frame where the $ x^i $ are local coordinates on $ M. $  Therefore, $ [X_i,X_j]=0, $ and
$$ \left\{ P_i,P_j \right\} = P_{[hX_i, hX_j]}= P_{\Omega(X_i, X_j)} = P_{\Omega_{ij}} = \lambda \Omega_{ij} $$ 
by equation \eqref{eq:horizontal-horizontal}. From this discussion we derive the second Wong's equation.

\begin{cor}[Second Wong's equation]\label{cor:swe}
	$ \alpha: I \rightarrow T^*Q $ is a normal sub-Riemannian geodesic if and only if it satisfies the equation
	$$ \nabla_{\dot{c}}\dot{c} = -( \lambda(i_{\dot{c}}\Omega))^{\#}, $$ 
	where $ c = \pi\circ\pi_{T^*Q}\circ\alpha, $ $\lambda = [\pi_{T^*Q}(\cdot), \eta^*_{\pi_{T^*Q}(\cdot)}(\cdot)], $ and $ \# $ represents lowering indices using the metric on $ M. $ In coordinates this equation is
	$$ \frac{d}{dt} P_i = - \frac{1}{2} \frac{\partial }{\partial x^i} g^{kl}P_kP_l + g^{kl}P_k \lambda \Omega_{il}. $$ 
\end{cor}
\begin{proof}
	Using the Leibniz property of the Poisson bracket and equation \eqref{eq:lemma_1}, we have that
	\begin{align*}
		\frac{d P_i}{dt} &= \frac{1}{2} \left\{ P_i, g^{kl} \right\} P_kP_l+ g^{kl} P_k \left\{ P_i, P_l \right\} \\&= \frac{1}{2} \frac{\partial }{\partial x^i} g^{kl} P_k P_l + g^{kl} P_k\lambda \Omega_{il}.
	\end{align*}
\end{proof}
 
\subsection{Abelian case}%
\label{sub:abelian_case}

If the structure group $ G $ of the principal $ G $-bundle $ \pi: Q \rightarrow M $ is abelian, then the adjoint and co-adjoint bundles are the trivial bundles $ M\times \mathfrak{g}^{(*)} \rightarrow M, $ given that $ \operatorname{ad}^{(*)} : G \rightarrow \operatorname{Aut} ( \mathfrak{g}^{(*)}) $ satisfies $ \operatorname{ad^{(*)}} (g)= 1_{ \mathfrak{g}^{(*)}} $ for all $ g\in G. $ The sections of these bundles correspond to functions $ M \rightarrow \mathfrak{g}^{(*)} $, because sections are maps of the form $ 1_M\times f, $ where $ f: M \rightarrow \mathfrak{g}^{(*)}.$ 

\begin{lm}\label{lm:minus_inverse}
	If $ G $ is an abelian Lie group, its Lie algebra $ \mathfrak{g} $ is abelian, that is, $ [X,Y]=0 $ for all $ X,Y\in \mathfrak{g}. $ 
\end{lm}
\begin{proof}
	As $ G $ is a Lie group, the inverse map $ i : G \rightarrow G $, $ g \mapsto g^{-1} $ is a Lie group homomorphism, and its differential at the identity, $di_e: \mathfrak{g} \rightarrow \mathfrak{g},  $ $ X \mapsto -X, $ is a Lie algebra homomorphism. Then, for any $ X,Y\in \mathfrak{g} $ 
	$$ -[X,Y] = di_e([X,Y]) = [di_e(X), di_e(Y)] = [X,Y]=0. $$ 
\end{proof}

Assuming that $ G$ is abelian, by Lemma \ref{lm:minus_inverse}, the Lie algebra is abelian. The covariant derivative  of a section $ \psi: M \rightarrow M\times \mathfrak{g}^{(*)} $ with respect to a vector field $ X\in \mathfrak{X}(M) $ corresponds to the usual derivative of the function $f:= \operatorname{proj_{ \mathfrak{g}^{(*)}}}\circ \psi,$ because the equivariant map associated with the section $ \psi $ is precisely $ f\circ\pi, $ so that $ D_X\psi=d(f\circ\pi)(hX) = df(X). $ 

From the fist Wong's equation (Corollary \ref{cor:fwe}), we get that $ D_{\dot{c}}\lambda = d( \operatorname{proj}_{ \mathfrak{g}^*}\circ \lambda\circ\pi(\dot{c}))=0, $ from where we get that $ \lambda $ remains constant along $ \dot{c} $ when projected to $ \mathfrak{g}^{*}. $ The curvature appearing in the second Wong's equation (Corollary \ref{cor:swe}) is a two-form on the base with values in the vector space $ \mathfrak{g} $ (\cite{montgomery2002tour}, p. 220).

If the structure group $ G $ is one dimensional (either $ \mathbb{R} $ or $ \mathbb{S}^1), $ we have that $ \mathfrak{g}^*= \mathbb{R}, $ and $ \operatorname{proj}_{ \mathfrak{g}^*} \circ\lambda\circ\pi $ is the constant map from $ Q $ to a real value, while the curvature is a real-valued two-form.

If $ M = \mathbb{R}^3$ is endowed with the Euclidean metric, $ \Omega = i_B(dx\wedge dy\wedge dz) $ and $ B\in \mathfrak{X}(M), $ the second Wong's equation is in coordinates 
$$ \frac{d P_i}{dt} = \lambda g^{kl} P_k \Omega_{il} = \lambda (P\times B)_i, $$ 
which resembles the standard Lorentz equations for a particle whose quotient between its electric charge and mass is $ \lambda, $ in a magnetic field $ B. $ The first Wong's equation states that the quotient $\lambda$ is preserved. Moreover, as
\begin{dmath*}
	d\Omega = di_B(dx\wedge dy\wedge dz) = L_B(dx\wedge dy\wedge dz) = -(\nabla\cdot B) dx\wedge dy\wedge dz,	
\end{dmath*}
we can conclude that $ d\Omega=0, $ given the Maxwell's equation $ \nabla\cdot B=0. $ 
% =============================================================== 
\newpage
\bibliographystyle{unsrt}
\nocite{*}
\bibliography{mybibliography}

\end{document}

